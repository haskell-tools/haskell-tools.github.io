<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap</span><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">module</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html"><span class="hs-identifier">Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap</span></a><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.TH.LanguageExtensions</span><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Formula</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Generics</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.DeepSeq</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">SrcLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">All</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Function</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">on</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map.Lazy</span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LMap</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map.Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">SMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">SAT.MiniSat</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.TH.LanguageExtensions</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.Tools.Refactor.Utils.Extensions</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">expandExtension</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-pragma">{-# ANN</span><span> </span><span class="hs-pragma">module</span><span> </span><span class="hs-pragma">&quot;HLint: ignore Redundant lambda&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span>  </span><span class="hs-identifier hs-type">Extension</span><span>
</span><a name="line-32"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><span class="hs-identifier hs-type">Extension</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-identifier hs-type">Extension</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-35"></a><span>  </span><a name="local-8214565720323790097"><span class="hs-identifier">rnf</span></a><span> </span><a name="local-6989586621679177092"><a href="#local-6989586621679177092"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">seq</span><span> </span><a href="#local-6989586621679177092"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Generic</span><span> </span><a href="#local-6989586621679177141"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Generic</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Formula</span><span> </span><a href="#local-6989586621679177141"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span> </span><a href="#local-6989586621679177140"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="#local-6989586621679177140"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Formula</span><span> </span><a href="#local-6989586621679177140"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">type</span><span> </span><a name="LogicalRelation"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier">LogicalRelation</span></a></a><span> </span><a name="local-6989586621679176350"><a href="#local-6989586621679176350"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Formula</span><span> </span><a href="#local-6989586621679176350"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177101"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679177101"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-43"></a><a name="prettyPrintFormula"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier">prettyPrintFormula</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Var</span><span> </span><a name="local-6989586621679177102"><a href="#local-6989586621679177102"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679177102"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-44"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679177103"><a href="#local-6989586621679177103"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator hs-var">:||:</span><span> </span><a name="local-6989586621679177104"><a href="#local-6989586621679177104"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><a href="#local-6989586621679177103"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; OR &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><a href="#local-6989586621679177104"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-45"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679177105"><a href="#local-6989586621679177105"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator hs-var">:&amp;&amp;:</span><span> </span><a name="local-6989586621679177106"><a href="#local-6989586621679177106"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><a href="#local-6989586621679177105"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; AND &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><a href="#local-6989586621679177106"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-46"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679177107"><a href="#local-6989586621679177107"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator hs-var">:++:</span><span> </span><a name="local-6989586621679177108"><a href="#local-6989586621679177108"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><a href="#local-6989586621679177107"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; XOR &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><a href="#local-6989586621679177108"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-47"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679177109"><a href="#local-6989586621679177109"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator hs-var">:-&gt;:</span><span> </span><a name="local-6989586621679177110"><a href="#local-6989586621679177110"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><a href="#local-6989586621679177109"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; =&gt; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><a href="#local-6989586621679177110"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-48"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679177111"><a href="#local-6989586621679177111"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator hs-var">:&lt;-&gt;:</span><span> </span><a name="local-6989586621679177112"><a href="#local-6989586621679177112"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><a href="#local-6989586621679177111"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &lt;=&gt; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><a href="#local-6989586621679177112"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-49"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">All</span><span> </span><a name="local-6989586621679177113"><a href="#local-6989586621679177113"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;All [&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679177113"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;]&quot;</span><span>
</span><a name="line-50"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Some</span><span> </span><a name="local-6989586621679177114"><a href="#local-6989586621679177114"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Some [&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679177114"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;]&quot;</span><span>
</span><a name="line-51"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">None</span><span> </span><a name="local-6989586621679177115"><a href="#local-6989586621679177115"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;None [&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679177115"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;]&quot;</span><span>
</span><a name="line-52"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ExactlyOne</span><span> </span><a name="local-6989586621679177116"><a href="#local-6989586621679177116"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;ExactlyOne [&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679177116"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;]&quot;</span><span>
</span><a name="line-53"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AtMostOne</span><span> </span><a name="local-6989586621679177117"><a href="#local-6989586621679177117"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;AtMostOne [&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679177117"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;]&quot;</span><span>
</span><a name="line-54"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Not</span><span> </span><a name="local-6989586621679177118"><a href="#local-6989586621679177118"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Not &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#prettyPrintFormula"><span class="hs-identifier hs-var">prettyPrintFormula</span></a><span> </span><a href="#local-6989586621679177118"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-55"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-identifier hs-var">Yes</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;True&quot;</span><span>
</span><a name="line-56"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-identifier hs-var">No</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;False&quot;</span><span>
</span><a name="line-57"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-identifier hs-var">Let</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Let ...&quot;</span><span>
</span><a name="line-58"></a><span class="hs-identifier">prettyPrintFormula</span><span> </span><span class="hs-identifier hs-var">Bound</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Bound is for internal use only&quot;</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-keyword">data</span><span> </span><a name="Occurence"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#Occurence"><span class="hs-identifier">Occurence</span></a></a><span> </span><a name="local-6989586621679175551"><a href="#local-6989586621679175551"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Hint"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#Hint"><span class="hs-identifier">Hint</span></a></a><span>               </span><span class="hs-special">{</span><span> </span><a name="unOcc"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#unOcc"><span class="hs-identifier">unOcc</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679175551"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-61"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a name="Evidence"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#Evidence"><span class="hs-identifier">Evidence</span></a></a><span>           </span><span class="hs-special">{</span><span> </span><a name="unOcc"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#unOcc"><span class="hs-identifier">unOcc</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679175551"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-62"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a name="MissingInformation"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#MissingInformation"><span class="hs-identifier">MissingInformation</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unOcc"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#unOcc"><span class="hs-identifier">unOcc</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679175551"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-keyword">type</span><span> </span><a name="ExtMap"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#ExtMap"><span class="hs-identifier">ExtMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">SMap.Map</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#Occurence"><span class="hs-identifier hs-type">Occurence</span></a><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">]</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-identifier">lVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679177100"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679177100"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-68"></a><a name="lVar"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#lVar"><span class="hs-identifier">lVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Var</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-identifier">lNot</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679177099"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679177099"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-71"></a><a name="lNot"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#lNot"><span class="hs-identifier">lNot</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Var</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-identifier">lAnd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679177098"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177098"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679177098"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-74"></a><a name="lAnd"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#lAnd"><span class="hs-identifier">lAnd</span></a></a><span> </span><a name="local-6989586621679177119"><a href="#local-6989586621679177119"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679177120"><a href="#local-6989586621679177120"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621679177119"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">:&amp;&amp;:</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621679177120"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-identifier">lOr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679177097"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177097"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679177097"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-77"></a><a name="lOr"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#lOr"><span class="hs-identifier">lOr</span></a></a><span> </span><a name="local-6989586621679177121"><a href="#local-6989586621679177121"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679177122"><a href="#local-6989586621679177122"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621679177121"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">:||:</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621679177122"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-identifier">lImplies</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679177096"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177096"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679177096"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-80"></a><a name="lImplies"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#lImplies"><span class="hs-identifier">lImplies</span></a></a><span> </span><a name="local-6989586621679177123"><a href="#local-6989586621679177123"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679177124"><a href="#local-6989586621679177124"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621679177123"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">:-&gt;:</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621679177124"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-identifier">lAll</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679177095"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679177095"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-83"></a><a name="lAll"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#lAll"><span class="hs-identifier">lAll</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">All</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-identifier">complexity</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Extension</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-86"></a><a name="complexity"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#complexity"><span class="hs-identifier">complexity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#expandExtension%27"><span class="hs-identifier hs-var">expandExtension'</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- | Completely expand extension</span><span>
</span><a name="line-89"></a><span class="hs-identifier">expandExtension'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Extension</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">]</span><span>
</span><a name="line-90"></a><a name="expandExtension%27"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#expandExtension%27"><span class="hs-identifier">expandExtension'</span></a></a><span> </span><a name="local-6989586621679177125"><a href="#local-6989586621679177125"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#findFixedPoint"><span class="hs-identifier hs-var">findFixedPoint</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">nub</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679177126"><span class="hs-identifier hs-var">expand</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679177125"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679177126"><a href="#local-6989586621679177126"><span class="hs-identifier">expand</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-identifier hs-var">expandExtension</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-comment">-- | Terminating variant of Control.Monad.Fix.fix</span><span>
</span><a name="line-94"></a><span class="hs-comment">-- It tries to find the fixpoint of a function with a given starting value.</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- It terminates if a value repeats itself.</span><span>
</span><a name="line-96"></a><span class="hs-identifier">findFixedPoint</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679177094"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679177094"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177094"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177094"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177094"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-97"></a><a name="findFixedPoint"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#findFixedPoint"><span class="hs-identifier">findFixedPoint</span></a></a><span> </span><a name="local-6989586621679177127"><a href="#local-6989586621679177127"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679177128"><a href="#local-6989586621679177128"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679177129"><span class="hs-identifier hs-var">findFix'</span></a><span> </span><a href="#local-6989586621679177127"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679177127"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679177128"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679177128"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-98"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679177129"><a href="#local-6989586621679177129"><span class="hs-identifier">findFix'</span></a></a><span> </span><a name="local-6989586621679177130"><a href="#local-6989586621679177130"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679177131"><a href="#local-6989586621679177131"><span class="hs-identifier">cur</span></a></a><span> </span><a name="local-6989586621679177132"><a href="#local-6989586621679177132"><span class="hs-identifier">prev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679177131"><span class="hs-identifier hs-var">cur</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679177132"><span class="hs-identifier hs-var">prev</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679177131"><span class="hs-identifier hs-var">cur</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679177129"><span class="hs-identifier hs-var">findFix'</span></a><span> </span><a href="#local-6989586621679177130"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679177130"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679177131"><span class="hs-identifier hs-var">cur</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679177131"><span class="hs-identifier hs-var">cur</span></a><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-identifier">determineExtensions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SMap.Map</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679177093"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">]</span><span>
</span><a name="line-101"></a><span class="hs-comment">{- NOTE:
 We calculate all possible extension sets that satisfy the logical relation,
 then for each extension we remove all the extensions implied by it, (mergeImplied)
 finally we select the minimal extension set.

 An extension set is minimal if:
  - it contains the least amount of extensions
  - it contains extension with minimal complexity
  - it is lexicographically the first one (based on the Ord instance of Extension)

  TODO: Comparing on length might be unnecessary
-}</span><span>
</span><a name="line-113"></a><a name="determineExtensions"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#determineExtensions"><span class="hs-identifier">determineExtensions</span></a></a><span> </span><a name="local-6989586621679177133"><a href="#local-6989586621679177133"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679177136"><span class="hs-identifier hs-var">minimal</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679177135"><span class="hs-identifier hs-var">toExts</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679177134"><span class="hs-identifier hs-var">solution</span></a><span>
</span><a name="line-114"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679177134"><a href="#local-6989586621679177134"><span class="hs-identifier">solution</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">solve_all</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">All</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LMap.keys</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679177133"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-115"></a><span>        </span><a name="local-6989586621679177135"><a href="#local-6989586621679177135"><span class="hs-identifier">toExts</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#mergeImplied"><span class="hs-identifier hs-var">mergeImplied</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LMap.toList</span><span>
</span><a name="line-116"></a><span>        </span><a name="local-6989586621679177136"><a href="#local-6989586621679177136"><span class="hs-identifier">minimal</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">minimumBy</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">length</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#complexity"><span class="hs-identifier hs-var">complexity</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">sort</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-identifier">rmImplied</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Extension</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">]</span><span>
</span><a name="line-119"></a><a name="rmImplied"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#rmImplied"><span class="hs-identifier">rmImplied</span></a></a><span> </span><a name="local-6989586621679177137"><a href="#local-6989586621679177137"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">\\</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679177138"><span class="hs-identifier hs-var">implied</span></a><span>
</span><a name="line-120"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679177138"><a href="#local-6989586621679177138"><span class="hs-identifier">implied</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">delete</span><span> </span><a href="#local-6989586621679177137"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#expandExtension%27"><span class="hs-identifier hs-var">expandExtension'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679177137"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-identifier">mergeImplied</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">]</span><span>
</span><a name="line-123"></a><a name="mergeImplied"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#mergeImplied"><span class="hs-identifier">mergeImplied</span></a></a><span> </span><a name="local-6989586621679177139"><a href="#local-6989586621679177139"><span class="hs-identifier">exts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#rmImplied"><span class="hs-identifier hs-var">rmImplied</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679177139"><span class="hs-identifier hs-var">exts</span></a><span> </span><a href="#local-6989586621679177139"><span class="hs-identifier hs-var">exts</span></a><span>
</span><a name="line-124"></a></pre></body></html>