<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Generation of type-level AST fragments for refactorings.</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- The bindings defined here create a the annotated version of the AST constructor with the same name.</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- For example, @mkTyForall@ creates the annotated version of the @TyForall@ AST constructor.</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE MonoLocalBinds #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.Tools.Rewrite.Create.Types</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.String</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.Tools.AST</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.Tools.PrettyPrint.Prepare</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Kinds.html"><span class="hs-identifier">Language.Haskell.Tools.Rewrite.Create.Kinds</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Kinds.html#mkKindConstraint"><span class="hs-identifier hs-var">mkKindConstraint</span></a><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Names.html"><span class="hs-identifier">Language.Haskell.Tools.Rewrite.Create.Names</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Names.html#mkUnqualName%27"><span class="hs-identifier hs-var">mkUnqualName'</span></a><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html"><span class="hs-identifier">Language.Haskell.Tools.Rewrite.Create.Utils</span></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html"><span class="hs-identifier">Language.Haskell.Tools.Rewrite.ElementTypes</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">GHC</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-comment">-- * Generation of types</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-comment">-- | Forall types (@ forall x y . type @)</span><span>
</span><a name="line-21"></a><span class="hs-identifier">mkForallType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-22"></a><a name="mkForallType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkForallType"><span class="hs-identifier">mkForallType</span></a></a><span> </span><a name="local-6989586621679095109"><a href="#local-6989586621679095109"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621679095110"><a href="#local-6989586621679095110"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;forall &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; . &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UTyForall</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679095109"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679095110"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">-- | Simplified creation of type variables</span><span>
</span><a name="line-25"></a><span class="hs-identifier">mkTypeVar'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">GHC.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-26"></a><a name="mkTypeVar%27"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkTypeVar%27"><span class="hs-identifier">mkTypeVar'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkTypeVar"><span class="hs-identifier hs-var">mkTypeVar</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Names.html#mkUnqualName%27"><span class="hs-identifier hs-var">mkUnqualName'</span></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-comment">-- | Type with a context (@ forall x y . type @)</span><span>
</span><a name="line-29"></a><span class="hs-identifier">mkCtxType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-30"></a><a name="mkCtxType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkCtxType"><span class="hs-identifier">mkCtxType</span></a></a><span> </span><a name="local-6989586621679095111"><a href="#local-6989586621679095111"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679095112"><a href="#local-6989586621679095112"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UTyCtx</span><span> </span><a href="#local-6989586621679095111"><span class="hs-identifier hs-var">ctx</span></a><span> </span><a href="#local-6989586621679095112"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-comment">-- | Function types (@ a -&gt; b @)</span><span>
</span><a name="line-33"></a><span class="hs-identifier">mkFunctionType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-34"></a><a name="mkFunctionType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkFunctionType"><span class="hs-identifier">mkFunctionType</span></a></a><span> </span><a name="local-6989586621679095113"><a href="#local-6989586621679095113"><span class="hs-identifier">at</span></a></a><span> </span><a name="local-6989586621679095114"><a href="#local-6989586621679095114"><span class="hs-identifier">rt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; -&gt; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UTyFun</span><span> </span><a href="#local-6989586621679095113"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="#local-6989586621679095114"><span class="hs-identifier hs-var">rt</span></a><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-comment">-- | Tuple types (@ (a,b) @)</span><span>
</span><a name="line-37"></a><span class="hs-identifier">mkTupleType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-38"></a><a name="mkTupleType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkTupleType"><span class="hs-identifier">mkTupleType</span></a></a><span> </span><a name="local-6989586621679095115"><a href="#local-6989586621679095115"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UTyTuple</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679095115"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">-- | Unboxed tuple types (@ (\#a,b\#) @)</span><span>
</span><a name="line-41"></a><span class="hs-identifier">mkUnboxedTupleType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-42"></a><a name="mkUnboxedTupleType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkUnboxedTupleType"><span class="hs-identifier">mkUnboxedTupleType</span></a></a><span> </span><a name="local-6989586621679095116"><a href="#local-6989586621679095116"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(#&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;#)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UTyUnbTuple</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679095116"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">-- | List type with special syntax (@ [a] @)</span><span>
</span><a name="line-45"></a><span class="hs-identifier">mkListType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-46"></a><a name="mkListType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkListType"><span class="hs-identifier">mkListType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;[&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;]&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyList</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">-- | Parallel array type (@ [:a:] @)</span><span>
</span><a name="line-49"></a><span class="hs-identifier">mkParArrayType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-50"></a><a name="mkParArrayType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkParArrayType"><span class="hs-identifier">mkParArrayType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;[:&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;:]&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyParArray</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">-- | Type application (@ F a @)</span><span>
</span><a name="line-53"></a><span class="hs-identifier">mkTypeApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-54"></a><a name="mkTypeApp"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkTypeApp"><span class="hs-identifier">mkTypeApp</span></a></a><span> </span><a name="local-6989586621679095117"><a href="#local-6989586621679095117"><span class="hs-identifier">ft</span></a></a><span> </span><a name="local-6989586621679095118"><a href="#local-6989586621679095118"><span class="hs-identifier">at</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UTyApp</span><span> </span><a href="#local-6989586621679095117"><span class="hs-identifier hs-var">ft</span></a><span> </span><a href="#local-6989586621679095118"><span class="hs-identifier hs-var">at</span></a><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">-- | Infix type constructor (@ (a &lt;: b) @)</span><span>
</span><a name="line-57"></a><span class="hs-identifier">mkInfixTypeApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Operator"><span class="hs-identifier hs-type">Operator</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-58"></a><a name="mkInfixTypeApp"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkInfixTypeApp"><span class="hs-identifier">mkInfixTypeApp</span></a></a><span> </span><a name="local-6989586621679095119"><a href="#local-6989586621679095119"><span class="hs-identifier">left</span></a></a><span> </span><a name="local-6989586621679095120"><a href="#local-6989586621679095120"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679095121"><a href="#local-6989586621679095121"><span class="hs-identifier">right</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UTyInfix</span><span> </span><a href="#local-6989586621679095119"><span class="hs-identifier hs-var">left</span></a><span> </span><a href="#local-6989586621679095120"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679095121"><span class="hs-identifier hs-var">right</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">-- | Type surrounded by parentheses (@ (T a) @)</span><span>
</span><a name="line-61"></a><span class="hs-identifier">mkParenType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-62"></a><a name="mkParenType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkParenType"><span class="hs-identifier">mkParenType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyParen</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">-- | Creates a simple type variable</span><span>
</span><a name="line-65"></a><span class="hs-identifier">mkTypeVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-66"></a><a name="mkTypeVar"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkTypeVar"><span class="hs-identifier">mkTypeVar</span></a></a><span> </span><a name="local-6989586621679095122"><a href="#local-6989586621679095122"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UTyVarDecl</span><span> </span><a href="#local-6989586621679095122"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#noth"><span class="hs-identifier hs-var">noth</span></a><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-comment">-- | Creates a type variable with kind specification (@ t :: * @)</span><span>
</span><a name="line-69"></a><span class="hs-identifier">mkKindedTypeVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-70"></a><a name="mkKindedTypeVar"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkKindedTypeVar"><span class="hs-identifier">mkKindedTypeVar</span></a></a><span> </span><a name="local-6989586621679095123"><a href="#local-6989586621679095123"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679095124"><a href="#local-6989586621679095124"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UTyVarDecl</span><span> </span><a href="#local-6989586621679095123"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#justVal"><span class="hs-identifier hs-var">justVal</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Kinds.html#mkKindConstraint"><span class="hs-identifier hs-var">mkKindConstraint</span></a><span> </span><a href="#local-6989586621679095124"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- | Type variable or constructor (@ a @)</span><span>
</span><a name="line-73"></a><span class="hs-identifier">mkVarType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-74"></a><a name="mkVarType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkVarType"><span class="hs-identifier">mkVarType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#wrapperAnn"><span class="hs-identifier hs-var">wrapperAnn</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyVar</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">-- | Type with explicit kind signature (@ a :: * @)</span><span>
</span><a name="line-77"></a><span class="hs-identifier">mkKindedType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-78"></a><a name="mkKindedType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkKindedType"><span class="hs-identifier">mkKindedType</span></a></a><span> </span><a name="local-6989586621679095125"><a href="#local-6989586621679095125"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679095126"><a href="#local-6989586621679095126"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; :: &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UTyKinded</span><span> </span><a href="#local-6989586621679095125"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679095126"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- | Strict type marked with @!@.</span><span>
</span><a name="line-81"></a><span class="hs-identifier">mkBangType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-82"></a><a name="mkBangType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkBangType"><span class="hs-identifier">mkBangType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;!&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyBang</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-comment">-- | Lazy type marked with @~@. (Should only be used if @Strict@ or @StrictData@ language extension is used)</span><span>
</span><a name="line-85"></a><span class="hs-identifier">mkLazyType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-86"></a><a name="mkLazyType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkLazyType"><span class="hs-identifier">mkLazyType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;~&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyLazy</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- | Strict type marked with UNPACK pragma. (Usually contains the bang mark.)</span><span>
</span><a name="line-89"></a><span class="hs-identifier">mkUnpackType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-90"></a><a name="mkUnpackType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkUnpackType"><span class="hs-identifier">mkUnpackType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;{-# UNPACK #-} &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyUnpack</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-comment">-- | Strict type marked with UNPACK pragma. (Usually contains the bang mark.)</span><span>
</span><a name="line-93"></a><span class="hs-identifier">mkNoUnpackType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-94"></a><a name="mkNoUnpackType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkNoUnpackType"><span class="hs-identifier">mkNoUnpackType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;{-# NOUNPACK #-} &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyNoUnpack</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-comment">-- | A wildcard type (@ _ @) with @-XPartialTypeSignatures@</span><span>
</span><a name="line-97"></a><span class="hs-identifier">mkWildcardType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-98"></a><a name="mkWildcardType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkWildcardType"><span class="hs-identifier">mkWildcardType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-string">&quot;_&quot;</span><span> </span><span class="hs-identifier hs-var">UTyWildcard</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-comment">-- | A named wildcard type (@ _t @) with @-XPartialTypeSignatures@</span><span>
</span><a name="line-101"></a><span class="hs-identifier">mkNamedWildcardType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-102"></a><a name="mkNamedWildcardType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkNamedWildcardType"><span class="hs-identifier">mkNamedWildcardType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;_&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyNamedWildc</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">-- | A Template Haskell splice type (@ $(genType) @).</span><span>
</span><a name="line-105"></a><span class="hs-identifier">mkSpliceType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Splice"><span class="hs-identifier hs-type">Splice</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-106"></a><a name="mkSpliceType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkSpliceType"><span class="hs-identifier">mkSpliceType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTySplice</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-comment">-- | A Template Haskell quasi-quote type (@ [quoter| ... ] @).</span><span>
</span><a name="line-109"></a><span class="hs-identifier">mkQuasiQuoteType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#QuasiQuote"><span class="hs-identifier hs-type">QuasiQuote</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-110"></a><a name="mkQuasiQuoteType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkQuasiQuoteType"><span class="hs-identifier">mkQuasiQuoteType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyQuasiQuote</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-comment">-- | Numeric value promoted to the kind level.</span><span>
</span><a name="line-114"></a><span class="hs-identifier">mkPromotedIntType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-115"></a><a name="mkPromotedIntType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkPromotedIntType"><span class="hs-identifier">mkPromotedIntType</span></a></a><span> </span><a name="local-6989586621679095127"><a href="#local-6989586621679095127"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UTyPromoted</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679095127"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UPromotedInt</span><span> </span><a href="#local-6989586621679095127"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- | String value promoted to the kind level.</span><span>
</span><a name="line-118"></a><span class="hs-identifier">mkPromotedStringType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-119"></a><a name="mkPromotedStringType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkPromotedStringType"><span class="hs-identifier">mkPromotedStringType</span></a></a><span> </span><a name="local-6989586621679095128"><a href="#local-6989586621679095128"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UTyPromoted</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679095128"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UPromotedString</span><span> </span><a href="#local-6989586621679095128"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- | A data constructor value promoted to the kind level.</span><span>
</span><a name="line-122"></a><span class="hs-identifier">mkPromotedConType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-123"></a><a name="mkPromotedConType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkPromotedConType"><span class="hs-identifier">mkPromotedConType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyPromoted</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UPromotedCon</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">-- | A list of elements as a kind.</span><span>
</span><a name="line-126"></a><span class="hs-identifier">mkPromotedListType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-127"></a><a name="mkPromotedListType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkPromotedListType"><span class="hs-identifier">mkPromotedListType</span></a></a><span>
</span><a name="line-128"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyPromoted</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;[&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;]&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UPromotedList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">-- | A tuple of elements as a kind.</span><span>
</span><a name="line-131"></a><span class="hs-identifier">mkPromotedTupleType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-132"></a><a name="mkPromotedTupleType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkPromotedTupleType"><span class="hs-identifier">mkPromotedTupleType</span></a></a><span>
</span><a name="line-133"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTyPromoted</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UPromotedTuple</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- | Kind of the unit value @()@.</span><span>
</span><a name="line-136"></a><span class="hs-identifier">mkPromotedUnitType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-137"></a><a name="mkPromotedUnitType"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkPromotedUnitType"><span class="hs-identifier">mkPromotedUnitType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UTyPromoted</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-string">&quot;()&quot;</span><span> </span><span class="hs-identifier hs-var">UPromotedUnit</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-- * Generation of contexts</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">-- | Creates a context of assertions (@ C a =&gt; ... @)</span><span>
</span><a name="line-142"></a><span class="hs-identifier">mkContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Assertion"><span class="hs-identifier hs-type">Assertion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Context"><span class="hs-identifier hs-type">Context</span></a><span>
</span><a name="line-143"></a><a name="mkContext"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkContext"><span class="hs-identifier">mkContext</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; =&gt;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UContext</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">-- * Generation of assertions</span><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span class="hs-comment">-- | Class assertion (@Cls x@)</span><span>
</span><a name="line-148"></a><span class="hs-identifier">mkClassAssert</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Assertion"><span class="hs-identifier hs-type">Assertion</span></a><span>
</span><a name="line-149"></a><span class="hs-comment">-- fixme: class assertion without parameters should not have the last space</span><span>
</span><a name="line-150"></a><a name="mkClassAssert"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkClassAssert"><span class="hs-identifier">mkClassAssert</span></a></a><span> </span><a name="local-6989586621679095129"><a href="#local-6989586621679095129"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679095130"><a href="#local-6989586621679095130"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UClassAssert</span><span> </span><a href="#local-6989586621679095129"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679095130"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | Infix class assertion, also contains type equations (@ a ~ X y @)</span><span>
</span><a name="line-153"></a><span class="hs-identifier">mkInfixAssert</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Operator"><span class="hs-identifier hs-type">Operator</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Assertion"><span class="hs-identifier hs-type">Assertion</span></a><span>
</span><a name="line-154"></a><a name="mkInfixAssert"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkInfixAssert"><span class="hs-identifier">mkInfixAssert</span></a></a><span> </span><a name="local-6989586621679095131"><a href="#local-6989586621679095131"><span class="hs-identifier">left</span></a></a><span> </span><a name="local-6989586621679095132"><a href="#local-6989586621679095132"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679095133"><a href="#local-6989586621679095133"><span class="hs-identifier">right</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UInfixAssert</span><span> </span><a href="#local-6989586621679095131"><span class="hs-identifier hs-var">left</span></a><span> </span><a href="#local-6989586621679095132"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679095133"><span class="hs-identifier hs-var">right</span></a><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">-- | Creates an assertion for implicit parameter binding (@ ?cmp :: a -&gt; a -&gt; Bool @)</span><span>
</span><a name="line-157"></a><span class="hs-identifier">mkImplicitAssert</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Assertion"><span class="hs-identifier hs-type">Assertion</span></a><span>
</span><a name="line-158"></a><a name="mkImplicitAssert"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkImplicitAssert"><span class="hs-identifier">mkImplicitAssert</span></a></a><span> </span><a name="local-6989586621679095134"><a href="#local-6989586621679095134"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679095135"><a href="#local-6989586621679095135"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; :: &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UImplicitAssert</span><span> </span><a href="#local-6989586621679095134"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679095135"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">-- | Creates a list of assertions (@ (Eq a, Show a) @)</span><span>
</span><a name="line-161"></a><span class="hs-identifier">mkTupleAssertion</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Assertion"><span class="hs-identifier hs-type">Assertion</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Assertion"><span class="hs-identifier hs-type">Assertion</span></a><span>
</span><a name="line-162"></a><a name="mkTupleAssertion"><a href="Language.Haskell.Tools.Rewrite.Create.Types.html#mkTupleAssertion"><span class="hs-identifier">mkTupleAssertion</span></a></a><span> </span><a name="local-6989586621679095136"><a href="#local-6989586621679095136"><span class="hs-identifier">ass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UTupleAssert</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679095136"><span class="hs-identifier hs-var">ass</span></a><span>
</span><a name="line-163"></a></pre></body></html>