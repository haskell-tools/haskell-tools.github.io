<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass, DeriveGeneric, StandaloneDeriving #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Refactor</span><span class="hs-operator">.</span><span class="hs-identifier">Builtin</span><span class="hs-operator">.</span><span class="hs-identifier">ExtensionOrganizer</span><span class="hs-operator">.</span><span class="hs-identifier">ExtMap</span><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Refactor</span><span class="hs-operator">.</span><span class="hs-identifier">Builtin</span><span class="hs-operator">.</span><span class="hs-identifier">ExtensionOrganizer</span><span class="hs-operator">.</span><span class="hs-identifier">ExtMap</span><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">LanguageExtensions</span><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Formula</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Generics</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">DeepSeq</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">SrcLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">All</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Function</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">on</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LMap</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">SMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">SAT</span><span class="hs-operator">.</span><span class="hs-identifier">MiniSat</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">LanguageExtensions</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Refactor</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span><span class="hs-operator">.</span><span class="hs-identifier">Extensions</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">expandExtension</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-pragma">{-# ANN module &quot;HLint: ignore Redundant lambda&quot; #-}</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span>  </span><span class="hs-identifier hs-type">Extension</span><span>
</span><a name="line-29"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><span class="hs-identifier hs-type">Extension</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-identifier hs-type">Extension</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-32"></a><span>  </span><a name="local-8214565720323789106"><span class="hs-identifier">rnf</span></a><span> </span><a name="local-6989586621679144097"><a href="#local-6989586621679144097"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">seq</span><span> </span><a href="#local-6989586621679144097"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Generic</span><span> </span><a href="#local-6989586621679144119"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Generic</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Formula</span><span> </span><a href="#local-6989586621679144119"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span> </span><a href="#local-6989586621679144118"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="#local-6989586621679144118"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Formula</span><span> </span><a href="#local-6989586621679144118"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">type</span><span> </span><a name="LogicalRelation"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier">LogicalRelation</span></a></a><span> </span><a name="local-6989586621679143351"><a href="#local-6989586621679143351"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Formula</span><span> </span><a href="#local-6989586621679143351"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-keyword">type</span><span> </span><a name="ExtMap"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#ExtMap"><span class="hs-identifier">ExtMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">SMap</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">]</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-identifier">lVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679144104"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679144104"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-42"></a><a name="lVar"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#lVar"><span class="hs-identifier">lVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Var</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-identifier">lNot</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679144103"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679144103"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-45"></a><a name="lNot"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#lNot"><span class="hs-identifier">lNot</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Var</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-identifier">lAnd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679144102"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679144102"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679144102"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-48"></a><a name="lAnd"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#lAnd"><span class="hs-identifier">lAnd</span></a></a><span> </span><a name="local-6989586621679144105"><a href="#local-6989586621679144105"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679144106"><a href="#local-6989586621679144106"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621679144105"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">:&amp;&amp;:</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621679144106"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-identifier">lOr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679144101"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679144101"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679144101"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-51"></a><a name="lOr"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#lOr"><span class="hs-identifier">lOr</span></a></a><span> </span><a name="local-6989586621679144107"><a href="#local-6989586621679144107"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679144108"><a href="#local-6989586621679144108"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621679144107"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">:||:</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621679144108"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-identifier">lImplies</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679144100"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679144100"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679144100"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-54"></a><a name="lImplies"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#lImplies"><span class="hs-identifier">lImplies</span></a></a><span> </span><a name="local-6989586621679144109"><a href="#local-6989586621679144109"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679144110"><a href="#local-6989586621679144110"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621679144109"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">:-&gt;:</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621679144110"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-identifier">lAll</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679144099"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><a href="#local-6989586621679144099"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-57"></a><a name="lAll"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#lAll"><span class="hs-identifier">lAll</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">All</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-identifier">complexity</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Extension</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-60"></a><a name="complexity"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#complexity"><span class="hs-identifier">complexity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">expandExtension</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-identifier">determineExtensions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SMap</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#LogicalRelation"><span class="hs-identifier hs-type">LogicalRelation</span></a><span> </span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679144098"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">]</span><span>
</span><a name="line-63"></a><span class="hs-comment">{- NOTE:
 We calculate all the possible extension set that satisfy the logical relation,
 then for each extension we remove all the extensions implied by it, (mergeImplied)
 finally we select the minimal extension set.

 An extension set is minimal if:
  - it contains the least amount of extensions
  - it contains extension with minimal complexity
  - it is lexicographically the first one (based on the Ord instance of Extension)
-}</span><span>
</span><a name="line-73"></a><a name="determineExtensions"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#determineExtensions"><span class="hs-identifier">determineExtensions</span></a></a><span> </span><a name="local-6989586621679144111"><a href="#local-6989586621679144111"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679144114"><span class="hs-identifier hs-var">minimal</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679144113"><span class="hs-identifier hs-var">toExts</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679144112"><span class="hs-identifier hs-var">solution</span></a><span>
</span><a name="line-74"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679144112"><a href="#local-6989586621679144112"><span class="hs-identifier">solution</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">solve_all</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">All</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">keys</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679144111"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-75"></a><span>        </span><a name="local-6989586621679144113"><a href="#local-6989586621679144113"><span class="hs-identifier">toExts</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#mergeImplied"><span class="hs-identifier hs-var">mergeImplied</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toList</span><span>
</span><a name="line-76"></a><span>        </span><a name="local-6989586621679144114"><a href="#local-6989586621679144114"><span class="hs-identifier">minimal</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">minimumBy</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">length</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#complexity"><span class="hs-identifier hs-var">complexity</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">sort</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-identifier">rmImplied</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Extension</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">]</span><span>
</span><a name="line-79"></a><a name="rmImplied"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#rmImplied"><span class="hs-identifier">rmImplied</span></a></a><span> </span><a name="local-6989586621679144115"><a href="#local-6989586621679144115"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">\\</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679144116"><span class="hs-identifier hs-var">implied</span></a><span>
</span><a name="line-80"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679144116"><a href="#local-6989586621679144116"><span class="hs-identifier">implied</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">delete</span><span> </span><a href="#local-6989586621679144115"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">expandExtension</span><span> </span><a href="#local-6989586621679144115"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-identifier">mergeImplied</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Extension</span><span class="hs-special">]</span><span>
</span><a name="line-83"></a><a name="mergeImplied"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#mergeImplied"><span class="hs-identifier">mergeImplied</span></a></a><span> </span><a name="local-6989586621679144117"><a href="#local-6989586621679144117"><span class="hs-identifier">exts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMap.html#rmImplied"><span class="hs-identifier hs-var">rmImplied</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679144117"><span class="hs-identifier hs-var">exts</span></a><span> </span><a href="#local-6989586621679144117"><span class="hs-identifier hs-var">exts</span></a><span>
</span><a name="line-84"></a></pre></body></html>