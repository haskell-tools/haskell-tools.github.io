<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts, RankNTypes, TypeFamilies #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Refactor</span><span class="hs-operator">.</span><span class="hs-identifier">Builtin</span><span class="hs-operator">.</span><span class="hs-identifier">ExtensionOrganizer</span><span class="hs-operator">.</span><span class="hs-identifier">TraverseAST</span><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Refactor</span><span class="hs-operator">.</span><span class="hs-identifier">Builtin</span><span class="hs-operator">.</span><span class="hs-identifier">ExtensionOrganizer</span><span class="hs-operator">.</span><span class="hs-identifier">TraverseAST</span><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Refactor</span><span class="hs-operator">.</span><span class="hs-identifier">Builtin</span><span class="hs-operator">.</span><span class="hs-identifier">ExtensionOrganizer</span><span class="hs-operator">.</span><span class="hs-identifier">ExtMonad</span><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.html"><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Refactor</span><span class="hs-operator">.</span><span class="hs-identifier">Builtin</span><span class="hs-operator">.</span><span class="hs-identifier">ExtensionOrganizer</span><span class="hs-operator">.</span><span class="hs-identifier">Checkers</span></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html"><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Refactor</span><span class="hs-operator">.</span><span class="hs-identifier">Builtin</span><span class="hs-operator">.</span><span class="hs-identifier">ExtensionOrganizer</span><span class="hs-operator">.</span><span class="hs-identifier">ExtMonad</span></a><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">AST</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Refactor</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Refact</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Reference</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">!~</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&amp;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&amp;+&amp;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-comment">{-
   NOTE: We need Decl level checking for deriving clausese
         in order to gain extra information from the newtype and data keywords.

         We need Decl level checking for instance heads, in order to distinguish
         class instances from data and type family instances.
-}</span><span>
</span><a name="line-23"></a><span class="hs-identifier">chkDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Decl</span><span>
</span><a name="line-24"></a><a name="chkDecl"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkDecl"><span class="hs-identifier">chkDecl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.FlexibleInstancesChecker.html#chkFlexibleInstances"><span class="hs-identifier hs-var">chkFlexibleInstances</span></a><span> </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.DerivingsChecker.html#chkDerivings"><span class="hs-identifier hs-var">chkDerivings</span></a><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-identifier">chkPattern</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Pattern</span><span>
</span><a name="line-27"></a><a name="chkPattern"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkPattern"><span class="hs-identifier">chkPattern</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.BangPatternsChecker.html#chkBangPatterns"><span class="hs-identifier hs-var">chkBangPatterns</span></a><span>
</span><a name="line-28"></a><span>         </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.ViewPatternsChecker.html#chkViewPatterns"><span class="hs-identifier hs-var">chkViewPatterns</span></a><span>
</span><a name="line-29"></a><span>         </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.UnboxedTuplesChecker.html#chkUnboxedTuplesPat"><span class="hs-identifier hs-var">chkUnboxedTuplesPat</span></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-identifier">chkExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Expr</span><span>
</span><a name="line-32"></a><a name="chkExpr"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkExpr"><span class="hs-identifier">chkExpr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.TupleSectionsChecker.html#chkTupleSections"><span class="hs-identifier hs-var">chkTupleSections</span></a><span>
</span><a name="line-33"></a><span>      </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.UnboxedTuplesChecker.html#chkUnboxedTuplesExpr"><span class="hs-identifier hs-var">chkUnboxedTuplesExpr</span></a><span>
</span><a name="line-34"></a><span>      </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.LambdaCaseChecker.html#chkLambdaCase"><span class="hs-identifier hs-var">chkLambdaCase</span></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-identifier">chkType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-37"></a><a name="chkType"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkType"><span class="hs-identifier">chkType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.UnboxedTuplesChecker.html#chkUnboxedTuplesType"><span class="hs-identifier hs-var">chkUnboxedTuplesType</span></a><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-identifier">chkPatternField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">PatternField</span><span>
</span><a name="line-40"></a><a name="chkPatternField"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkPatternField"><span class="hs-identifier">chkPatternField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.RecordWildCardsChecker.html#chkRecordWildCardsPatField"><span class="hs-identifier hs-var">chkRecordWildCardsPatField</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-identifier">chkFieldUpdate</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">FieldUpdate</span><span>
</span><a name="line-43"></a><a name="chkFieldUpdate"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkFieldUpdate"><span class="hs-identifier">chkFieldUpdate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.RecordWildCardsChecker.html#chkRecordWildCardsFieldUpdate"><span class="hs-identifier hs-var">chkRecordWildCardsFieldUpdate</span></a><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-identifier">chkPatternSynonym</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">PatternSynonym</span><span>
</span><a name="line-46"></a><a name="chkPatternSynonym"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkPatternSynonym"><span class="hs-identifier">chkPatternSynonym</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.PatternSynonymsChecker.html#chkPatternSynonymsSyn"><span class="hs-identifier hs-var">chkPatternSynonymsSyn</span></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-identifier">chkPatternSignature</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">PatternSignature</span><span>
</span><a name="line-49"></a><a name="chkPatternSignature"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkPatternSignature"><span class="hs-identifier">chkPatternSignature</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.PatternSynonymsChecker.html#chkPatternSynonymsTypeSig"><span class="hs-identifier hs-var">chkPatternSynonymsTypeSig</span></a><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-identifier">chkLiteral</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Literal</span><span>
</span><a name="line-52"></a><a name="chkLiteral"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkLiteral"><span class="hs-identifier">chkLiteral</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.MagicHashChecker.html#chkMagicHashLiteral"><span class="hs-identifier hs-var">chkMagicHashLiteral</span></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-identifier">chkNamePart</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">NamePart</span><span>
</span><a name="line-55"></a><a name="chkNamePart"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkNamePart"><span class="hs-identifier">chkNamePart</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.MagicHashChecker.html#chkMagicHashNamePart"><span class="hs-identifier hs-var">chkMagicHashNamePart</span></a><span>
</span><a name="line-56"></a><span>          </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.TemplateHaskellChecker.html#chkTemplateHaskellhNamePart"><span class="hs-identifier hs-var">chkTemplateHaskellhNamePart</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-identifier">chkKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Kind</span><span>
</span><a name="line-59"></a><a name="chkKind"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkKind"><span class="hs-identifier">chkKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.MagicHashChecker.html#chkMagicHashKind"><span class="hs-identifier hs-var">chkMagicHashKind</span></a><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-identifier">traverseModule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">UnnamedModule</span><span>
</span><a name="line-63"></a><a name="traverseModule"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseModule"><span class="hs-identifier">traverseModule</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">modDecl</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseDecl"><span class="hs-identifier hs-var">traverseDecl</span></a><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>             </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">modHead</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseModuleHead"><span class="hs-identifier hs-var">traverseModuleHead</span></a><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span>             </span><span class="hs-comment">-- more</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-identifier">traverseModuleHead</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">ModuleHead</span><span>
</span><a name="line-68"></a><a name="traverseModuleHead"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseModuleHead"><span class="hs-identifier">traverseModuleHead</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mhExports</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExportSpecs"><span class="hs-identifier hs-var">traverseExportSpecs</span></a><span>
</span><a name="line-69"></a><span>                    </span><span class="hs-comment">-- more</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-identifier">traverseExportSpecs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">ExportSpecs</span><span>
</span><a name="line-72"></a><a name="traverseExportSpecs"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExportSpecs"><span class="hs-identifier">traverseExportSpecs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">espExports</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExportSpec"><span class="hs-identifier hs-var">traverseExportSpec</span></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-identifier">traverseExportSpec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">ExportSpec</span><span>
</span><a name="line-75"></a><a name="traverseExportSpec"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExportSpec"><span class="hs-identifier">traverseExportSpec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">exportDecl</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseIESpec"><span class="hs-identifier hs-var">traverseIESpec</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-identifier">traverseIESpec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">IESpec</span><span>
</span><a name="line-78"></a><a name="traverseIESpec"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseIESpec"><span class="hs-identifier">traverseIESpec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ieName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>             </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ieSubspec</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseSubSpec"><span class="hs-identifier hs-var">traverseSubSpec</span></a><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-identifier">traverseSubSpec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">SubSpec</span><span>
</span><a name="line-82"></a><a name="traverseSubSpec"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseSubSpec"><span class="hs-identifier">traverseSubSpec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">essList</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-identifier">traverseDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Decl</span><span>
</span><a name="line-85"></a><a name="traverseDecl"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseDecl"><span class="hs-identifier">traverseDecl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkDecl"><span class="hs-identifier hs-var">chkDecl</span></a><span>
</span><a name="line-86"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declValBind</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseValueBind"><span class="hs-identifier hs-var">traverseValueBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declBody</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseClassBody"><span class="hs-identifier hs-var">traverseClassBody</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declSplice</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseSplice"><span class="hs-identifier hs-var">traverseSplice</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180097"><span class="hs-identifier hs-var">innerType</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declTypeSig</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeSignature"><span class="hs-identifier hs-var">traverseTypeSignature</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declTypeFamily</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeFamily"><span class="hs-identifier hs-var">traverseTypeFamily</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">--</span><span>
</span><a name="line-92"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declSpec</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeFamilySpec"><span class="hs-identifier hs-var">traverseTypeFamilySpec</span></a><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declSafety</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseSafety"><span class="hs-identifier hs-var">traverseSafety</span></a><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declRoles</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseRole"><span class="hs-identifier hs-var">traverseRole</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declPragma</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTopLevelPragma"><span class="hs-identifier hs-var">traverseTopLevelPragma</span></a><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declPatTypeSig</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePatternSignature"><span class="hs-identifier hs-var">traversePatternSignature</span></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declPatSyn</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePatternSynonym"><span class="hs-identifier hs-var">traversePatternSynonym</span></a><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declOverlap</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOverlapPragma"><span class="hs-identifier hs-var">traverseOverlapPragma</span></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declKind</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseKindContraint"><span class="hs-identifier hs-var">traverseKindContraint</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180098"><span class="hs-identifier hs-var">innerInstanceRule</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInstanceRule"><span class="hs-identifier hs-var">traverseInstanceRule</span></a><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declInstDecl</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInstBody"><span class="hs-identifier hs-var">traverseInstBody</span></a><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declHead</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseDeclHead"><span class="hs-identifier hs-var">traverseDeclHead</span></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declGadt</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseGadtConDecl"><span class="hs-identifier hs-var">traverseGadtConDecl</span></a><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declFunDeps</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFunDeps"><span class="hs-identifier hs-var">traverseFunDeps</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declForeignType</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declFixity</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFixitySignature"><span class="hs-identifier hs-var">traverseFixitySignature</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declDeriving</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseDeriving"><span class="hs-identifier hs-var">traverseDeriving</span></a><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declDecl</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeEqn"><span class="hs-identifier hs-var">traverseTypeEqn</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declCtx</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseContext"><span class="hs-identifier hs-var">traverseContext</span></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declCons</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseConDecl"><span class="hs-identifier hs-var">traverseConDecl</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declCallConv</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseCallConv"><span class="hs-identifier hs-var">traverseCallConv</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declRoleType</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseQualifiedName"><span class="hs-identifier hs-var">traverseQualifiedName</span></a><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180097"><a href="#local-6989586621679180097"><span class="hs-identifier">innerType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">declTypes</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>                </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">declType</span><span>
</span><a name="line-117"></a><span>                </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">declAssignedType</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span>        </span><a name="local-6989586621679180098"><a href="#local-6989586621679180098"><span class="hs-identifier">innerInstanceRule</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">declInstance</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">declInstRule</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-identifier">traverseTypeFamily</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">TypeFamily</span><span>
</span><a name="line-122"></a><a name="traverseTypeFamily"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeFamily"><span class="hs-identifier">traverseTypeFamily</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tfHead</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseDeclHead"><span class="hs-identifier hs-var">traverseDeclHead</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>                 </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tfSpec</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeFamilySpec"><span class="hs-identifier hs-var">traverseTypeFamilySpec</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>                 </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tfKind</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseKindContraint"><span class="hs-identifier hs-var">traverseKindContraint</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- tfTypeVar is from 0.9</span><span>
</span><a name="line-127"></a><span class="hs-identifier">traverseTypeFamilySpec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">TypeFamilySpec</span><span>
</span><a name="line-128"></a><a name="traverseTypeFamilySpec"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeFamilySpec"><span class="hs-identifier">traverseTypeFamilySpec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tfSpecKind</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseKindContraint"><span class="hs-identifier hs-var">traverseKindContraint</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>                     </span><span class="hs-comment">-- &gt;=&gt; (tfTypeVar !~ traverseTyVar)</span><span>
</span><a name="line-130"></a><span>                     </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tfInjectivity</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInjectivityAnn"><span class="hs-identifier hs-var">traverseInjectivityAnn</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-identifier">traverseInjectivityAnn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">InjectivityAnn</span><span>
</span><a name="line-133"></a><a name="traverseInjectivityAnn"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInjectivityAnn"><span class="hs-identifier">traverseInjectivityAnn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">injAnnRes</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTyVar"><span class="hs-identifier hs-var">traverseTyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>                     </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">injAnnDeps</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- DONE</span><span>
</span><a name="line-137"></a><span class="hs-identifier">traverseSafety</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Safety</span><span>
</span><a name="line-138"></a><a name="traverseSafety"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseSafety"><span class="hs-identifier">traverseSafety</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-comment">-- DONE</span><span>
</span><a name="line-141"></a><span class="hs-identifier">traverseRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Role</span><span>
</span><a name="line-142"></a><a name="traverseRole"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseRole"><span class="hs-identifier">traverseRole</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-identifier">traverseTopLevelPragma</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">TopLevelPragma</span><span>
</span><a name="line-145"></a><a name="traverseTopLevelPragma"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTopLevelPragma"><span class="hs-identifier">traverseTopLevelPragma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pragmaRule</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseRule"><span class="hs-identifier hs-var">traverseRule</span></a><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span>                     </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pragmaObjects</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>                     </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">annotationSubject</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseAnnotationSubject"><span class="hs-identifier hs-var">traverseAnnotationSubject</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>                     </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pragmaInline</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInlinePragma"><span class="hs-identifier hs-var">traverseInlinePragma</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>                     </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">specializePragma</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseSpecializePragma"><span class="hs-identifier hs-var">traverseSpecializePragma</span></a><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-comment">-- no references for this</span><span>
</span><a name="line-152"></a><span class="hs-identifier">traverseSpecializePragma</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckUNode"><span class="hs-identifier hs-type">CheckUNode</span></a><span> </span><span class="hs-identifier hs-type">USpecializePragma</span><span>
</span><a name="line-153"></a><a name="traverseSpecializePragma"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseSpecializePragma"><span class="hs-identifier">traverseSpecializePragma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-comment">{- (specializeDef !~ traverseName)
                       &gt;=&gt; (specializeType &amp; annList !~ traverseType) -}</span><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-identifier">traverseAnnotationSubject</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">AnnotationSubject</span><span>
</span><a name="line-157"></a><a name="traverseAnnotationSubject"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseAnnotationSubject"><span class="hs-identifier">traverseAnnotationSubject</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">annotateName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-identifier">traverseRule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Rule</span><span>
</span><a name="line-160"></a><a name="traverseRule"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseRule"><span class="hs-identifier">traverseRule</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ruleBounded</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseRuleVar"><span class="hs-identifier hs-var">traverseRuleVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>           </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180099"><span class="hs-identifier hs-var">innerExpr</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>           </span><span class="hs-comment">-- some more</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180099"><a href="#local-6989586621679180099"><span class="hs-identifier">innerExpr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ruleLhs</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">ruleRhs</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-identifier">traverseRuleVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">RuleVar</span><span>
</span><a name="line-167"></a><a name="traverseRuleVar"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseRuleVar"><span class="hs-identifier">traverseRuleVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ruleVarName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ruleVarType</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-identifier">traversePatternSignature</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">PatternSignature</span><span>
</span><a name="line-171"></a><a name="traversePatternSignature"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePatternSignature"><span class="hs-identifier">traversePatternSignature</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkPatternSignature"><span class="hs-identifier hs-var">chkPatternSignature</span></a><span>
</span><a name="line-172"></a><span>                       </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patSigName</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-173"></a><span>                       </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patSigType</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-comment">-- DONE</span><span>
</span><a name="line-176"></a><span class="hs-identifier">traverseOverlapPragma</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">OverlapPragma</span><span>
</span><a name="line-177"></a><a name="traverseOverlapPragma"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOverlapPragma"><span class="hs-identifier">traverseOverlapPragma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-comment">-- weird structure of nodes (Maybe (Ann AnnListG dom stage))</span><span>
</span><a name="line-180"></a><span class="hs-identifier">traverseInstanceRule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">InstanceRule</span><span>
</span><a name="line-181"></a><a name="traverseInstanceRule"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInstanceRule"><span class="hs-identifier">traverseInstanceRule</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">irVars</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">element</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTyVar"><span class="hs-identifier hs-var">traverseTyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">irCtx</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseContext"><span class="hs-identifier hs-var">traverseContext</span></a><span class="hs-special">)</span><span>
</span><a name="line-183"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">irHead</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInstanceHead"><span class="hs-identifier hs-var">traverseInstanceHead</span></a><span class="hs-special">)</span><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-identifier">traverseInstanceHead</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">InstanceHead</span><span>
</span><a name="line-186"></a><a name="traverseInstanceHead"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInstanceHead"><span class="hs-identifier">traverseInstanceHead</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ihConName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-187"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ihOperator</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOperator"><span class="hs-identifier hs-var">traverseOperator</span></a><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180100"><span class="hs-identifier hs-var">innerType</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-189"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180101"><span class="hs-identifier hs-var">innerIHead</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInstanceHead"><span class="hs-identifier hs-var">traverseInstanceHead</span></a><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180100"><a href="#local-6989586621679180100"><span class="hs-identifier">innerType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ihLeftOp</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">ihType</span><span>
</span><a name="line-192"></a><span>        </span><a name="local-6989586621679180101"><a href="#local-6989586621679180101"><span class="hs-identifier">innerIHead</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ihHead</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">ihFun</span><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span class="hs-identifier">traverseDeclHead</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">DeclHead</span><span>
</span><a name="line-195"></a><a name="traverseDeclHead"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseDeclHead"><span class="hs-identifier">traverseDeclHead</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dhName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-196"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dhOperator</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOperator"><span class="hs-identifier hs-var">traverseOperator</span></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180102"><span class="hs-identifier hs-var">innerDHead</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseDeclHead"><span class="hs-identifier hs-var">traverseDeclHead</span></a><span class="hs-special">)</span><span>
</span><a name="line-198"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180103"><span class="hs-identifier hs-var">innerTyVar</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTyVar"><span class="hs-identifier hs-var">traverseTyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180102"><a href="#local-6989586621679180102"><span class="hs-identifier">innerDHead</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">dhBody</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">dhAppFun</span><span>
</span><a name="line-201"></a><span>        </span><a name="local-6989586621679180103"><a href="#local-6989586621679180103"><span class="hs-identifier">innerTyVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">dhAppOperand</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">dhLeft</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">dhRight</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-identifier">traverseGadtConDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">GadtConDecl</span><span>
</span><a name="line-204"></a><a name="traverseGadtConDecl"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseGadtConDecl"><span class="hs-identifier">traverseGadtConDecl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">gadtConNames</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">gadtConTypeArgs</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTyVar"><span class="hs-identifier hs-var">traverseTyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">gadtConTypeCtx</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseContext"><span class="hs-identifier hs-var">traverseContext</span></a><span class="hs-special">)</span><span>
</span><a name="line-207"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">gadtConType</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseGadtConType"><span class="hs-identifier hs-var">traverseGadtConType</span></a><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-identifier">traverseGadtConType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">GadtConType</span><span>
</span><a name="line-210"></a><a name="traverseGadtConType"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseGadtConType"><span class="hs-identifier">traverseGadtConType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180104"><span class="hs-identifier hs-var">innerType</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-211"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">gadtConRecordFields</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFieldDecl"><span class="hs-identifier hs-var">traverseFieldDecl</span></a><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180104"><a href="#local-6989586621679180104"><span class="hs-identifier">innerType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">gadtConNormalType</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">gadtConResultType</span><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-identifier">traverseFieldDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">FieldDecl</span><span>
</span><a name="line-216"></a><a name="traverseFieldDecl"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFieldDecl"><span class="hs-identifier">traverseFieldDecl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fieldNames</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>                </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fieldType</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-identifier">traverseFunDeps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">FunDeps</span><span>
</span><a name="line-220"></a><a name="traverseFunDeps"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFunDeps"><span class="hs-identifier">traverseFunDeps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">funDeps</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFunDep"><span class="hs-identifier hs-var">traverseFunDep</span></a><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-identifier">traverseFunDep</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">FunDep</span><span>
</span><a name="line-223"></a><a name="traverseFunDep"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFunDep"><span class="hs-identifier">traverseFunDep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679180105"><span class="hs-identifier hs-var">innerName</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span>
</span><a name="line-224"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180105"><a href="#local-6989586621679180105"><span class="hs-identifier">innerName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">funDepLhs</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">funDepRhs</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-identifier">traverseDeriving</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Deriving</span><span>
</span><a name="line-227"></a><a name="traverseDeriving"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseDeriving"><span class="hs-identifier">traverseDeriving</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679180106"><span class="hs-identifier hs-var">innerIHead</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInstanceHead"><span class="hs-identifier hs-var">traverseInstanceHead</span></a><span>
</span><a name="line-228"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180106"><a href="#local-6989586621679180106"><span class="hs-identifier">innerIHead</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">oneDerived</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">allDerived</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-identifier">traverseConDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">ConDecl</span><span>
</span><a name="line-231"></a><a name="traverseConDecl"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseConDecl"><span class="hs-identifier">traverseConDecl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conTypeArgs</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTyVar"><span class="hs-identifier hs-var">traverseTyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conTypeCtx</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseContext"><span class="hs-identifier hs-var">traverseContext</span></a><span class="hs-special">)</span><span>
</span><a name="line-233"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conDeclName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180107"><span class="hs-identifier hs-var">innerType</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conDeclFields</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFieldDecl"><span class="hs-identifier hs-var">traverseFieldDecl</span></a><span class="hs-special">)</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180107"><a href="#local-6989586621679180107"><span class="hs-identifier">innerType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conDeclArgs</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>                </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">conDeclLhs</span><span>
</span><a name="line-239"></a><span>                </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">conDeclRhs</span><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-comment">-- DONE</span><span>
</span><a name="line-242"></a><span class="hs-identifier">traverseCallConv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">CallConv</span><span>
</span><a name="line-243"></a><a name="traverseCallConv"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseCallConv"><span class="hs-identifier">traverseCallConv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-identifier">traverseMinimalFormula</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">MinimalFormula</span><span>
</span><a name="line-246"></a><a name="traverseMinimalFormula"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseMinimalFormula"><span class="hs-identifier">traverseMinimalFormula</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minimalName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span>                     </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180108"><span class="hs-identifier hs-var">innerFormula</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseMinimalFormula"><span class="hs-identifier hs-var">traverseMinimalFormula</span></a><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180108"><a href="#local-6989586621679180108"><span class="hs-identifier">innerFormula</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">minimalInner</span><span>
</span><a name="line-250"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minimalOrs</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minimalAnds</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-comment">-- there is no wrapper type for InlinePragma</span><span>
</span><a name="line-254"></a><span class="hs-comment">-- no references generated</span><span>
</span><a name="line-255"></a><span class="hs-identifier">traverseInlinePragma</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckUNode"><span class="hs-identifier hs-type">CheckUNode</span></a><span> </span><span class="hs-identifier hs-type">UInlinePragma</span><span>
</span><a name="line-256"></a><a name="traverseInlinePragma"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInlinePragma"><span class="hs-identifier">traverseInlinePragma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-comment">{- nnerName !~ traverseName
  where innerName = inlineDef &amp;+&amp; noInlineDef &amp;+&amp; inlinableDef -}</span><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-identifier">traversePatternSynonym</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">PatternSynonym</span><span>
</span><a name="line-263"></a><a name="traversePatternSynonym"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePatternSynonym"><span class="hs-identifier">traversePatternSynonym</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkPatternSynonym"><span class="hs-identifier hs-var">chkPatternSynonym</span></a><span>
</span><a name="line-264"></a><span>                         </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patRhs</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="#local-6989586621679180109"><span class="hs-identifier hs-var">traverseInnerRhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>                         </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patLhs</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="#local-6989586621679180110"><span class="hs-identifier hs-var">traverseInnerLhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180109"><a href="#local-6989586621679180109"><span class="hs-identifier">traverseInnerRhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patRhsPat</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePattern"><span class="hs-identifier hs-var">traversePattern</span></a><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>          </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patRhsOpposite</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">patOpposite</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseMatch"><span class="hs-identifier hs-var">traverseMatch</span></a><span class="hs-special">)</span><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span>        </span><a name="local-6989586621679180110"><a href="#local-6989586621679180110"><span class="hs-identifier">traverseInnerLhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180111"><span class="hs-identifier hs-var">innerName</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-271"></a><span>                           </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patSynOp</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOperator"><span class="hs-identifier hs-var">traverseOperator</span></a><span class="hs-special">)</span><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span>        </span><a name="local-6989586621679180111"><a href="#local-6989586621679180111"><span class="hs-identifier">innerName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">patName</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patArgs</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">patSynLhs</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">patSynRhs</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span class="hs-identifier">traverseMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Match</span><span>
</span><a name="line-278"></a><a name="traverseMatch"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseMatch"><span class="hs-identifier">traverseMatch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">matchLhs</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseMatchLhs"><span class="hs-identifier hs-var">traverseMatchLhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-279"></a><span>                </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">matchRhs</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseRhs"><span class="hs-identifier hs-var">traverseRhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-280"></a><span>                </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">matchBinds</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseLocalBinds"><span class="hs-identifier hs-var">traverseLocalBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span class="hs-identifier">traverseMatchLhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">MatchLhs</span><span>
</span><a name="line-283"></a><a name="traverseMatchLhs"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseMatchLhs"><span class="hs-identifier">traverseMatchLhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">matchLhsName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-284"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">matchLhsOperator</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOperator"><span class="hs-identifier hs-var">traverseOperator</span></a><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180112"><span class="hs-identifier hs-var">innerPattern</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePattern"><span class="hs-identifier hs-var">traversePattern</span></a><span class="hs-special">)</span><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180112"><a href="#local-6989586621679180112"><span class="hs-identifier">innerPattern</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">matchLhsArgs</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span>
</span><a name="line-288"></a><span>                       </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">matchLhsLhs</span><span>
</span><a name="line-289"></a><span>                       </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">matchLhsRhs</span><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><span class="hs-identifier">traverseRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Rhs</span><span>
</span><a name="line-292"></a><a name="traverseRhs"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseRhs"><span class="hs-identifier">traverseRhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">rhsExpr</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-293"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">rhsGuards</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseGuardedRhs"><span class="hs-identifier hs-var">traverseGuardedRhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span class="hs-identifier">traverseGuardedRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">GuardedRhs</span><span>
</span><a name="line-296"></a><a name="traverseGuardedRhs"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseGuardedRhs"><span class="hs-identifier">traverseGuardedRhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">guardStmts</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseRhsGuard"><span class="hs-identifier hs-var">traverseRhsGuard</span></a><span class="hs-special">)</span><span>
</span><a name="line-297"></a><span>                     </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">guardExpr</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span class="hs-identifier">traverseRhsGuard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">RhsGuard</span><span>
</span><a name="line-300"></a><a name="traverseRhsGuard"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseRhsGuard"><span class="hs-identifier">traverseRhsGuard</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">guardPat</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePattern"><span class="hs-identifier hs-var">traversePattern</span></a><span class="hs-special">)</span><span>
</span><a name="line-301"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">guardRhs</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">guardCheck</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-302"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">guardBinds</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseLocalBind"><span class="hs-identifier hs-var">traverseLocalBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span class="hs-identifier">traverseLocalBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">LocalBinds</span><span>
</span><a name="line-305"></a><a name="traverseLocalBinds"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseLocalBinds"><span class="hs-identifier">traverseLocalBinds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">localBinds</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseLocalBind"><span class="hs-identifier hs-var">traverseLocalBind</span></a><span>
</span><a name="line-306"></a><span>
</span><a name="line-307"></a><span class="hs-identifier">traverseLocalBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">LocalBind</span><span>
</span><a name="line-308"></a><a name="traverseLocalBind"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseLocalBind"><span class="hs-identifier">traverseLocalBind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">localVal</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseValueBind"><span class="hs-identifier hs-var">traverseValueBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-309"></a><span>                    </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">localSig</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeSignature"><span class="hs-identifier hs-var">traverseTypeSignature</span></a><span class="hs-special">)</span><span>
</span><a name="line-310"></a><span>                    </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">localFixity</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFixitySignature"><span class="hs-identifier hs-var">traverseFixitySignature</span></a><span class="hs-special">)</span><span>
</span><a name="line-311"></a><span>                    </span><span class="hs-comment">-- &gt;=&gt; (localInline !~ ...)</span><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-identifier">traverseInstBody</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">InstBody</span><span>
</span><a name="line-315"></a><a name="traverseInstBody"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInstBody"><span class="hs-identifier">traverseInstBody</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">instBodyDecls</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInstBodyDecl"><span class="hs-identifier hs-var">traverseInstBodyDecl</span></a><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span class="hs-identifier">traverseInstBodyDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">InstBodyDecl</span><span>
</span><a name="line-318"></a><a name="traverseInstBodyDecl"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseInstBodyDecl"><span class="hs-identifier">traverseInstBodyDecl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">instBodyDeclFunbind</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseValueBind"><span class="hs-identifier hs-var">traverseValueBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-319"></a><span>                       </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">instBodyTypeSig</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeSignature"><span class="hs-identifier hs-var">traverseTypeSignature</span></a><span class="hs-special">)</span><span>
</span><a name="line-320"></a><span>                       </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">instBodyTypeEqn</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeEqn"><span class="hs-identifier hs-var">traverseTypeEqn</span></a><span class="hs-special">)</span><span>
</span><a name="line-321"></a><span>                       </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">specializeInstanceType</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-322"></a><span>                       </span><span class="hs-comment">-- and many more ...</span><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-identifier">traverseTypeEqn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">TypeEqn</span><span>
</span><a name="line-325"></a><a name="traverseTypeEqn"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeEqn"><span class="hs-identifier">traverseTypeEqn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">teLhs</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">teRhs</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-identifier">traverseClassBody</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">ClassBody</span><span>
</span><a name="line-328"></a><a name="traverseClassBody"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseClassBody"><span class="hs-identifier">traverseClassBody</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cbElements</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseClassElem"><span class="hs-identifier hs-var">traverseClassElem</span></a><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span class="hs-identifier">traverseClassElem</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">ClassElement</span><span>
</span><a name="line-331"></a><a name="traverseClassElem"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseClassElem"><span class="hs-identifier">traverseClassElem</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ceTypeSig</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeSignature"><span class="hs-identifier hs-var">traverseTypeSignature</span></a><span class="hs-special">)</span><span>
</span><a name="line-332"></a><span>                    </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">clsFixity</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFixitySignature"><span class="hs-identifier hs-var">traverseFixitySignature</span></a><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>                    </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ceBind</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseValueBind"><span class="hs-identifier hs-var">traverseValueBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-334"></a><span>                    </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ceName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-335"></a><span>                    </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ceKind</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">ceType</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span>                    </span><span class="hs-comment">-- some more, but are not important</span><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span>
</span><a name="line-340"></a><span class="hs-identifier">traverseValueBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">ValueBind</span><span>
</span><a name="line-341"></a><a name="traverseValueBind"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseValueBind"><span class="hs-identifier">traverseValueBind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">valBindPat</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePattern"><span class="hs-identifier hs-var">traversePattern</span></a><span class="hs-special">)</span><span>
</span><a name="line-342"></a><span>                    </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">valBindRhs</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseRhs"><span class="hs-identifier hs-var">traverseRhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-343"></a><span>                    </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">valBindLocals</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseLocalBinds"><span class="hs-identifier hs-var">traverseLocalBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-344"></a><span>                    </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">funBindMatches</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseMatch"><span class="hs-identifier hs-var">traverseMatch</span></a><span class="hs-special">)</span><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span>
</span><a name="line-347"></a><span class="hs-identifier">traversePattern</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Pattern</span><span>
</span><a name="line-348"></a><a name="traversePattern"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePattern"><span class="hs-identifier">traversePattern</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkPattern"><span class="hs-identifier hs-var">chkPattern</span></a><span>
</span><a name="line-349"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180113"><span class="hs-identifier hs-var">innerPattern</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePattern"><span class="hs-identifier hs-var">traversePattern</span></a><span class="hs-special">)</span><span>
</span><a name="line-350"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180114"><span class="hs-identifier hs-var">innerLiteral</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseLiteral"><span class="hs-identifier hs-var">traverseLiteral</span></a><span class="hs-special">)</span><span>
</span><a name="line-351"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patternOperator</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOperator"><span class="hs-identifier hs-var">traverseOperator</span></a><span class="hs-special">)</span><span>
</span><a name="line-352"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patternFields</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePatternField"><span class="hs-identifier hs-var">traversePatternField</span></a><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patternName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-354"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patternExpr</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patternType</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-356"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patternSplice</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseSplice"><span class="hs-identifier hs-var">traverseSplice</span></a><span class="hs-special">)</span><span>
</span><a name="line-357"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patQQ</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseQuasiQuote"><span class="hs-identifier hs-var">traverseQuasiQuote</span></a><span class="hs-special">)</span><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-360"></a><span>  </span><a name="local-6989586621679180113"><a href="#local-6989586621679180113"><span class="hs-identifier">innerPattern</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">patternLhs</span><span>
</span><a name="line-361"></a><span>                 </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">patternRhs</span><span>
</span><a name="line-362"></a><span>                 </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">patternInner</span><span>
</span><a name="line-363"></a><span>                 </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patternElems</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-364"></a><span>                 </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">patternArgs</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span>  </span><a name="local-6989586621679180114"><a href="#local-6989586621679180114"><span class="hs-identifier">innerLiteral</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">patternLiteral</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">patternLit</span><span>
</span><a name="line-367"></a><span>
</span><a name="line-368"></a><span class="hs-identifier">traversePatternField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">PatternField</span><span>
</span><a name="line-369"></a><a name="traversePatternField"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePatternField"><span class="hs-identifier">traversePatternField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkPatternField"><span class="hs-identifier hs-var">chkPatternField</span></a><span>
</span><a name="line-370"></a><span>                       </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fieldPatternName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-371"></a><span>                       </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fieldPattern</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePattern"><span class="hs-identifier hs-var">traversePattern</span></a><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>
</span><a name="line-373"></a><span class="hs-comment">-- TODO: TemplateHaskell?</span><span>
</span><a name="line-374"></a><span class="hs-identifier">traverseExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Expr</span><span>
</span><a name="line-375"></a><a name="traverseExpr"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier">traverseExpr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkExpr"><span class="hs-identifier hs-var">chkExpr</span></a><span>
</span><a name="line-376"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180115"><span class="hs-identifier hs-var">innerExpressions</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-377"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180116"><span class="hs-identifier hs-var">innerPatterns</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePattern"><span class="hs-identifier hs-var">traversePattern</span></a><span class="hs-special">)</span><span>
</span><a name="line-378"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprFunBind</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseLocalBind"><span class="hs-identifier hs-var">traverseLocalBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-379"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprIfAlts</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseGuardedCaseRhs"><span class="hs-identifier hs-var">traverseGuardedCaseRhs</span></a><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprAlts</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseAlt"><span class="hs-identifier hs-var">traverseAlt</span></a><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-381"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprOperator</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOperator"><span class="hs-identifier hs-var">traverseOperator</span></a><span class="hs-special">)</span><span>
</span><a name="line-382"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprLit</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseLiteral"><span class="hs-identifier hs-var">traverseLiteral</span></a><span class="hs-special">)</span><span>
</span><a name="line-383"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180117"><span class="hs-identifier hs-var">innerNames</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-384"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprStmts</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseStmt"><span class="hs-identifier hs-var">traverseStmt</span></a><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-385"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tupleSectionElems</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTupSecElem"><span class="hs-identifier hs-var">traverseTupSecElem</span></a><span class="hs-special">)</span><span>
</span><a name="line-386"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprRecFields</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFieldUpdate"><span class="hs-identifier hs-var">traverseFieldUpdate</span></a><span class="hs-special">)</span><span>
</span><a name="line-387"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compBody</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseListCompBody"><span class="hs-identifier hs-var">traverseListCompBody</span></a><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180118"><span class="hs-identifier hs-var">innerTypes</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-389"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprSplice</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseSplice"><span class="hs-identifier hs-var">traverseSplice</span></a><span class="hs-special">)</span><span>
</span><a name="line-390"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprBracket</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseBracket"><span class="hs-identifier hs-var">traverseBracket</span></a><span class="hs-special">)</span><span>
</span><a name="line-391"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprQQ</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseQuasiQuote"><span class="hs-identifier hs-var">traverseQuasiQuote</span></a><span class="hs-special">)</span><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180115"><a href="#local-6989586621679180115"><span class="hs-identifier">innerExpressions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tupleElems</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-394"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">listElems</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-395"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">innerExpr</span><span>
</span><a name="line-396"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">exprCond</span><span>
</span><a name="line-397"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">exprThen</span><span>
</span><a name="line-398"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">exprElse</span><span>
</span><a name="line-399"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">exprRhs</span><span>
</span><a name="line-400"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">exprLhs</span><span>
</span><a name="line-401"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">exprInner</span><span>
</span><a name="line-402"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">exprFun</span><span>
</span><a name="line-403"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">exprCase</span><span>
</span><a name="line-404"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">exprArg</span><span>
</span><a name="line-405"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">enumToFix</span><span>
</span><a name="line-406"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">enumTo</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span class="hs-special">)</span><span>
</span><a name="line-407"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">enumThen</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span class="hs-special">)</span><span>
</span><a name="line-408"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">Refact</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">enumFrom</span><span>
</span><a name="line-409"></a><span>                         </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">compExpr</span><span>
</span><a name="line-410"></a><span>
</span><a name="line-411"></a><span>       </span><a name="local-6989586621679180116"><a href="#local-6989586621679180116"><span class="hs-identifier">innerPatterns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprBindings</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">procPattern</span><span>
</span><a name="line-412"></a><span>       </span><a name="local-6989586621679180117"><a href="#local-6989586621679180117"><span class="hs-identifier">innerNames</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">exprName</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">exprRecName</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">quotedName</span><span>
</span><a name="line-413"></a><span>       </span><a name="local-6989586621679180118"><a href="#local-6989586621679180118"><span class="hs-identifier">innerTypes</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">exprSig</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">exprType</span><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-comment">-- These types are needed to generalize AST traversal for polymorphic nodes.</span><span>
</span><a name="line-416"></a><span class="hs-comment">-- These nodes are polymorphic in their inner nodes, which can be any &quot;UNodes&quot;</span><span>
</span><a name="line-417"></a><span class="hs-comment">-- (UType. UExpr, UDecl etc ...)</span><span>
</span><a name="line-418"></a><span class="hs-keyword">type</span><span> </span><a name="AltG"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#AltG"><span class="hs-identifier">AltG</span></a></a><span> </span><a name="local-6989586621679180090"><a href="#local-6989586621679180090"><span class="hs-identifier">uexpr</span></a></a><span> </span><a name="local-6989586621679180091"><a href="#local-6989586621679180091"><span class="hs-identifier">dom</span></a></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Ann</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">UAlt'</span><span> </span><a href="#local-6989586621679180090"><span class="hs-identifier hs-type">uexpr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679180091"><span class="hs-identifier hs-type">dom</span></a><span> </span><span class="hs-identifier hs-type">SrcTemplateStage</span><span>
</span><a name="line-419"></a><span class="hs-keyword">type</span><span> </span><a name="StmtG"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#StmtG"><span class="hs-identifier">StmtG</span></a></a><span> </span><a name="local-6989586621679180088"><a href="#local-6989586621679180088"><span class="hs-identifier">uexpr</span></a></a><span> </span><a name="local-6989586621679180089"><a href="#local-6989586621679180089"><span class="hs-identifier">dom</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Ann</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">UStmt'</span><span> </span><a href="#local-6989586621679180088"><span class="hs-identifier hs-type">uexpr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679180089"><span class="hs-identifier hs-type">dom</span></a><span> </span><span class="hs-identifier hs-type">SrcTemplateStage</span><span>
</span><a name="line-420"></a><span class="hs-keyword">type</span><span> </span><a name="CaseRhsG"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#CaseRhsG"><span class="hs-identifier">CaseRhsG</span></a></a><span> </span><a name="local-6989586621679180086"><a href="#local-6989586621679180086"><span class="hs-identifier">uexpr</span></a></a><span> </span><a name="local-6989586621679180087"><a href="#local-6989586621679180087"><span class="hs-identifier">dom</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Ann</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">UCaseRhs'</span><span> </span><a href="#local-6989586621679180086"><span class="hs-identifier hs-type">uexpr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679180087"><span class="hs-identifier hs-type">dom</span></a><span> </span><span class="hs-identifier hs-type">SrcTemplateStage</span><span>
</span><a name="line-421"></a><span class="hs-keyword">type</span><span> </span><a name="GuardedCaseRhsG"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#GuardedCaseRhsG"><span class="hs-identifier">GuardedCaseRhsG</span></a></a><span> </span><a name="local-6989586621679180084"><a href="#local-6989586621679180084"><span class="hs-identifier">uexpr</span></a></a><span> </span><a name="local-6989586621679180085"><a href="#local-6989586621679180085"><span class="hs-identifier">dom</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Ann</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">UGuardedCaseRhs'</span><span> </span><a href="#local-6989586621679180084"><span class="hs-identifier hs-type">uexpr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679180085"><span class="hs-identifier hs-type">dom</span></a><span> </span><span class="hs-identifier hs-type">SrcTemplateStage</span><span>
</span><a name="line-422"></a><span>
</span><a name="line-423"></a><span class="hs-keyword">type</span><span> </span><a name="PromotedG"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#PromotedG"><span class="hs-identifier">PromotedG</span></a></a><span> </span><a name="local-6989586621679180082"><a href="#local-6989586621679180082"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679180083"><a href="#local-6989586621679180083"><span class="hs-identifier">dom</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Ann</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">UPromoted</span><span> </span><a href="#local-6989586621679180082"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679180083"><span class="hs-identifier hs-type">dom</span></a><span>  </span><span class="hs-identifier hs-type">SrcTemplateStage</span><span>
</span><a name="line-424"></a><span>
</span><a name="line-425"></a><span class="hs-identifier">traverseAlt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckUNode"><span class="hs-identifier hs-type">CheckUNode</span></a><span> </span><a href="#local-6989586621679180096"><span class="hs-identifier hs-type">uexpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#AltG"><span class="hs-identifier hs-type">AltG</span></a><span> </span><a href="#local-6989586621679180096"><span class="hs-identifier hs-type">uexpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-426"></a><a name="traverseAlt"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseAlt"><span class="hs-identifier">traverseAlt</span></a></a><span> </span><a name="local-6989586621679180119"><a href="#local-6989586621679180119"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">altPattern</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePattern"><span class="hs-identifier hs-var">traversePattern</span></a><span class="hs-special">)</span><span>
</span><a name="line-427"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">altRhs</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseCaseRhs"><span class="hs-identifier hs-var">traverseCaseRhs</span></a><span> </span><a href="#local-6989586621679180119"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-428"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">altBinds</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseLocalBinds"><span class="hs-identifier hs-var">traverseLocalBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-429"></a><span>
</span><a name="line-430"></a><span class="hs-identifier">traverseCaseRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckUNode"><span class="hs-identifier hs-type">CheckUNode</span></a><span> </span><a href="#local-6989586621679180095"><span class="hs-identifier hs-type">uexpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#CaseRhsG"><span class="hs-identifier hs-type">CaseRhsG</span></a><span> </span><a href="#local-6989586621679180095"><span class="hs-identifier hs-type">uexpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-431"></a><a name="traverseCaseRhs"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseCaseRhs"><span class="hs-identifier">traverseCaseRhs</span></a></a><span> </span><a name="local-6989586621679180120"><a href="#local-6989586621679180120"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">rhsCaseExpr</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="#local-6989586621679180120"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-432"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">rhsCaseGuards</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseGuardedCaseRhs"><span class="hs-identifier hs-var">traverseGuardedCaseRhs</span></a><span> </span><a href="#local-6989586621679180120"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-433"></a><span>
</span><a name="line-434"></a><span class="hs-identifier">traverseGuardedCaseRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckUNode"><span class="hs-identifier hs-type">CheckUNode</span></a><span> </span><a href="#local-6989586621679180094"><span class="hs-identifier hs-type">uexpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#GuardedCaseRhsG"><span class="hs-identifier hs-type">GuardedCaseRhsG</span></a><span> </span><a href="#local-6989586621679180094"><span class="hs-identifier hs-type">uexpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-435"></a><a name="traverseGuardedCaseRhs"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseGuardedCaseRhs"><span class="hs-identifier">traverseGuardedCaseRhs</span></a></a><span> </span><a name="local-6989586621679180121"><a href="#local-6989586621679180121"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">caseGuardStmts</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseRhsGuard"><span class="hs-identifier hs-var">traverseRhsGuard</span></a><span class="hs-special">)</span><span>
</span><a name="line-436"></a><span>                          </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">caseGuardExpr</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="#local-6989586621679180121"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span class="hs-identifier">traverseStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckUNode"><span class="hs-identifier hs-type">CheckUNode</span></a><span> </span><a href="#local-6989586621679180093"><span class="hs-identifier hs-type">uexpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#StmtG"><span class="hs-identifier hs-type">StmtG</span></a><span> </span><a href="#local-6989586621679180093"><span class="hs-identifier hs-type">uexpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-439"></a><a name="traverseStmt"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseStmt"><span class="hs-identifier">traverseStmt</span></a></a><span> </span><a name="local-6989586621679180122"><a href="#local-6989586621679180122"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stmtPattern</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePattern"><span class="hs-identifier hs-var">traversePattern</span></a><span class="hs-special">)</span><span>
</span><a name="line-440"></a><span>                </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stmtExpr</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="#local-6989586621679180122"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-441"></a><span>                </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stmtBinds</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseLocalBind"><span class="hs-identifier hs-var">traverseLocalBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span>                </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cmdStmtBinds</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseStmt"><span class="hs-identifier hs-var">traverseStmt</span></a><span> </span><a href="#local-6989586621679180122"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span class="hs-identifier">traversePromoted</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckUNode"><span class="hs-identifier hs-type">CheckUNode</span></a><span> </span><a href="#local-6989586621679180092"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#PromotedG"><span class="hs-identifier hs-type">PromotedG</span></a><span> </span><a href="#local-6989586621679180092"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-445"></a><a name="traversePromoted"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePromoted"><span class="hs-identifier">traversePromoted</span></a></a><span> </span><a name="local-6989586621679180123"><a href="#local-6989586621679180123"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">promotedConName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-446"></a><span>                 </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">promotedElements</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="#local-6989586621679180123"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-447"></a><span>
</span><a name="line-448"></a><span class="hs-identifier">traverseTupSecElem</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">TupSecElem</span><span>
</span><a name="line-449"></a><a name="traverseTupSecElem"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTupSecElem"><span class="hs-identifier">traverseTupSecElem</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tupSecExpr</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-identifier">traverseFieldUpdate</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">FieldUpdate</span><span>
</span><a name="line-452"></a><a name="traverseFieldUpdate"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFieldUpdate"><span class="hs-identifier">traverseFieldUpdate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkFieldUpdate"><span class="hs-identifier hs-var">chkFieldUpdate</span></a><span>
</span><a name="line-453"></a><span>                      </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fieldName</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">fieldUpdateName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-454"></a><span>                      </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fieldValue</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-455"></a><span>
</span><a name="line-456"></a><span class="hs-identifier">traverseListCompBody</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">ListCompBody</span><span>
</span><a name="line-457"></a><a name="traverseListCompBody"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseListCompBody"><span class="hs-identifier">traverseListCompBody</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compStmts</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseCompStmt"><span class="hs-identifier hs-var">traverseCompStmt</span></a><span>
</span><a name="line-458"></a><span>
</span><a name="line-459"></a><span class="hs-identifier">traverseCompStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">CompStmt</span><span>
</span><a name="line-460"></a><a name="traverseCompStmt"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseCompStmt"><span class="hs-identifier">traverseCompStmt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compStmt</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseStmt"><span class="hs-identifier hs-var">traverseStmt</span></a><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-461"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180124"><span class="hs-identifier hs-var">innerExpressions</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-462"></a><span>
</span><a name="line-463"></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180124"><a href="#local-6989586621679180124"><span class="hs-identifier">innerExpressions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">thenExpr</span><span>
</span><a name="line-464"></a><span>                          </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">byExpr</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span class="hs-special">)</span><span>
</span><a name="line-465"></a><span>                          </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">usingExpr</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span class="hs-special">)</span><span>
</span><a name="line-466"></a><span>
</span><a name="line-467"></a><span class="hs-identifier">traverseCmd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Cmd</span><span>
</span><a name="line-468"></a><a name="traverseCmd"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseCmd"><span class="hs-identifier">traverseCmd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-469"></a><span class="hs-comment">{-

References are not generated for UCmd

traverseCmd = (innerExpressions !~ traverseExpr)
             &gt;=&gt; (innerCmds !~ traverseCmd)
             &gt;=&gt; (cmdStmtBinds &amp; annList !~ traversePattern)
             &gt;=&gt; (cmdBinds &amp; annList !~ traverseLocalBind)
             &gt;=&gt; (cmdAlts &amp; annList !~ traverseAlt traverseCmd)
             &gt;=&gt; (cmdStmts &amp; annList !~ traverseStmt traverseCmd)
 where innerExpressions = cmdLhs &amp;+&amp; cmdRhs &amp;+&amp; cmdExpr &amp;+&amp; cmdApplied

       innerCmds = (cmdInnerCmds &amp; annList)
                   &amp;+&amp; cmdInnerCmd
                   &amp;+&amp; cmdLeftCmd
                   &amp;+&amp; cmdRightCmd
                   &amp;+&amp; cmdInner
                   &amp;+&amp; cmdThen
                   &amp;+&amp; cmdElse
-}</span><span>
</span><a name="line-489"></a><span>
</span><a name="line-490"></a><span class="hs-identifier">traverseSplice</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Splice</span><span>
</span><a name="line-491"></a><a name="traverseSplice"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseSplice"><span class="hs-identifier">traverseSplice</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.TemplateHaskellChecker.html#chkTemplateHaskellSplice"><span class="hs-identifier hs-var">chkTemplateHaskellSplice</span></a><span>
</span><a name="line-492"></a><span>                 </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">spliceId</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-493"></a><span>                 </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">spliceExpr</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-494"></a><span>
</span><a name="line-495"></a><span class="hs-identifier">traverseBracket</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Bracket</span><span>
</span><a name="line-496"></a><a name="traverseBracket"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseBracket"><span class="hs-identifier">traverseBracket</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.TemplateHaskellChecker.html#chkTemplateHaskellBracket"><span class="hs-identifier hs-var">chkTemplateHaskellBracket</span></a><span>
</span><a name="line-497"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bracketExpr</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseExpr"><span class="hs-identifier hs-var">traverseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bracketPattern</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePattern"><span class="hs-identifier hs-var">traversePattern</span></a><span class="hs-special">)</span><span>
</span><a name="line-499"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bracketType</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-500"></a><span>                  </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bracketDecl</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseDecl"><span class="hs-identifier hs-var">traverseDecl</span></a><span class="hs-special">)</span><span>
</span><a name="line-501"></a><span>
</span><a name="line-502"></a><span class="hs-identifier">traverseQuasiQuote</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">QuasiQuote</span><span>
</span><a name="line-503"></a><a name="traverseQuasiQuote"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseQuasiQuote"><span class="hs-identifier">traverseQuasiQuote</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.TemplateHaskellChecker.html#chkTemplateHaskellQuasiQuote"><span class="hs-identifier hs-var">chkTemplateHaskellQuasiQuote</span></a><span>
</span><a name="line-504"></a><span>                     </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">qqExprName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-505"></a><span>
</span><a name="line-506"></a><span class="hs-identifier">traverseType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-507"></a><a name="traverseType"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier">traverseType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkType"><span class="hs-identifier hs-var">chkType</span></a><span>
</span><a name="line-508"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeBounded</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTyVar"><span class="hs-identifier hs-var">traverseTyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-509"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180125"><span class="hs-identifier hs-var">innerType</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-510"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180126"><span class="hs-identifier hs-var">innerName</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-511"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeCtx</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseContext"><span class="hs-identifier hs-var">traverseContext</span></a><span class="hs-special">)</span><span>
</span><a name="line-512"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeOperator</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOperator"><span class="hs-identifier hs-var">traverseOperator</span></a><span class="hs-special">)</span><span>
</span><a name="line-513"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeKind</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseKind"><span class="hs-identifier hs-var">traverseKind</span></a><span class="hs-special">)</span><span>
</span><a name="line-514"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tpPromoted</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePromoted"><span class="hs-identifier hs-var">traversePromoted</span></a><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-515"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tsSplice</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseSplice"><span class="hs-identifier hs-var">traverseSplice</span></a><span class="hs-special">)</span><span>
</span><a name="line-516"></a><span>              </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeQQ</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseQuasiQuote"><span class="hs-identifier hs-var">traverseQuasiQuote</span></a><span class="hs-special">)</span><span>
</span><a name="line-517"></a><span>
</span><a name="line-518"></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180125"><a href="#local-6989586621679180125"><span class="hs-identifier">innerType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeType</span><span>
</span><a name="line-519"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">typeParam</span><span>
</span><a name="line-520"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">typeResult</span><span>
</span><a name="line-521"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeElements</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-522"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">typeElement</span><span>
</span><a name="line-523"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">typeCon</span><span>
</span><a name="line-524"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">typeArg</span><span>
</span><a name="line-525"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">typeInner</span><span>
</span><a name="line-526"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">typeLeft</span><span>
</span><a name="line-527"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">typeRight</span><span>
</span><a name="line-528"></a><span>
</span><a name="line-529"></a><span>       </span><a name="local-6989586621679180126"><a href="#local-6989586621679180126"><span class="hs-identifier">innerName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeName</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">typeWildcardName</span><span>
</span><a name="line-530"></a><span>
</span><a name="line-531"></a><span class="hs-identifier">traverseTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">TyVar</span><span>
</span><a name="line-532"></a><a name="traverseTyVar"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTyVar"><span class="hs-identifier">traverseTyVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tyVarName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-533"></a><span>               </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tyVarKind</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annJust</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseKindContraint"><span class="hs-identifier hs-var">traverseKindContraint</span></a><span class="hs-special">)</span><span>
</span><a name="line-534"></a><span>
</span><a name="line-535"></a><span class="hs-identifier">traverseKindContraint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">KindConstraint</span><span>
</span><a name="line-536"></a><a name="traverseKindContraint"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseKindContraint"><span class="hs-identifier">traverseKindContraint</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">kindConstr</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseKind"><span class="hs-identifier hs-var">traverseKind</span></a><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span class="hs-identifier">traverseKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Kind</span><span>
</span><a name="line-539"></a><a name="traverseKind"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseKind"><span class="hs-identifier">traverseKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkKind"><span class="hs-identifier hs-var">chkKind</span></a><span>
</span><a name="line-540"></a><span>           </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180127"><span class="hs-identifier hs-var">innerKind</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseKind"><span class="hs-identifier hs-var">traverseKind</span></a><span class="hs-special">)</span><span>
</span><a name="line-541"></a><span>           </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">kindVar</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-542"></a><span>           </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">kindAppOp</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOperator"><span class="hs-identifier hs-var">traverseOperator</span></a><span class="hs-special">)</span><span>
</span><a name="line-543"></a><span>           </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">kindPromoted</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traversePromoted"><span class="hs-identifier hs-var">traversePromoted</span></a><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseKind"><span class="hs-identifier hs-var">traverseKind</span></a><span class="hs-special">)</span><span>
</span><a name="line-544"></a><span>
</span><a name="line-545"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180127"><a href="#local-6989586621679180127"><span class="hs-identifier">innerKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">kindLeft</span><span>
</span><a name="line-546"></a><span>                </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">kindRight</span><span>
</span><a name="line-547"></a><span>                </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">kindParen</span><span>
</span><a name="line-548"></a><span>                </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">kindAppFun</span><span>
</span><a name="line-549"></a><span>                </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">kindAppArg</span><span>
</span><a name="line-550"></a><span>                </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">kindLhs</span><span>
</span><a name="line-551"></a><span>                </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">kindRhs</span><span>
</span><a name="line-552"></a><span>                </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">kindElem</span><span>
</span><a name="line-553"></a><span>                </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">kindElems</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-554"></a><span>
</span><a name="line-555"></a><span class="hs-identifier">traverseContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Context</span><span>
</span><a name="line-556"></a><a name="traverseContext"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseContext"><span class="hs-identifier">traverseContext</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">contextAssertion</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseAssertion"><span class="hs-identifier hs-var">traverseAssertion</span></a><span>
</span><a name="line-557"></a><span>
</span><a name="line-558"></a><span class="hs-identifier">traverseAssertion</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Assertion</span><span>
</span><a name="line-559"></a><a name="traverseAssertion"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseAssertion"><span class="hs-identifier">traverseAssertion</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180128"><span class="hs-identifier hs-var">innerType</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-560"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679180129"><span class="hs-identifier hs-var">innerName</span></a><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">assertOp</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOperator"><span class="hs-identifier hs-var">traverseOperator</span></a><span class="hs-special">)</span><span>
</span><a name="line-562"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">innerAsserts</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseAssertion"><span class="hs-identifier hs-var">traverseAssertion</span></a><span class="hs-special">)</span><span>
</span><a name="line-563"></a><span>
</span><a name="line-564"></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679180128"><a href="#local-6989586621679180128"><span class="hs-identifier">innerType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">assertTypes</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span class="hs-special">)</span><span>
</span><a name="line-565"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">assertLhs</span><span>
</span><a name="line-566"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">assertRhs</span><span>
</span><a name="line-567"></a><span>                   </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">assertImplType</span><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span>       </span><a name="local-6989586621679180129"><a href="#local-6989586621679180129"><span class="hs-identifier">innerName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">assertClsName</span><span> </span><span class="hs-operator hs-var">&amp;+&amp;</span><span> </span><span class="hs-identifier hs-var">assertImplVar</span><span>
</span><a name="line-570"></a><span>
</span><a name="line-571"></a><span class="hs-identifier">traverseName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-572"></a><a name="traverseName"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier">traverseName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">simpleName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseQualifiedName"><span class="hs-identifier hs-var">traverseQualifiedName</span></a><span>
</span><a name="line-573"></a><span>
</span><a name="line-574"></a><span class="hs-identifier">traverseQualifiedName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">QualifiedName</span><span>
</span><a name="line-575"></a><a name="traverseQualifiedName"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseQualifiedName"><span class="hs-identifier">traverseQualifiedName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unqualifiedName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseNamePart"><span class="hs-identifier hs-var">traverseNamePart</span></a><span>
</span><a name="line-576"></a><span>                   </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-identifier hs-var">qualifiers</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseNamePart"><span class="hs-identifier hs-var">traverseNamePart</span></a><span>
</span><a name="line-577"></a><span>
</span><a name="line-578"></a><span class="hs-identifier">traverseNamePart</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">NamePart</span><span>
</span><a name="line-579"></a><a name="traverseNamePart"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseNamePart"><span class="hs-identifier">traverseNamePart</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkNamePart"><span class="hs-identifier hs-var">chkNamePart</span></a><span>
</span><a name="line-580"></a><span>
</span><a name="line-581"></a><span class="hs-identifier">traverseLiteral</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Literal</span><span>
</span><a name="line-582"></a><a name="traverseLiteral"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseLiteral"><span class="hs-identifier">traverseLiteral</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#chkLiteral"><span class="hs-identifier hs-var">chkLiteral</span></a><span>
</span><a name="line-583"></a><span>
</span><a name="line-584"></a><span class="hs-identifier">traverseOperator</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Operator</span><span>
</span><a name="line-585"></a><a name="traverseOperator"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOperator"><span class="hs-identifier">traverseOperator</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">operatorName</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseQualifiedName"><span class="hs-identifier hs-var">traverseQualifiedName</span></a><span>
</span><a name="line-586"></a><span>
</span><a name="line-587"></a><span class="hs-identifier">traverseTypeSignature</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">TypeSignature</span><span>
</span><a name="line-588"></a><a name="traverseTypeSignature"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseTypeSignature"><span class="hs-identifier">traverseTypeSignature</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tsName</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseName"><span class="hs-identifier hs-var">traverseName</span></a><span class="hs-special">)</span><span>
</span><a name="line-589"></a><span>                    </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tsType</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseType"><span class="hs-identifier hs-var">traverseType</span></a><span class="hs-special">)</span><span>
</span><a name="line-590"></a><span>
</span><a name="line-591"></a><span class="hs-identifier">traverseFixitySignature</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">FixitySignature</span><span>
</span><a name="line-592"></a><a name="traverseFixitySignature"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseFixitySignature"><span class="hs-identifier">traverseFixitySignature</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fixityOperators</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">annList</span><span> </span><span class="hs-operator hs-var">!~</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST.html#traverseOperator"><span class="hs-identifier hs-var">traverseOperator</span></a><span>
</span><a name="line-593"></a></pre></body></html>