<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts, TypeFamilies #-}</span><span>
</span><a name="line-2"></a><span>             </span><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Refactor</span><span class="hs-operator">.</span><span class="hs-identifier">Builtin</span><span class="hs-operator">.</span><span class="hs-identifier">ExtensionOrganizer</span><span class="hs-operator">.</span><span class="hs-identifier">Checkers</span><span class="hs-operator">.</span><span class="hs-identifier">MagicHashChecker</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Refactor</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html"><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Refactor</span><span class="hs-operator">.</span><span class="hs-identifier">Builtin</span><span class="hs-operator">.</span><span class="hs-identifier">ExtensionOrganizer</span><span class="hs-operator">.</span><span class="hs-identifier">ExtMonad</span></a><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# ANN module &quot;HLint: ignore Redundant bracket&quot; #-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-identifier">chkMagicHashLiteral</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Literal</span><span>
</span><a name="line-11"></a><a name="chkMagicHashLiteral"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.MagicHashChecker.html#chkMagicHashLiteral"><span class="hs-identifier">chkMagicHashLiteral</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#conditional"><span class="hs-identifier hs-var">conditional</span></a><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.MagicHashChecker.html#chkMagicHashLiteral%27"><span class="hs-identifier hs-var">chkMagicHashLiteral'</span></a><span> </span><span class="hs-identifier hs-var">MagicHash</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-identifier">chkMagicHashNamePart</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">NamePart</span><span>
</span><a name="line-14"></a><a name="chkMagicHashNamePart"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.MagicHashChecker.html#chkMagicHashNamePart"><span class="hs-identifier">chkMagicHashNamePart</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#conditional"><span class="hs-identifier hs-var">conditional</span></a><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.MagicHashChecker.html#chkMagicHashNamePart%27"><span class="hs-identifier hs-var">chkMagicHashNamePart'</span></a><span> </span><span class="hs-identifier hs-var">MagicHash</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-identifier">chkMagicHashKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Kind</span><span>
</span><a name="line-17"></a><a name="chkMagicHashKind"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.MagicHashChecker.html#chkMagicHashKind"><span class="hs-identifier">chkMagicHashKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#conditional"><span class="hs-identifier hs-var">conditional</span></a><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.MagicHashChecker.html#chkMagicHashKind%27"><span class="hs-identifier hs-var">chkMagicHashKind'</span></a><span> </span><span class="hs-identifier hs-var">MagicHash</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-identifier">chkMagicHashLiteral'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Literal</span><span>
</span><a name="line-23"></a><a name="chkMagicHashLiteral%27"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.MagicHashChecker.html#chkMagicHashLiteral%27"><span class="hs-identifier">chkMagicHashLiteral'</span></a></a><span> </span><a name="local-6989586621679116428"><a href="#local-6989586621679116428"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrimIntLit</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#addOccurence"><span class="hs-identifier hs-var">addOccurence</span></a><span> </span><span class="hs-identifier hs-var">MagicHash</span><span> </span><a href="#local-6989586621679116428"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-24"></a><span class="hs-identifier">chkMagicHashLiteral'</span><span> </span><a name="local-6989586621679116469"><a href="#local-6989586621679116469"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrimWordLit</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#addOccurence"><span class="hs-identifier hs-var">addOccurence</span></a><span> </span><span class="hs-identifier hs-var">MagicHash</span><span> </span><a href="#local-6989586621679116469"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-25"></a><span class="hs-identifier">chkMagicHashLiteral'</span><span> </span><a name="local-6989586621679116470"><a href="#local-6989586621679116470"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrimFloatLit</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#addOccurence"><span class="hs-identifier hs-var">addOccurence</span></a><span> </span><span class="hs-identifier hs-var">MagicHash</span><span> </span><a href="#local-6989586621679116470"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-26"></a><span class="hs-identifier">chkMagicHashLiteral'</span><span> </span><a name="local-6989586621679116471"><a href="#local-6989586621679116471"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrimDoubleLit</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#addOccurence"><span class="hs-identifier hs-var">addOccurence</span></a><span> </span><span class="hs-identifier hs-var">MagicHash</span><span> </span><a href="#local-6989586621679116471"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-27"></a><span class="hs-identifier">chkMagicHashLiteral'</span><span> </span><a name="local-6989586621679116472"><a href="#local-6989586621679116472"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrimCharLit</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#addOccurence"><span class="hs-identifier hs-var">addOccurence</span></a><span> </span><span class="hs-identifier hs-var">MagicHash</span><span> </span><a href="#local-6989586621679116472"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-28"></a><span class="hs-identifier">chkMagicHashLiteral'</span><span> </span><a name="local-6989586621679116473"><a href="#local-6989586621679116473"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrimStringLit</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#addOccurence"><span class="hs-identifier hs-var">addOccurence</span></a><span> </span><span class="hs-identifier hs-var">MagicHash</span><span> </span><a href="#local-6989586621679116473"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-29"></a><span class="hs-identifier">chkMagicHashLiteral'</span><span> </span><a name="local-6989586621679116474"><a href="#local-6989586621679116474"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679116474"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-identifier">chkMagicHashNamePart'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">NamePart</span><span>
</span><a name="line-33"></a><a name="chkMagicHashNamePart%27"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.MagicHashChecker.html#chkMagicHashNamePart%27"><span class="hs-identifier">chkMagicHashNamePart'</span></a></a><span> </span><a name="local-6989586621679116475"><a href="#local-6989586621679116475"><span class="hs-identifier">n</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">NamePart</span><span> </span><a name="local-6989586621679116476"><a href="#local-6989586621679116476"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-34"></a><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679116476"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'#'</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#addOccurence"><span class="hs-identifier hs-var">addOccurence</span></a><span> </span><span class="hs-identifier hs-var">MagicHash</span><span> </span><a href="#local-6989586621679116475"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-35"></a><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679116475"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-- NOTE: is this really needed?</span><span>
</span><a name="line-38"></a><span class="hs-identifier">chkMagicHashKind'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#CheckNode"><span class="hs-identifier hs-type">CheckNode</span></a><span> </span><span class="hs-identifier hs-type">Kind</span><span>
</span><a name="line-39"></a><a name="chkMagicHashKind%27"><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers.MagicHashChecker.html#chkMagicHashKind%27"><span class="hs-identifier">chkMagicHashKind'</span></a></a><span> </span><a name="local-6989586621679116477"><a href="#local-6989586621679116477"><span class="hs-identifier">k</span></a></a><span class="hs-glyph">@</span><span class="hs-identifier hs-var">UnboxKind</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad.html#addOccurence"><span class="hs-identifier hs-var">addOccurence</span></a><span> </span><span class="hs-identifier hs-var">MagicHash</span><span> </span><a href="#local-6989586621679116477"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-40"></a><span class="hs-identifier">chkMagicHashKind'</span><span> </span><a name="local-6989586621679116542"><a href="#local-6989586621679116542"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679116542"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">{- Name can be reached from:
  UIESpec
  USubSpec
  UInjectivityAnn
  URuleVar
  UTopLevelPragma
  UAnnotationSubject
  UMinimalFormula

  UDecl  DONE
  UClassElement DONE
  UDeclHead DONE
  UGadtConDecl DONE
  UPatSynLhs  DONE
  UPatternTypeSignature DONE
  UFunDep DONE
  UConDecl DONE
  UFieldDecl DONE
  UInstanceHead DONE
  UTypeSignature DONE
  UMatchLhs DONE
  UTyVar DONE
  UType DONE
  UKind DONE
  UAssertion DONE
  UExpr DONE
  UFieldUpdate DONE
  UPattern DONE
  UPatternField DONE
  USplice
  UQuasiQuote

  UPromoted t
-}</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">{- QualifiedName can be reached from:
  UDecl DONE
  UOperator DONE
  UName (obviously) DONE
-}</span><span>
</span><a name="line-82"></a></pre></body></html>