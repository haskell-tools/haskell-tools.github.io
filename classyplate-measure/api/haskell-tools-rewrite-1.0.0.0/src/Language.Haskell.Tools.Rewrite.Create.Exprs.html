<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Generation of expression-level AST fragments for refactorings.</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- The bindings defined here create a the annotated version of the AST constructor with the same name.</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- For example, @mkApp@ creates the annotated version of the @App@ AST constructor.</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings, TypeFamilies #-}</span><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Rewrite</span><span class="hs-operator">.</span><span class="hs-identifier">Create</span><span class="hs-operator">.</span><span class="hs-identifier">Exprs</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">AST</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">PrettyPrint</span><span class="hs-operator">.</span><span class="hs-identifier">Prepare</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html"><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Rewrite</span><span class="hs-operator">.</span><span class="hs-identifier">Create</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span class="hs-special">,</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnMaybe"><span class="hs-identifier hs-var">mkAnnMaybe</span></a><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html"><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">Tools</span><span class="hs-operator">.</span><span class="hs-identifier">Rewrite</span><span class="hs-operator">.</span><span class="hs-identifier">ElementTypes</span></a><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-comment">-- * Expressions</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-comment">-- | Create a expression for a variable or a data constructor (@ a @)</span><span>
</span><a name="line-15"></a><span class="hs-identifier">mkVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-16"></a><a name="mkVar"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkVar"><span class="hs-identifier">mkVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UVar</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-comment">-- | Create a literal expression (@ 42 @)</span><span>
</span><a name="line-19"></a><span class="hs-identifier">mkLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-20"></a><a name="mkLit"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkLit"><span class="hs-identifier">mkLit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">ULit</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-comment">-- | Create a infix operator application expression (@ a + b @)</span><span>
</span><a name="line-23"></a><span class="hs-identifier">mkInfixApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Operator"><span class="hs-identifier hs-type">Operator</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-24"></a><a name="mkInfixApp"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkInfixApp"><span class="hs-identifier">mkInfixApp</span></a></a><span> </span><a name="local-6989586621679100477"><a href="#local-6989586621679100477"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679100478"><a href="#local-6989586621679100478"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679100479"><a href="#local-6989586621679100479"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UInfixApp</span><span> </span><a href="#local-6989586621679100477"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621679100478"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679100479"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-comment">-- | Create a prefix operator application expression (@ -x @)</span><span>
</span><a name="line-27"></a><span class="hs-identifier">mkPrefixApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Operator"><span class="hs-identifier hs-type">Operator</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-28"></a><a name="mkPrefixApp"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkPrefixApp"><span class="hs-identifier">mkPrefixApp</span></a></a><span> </span><a name="local-6989586621679100480"><a href="#local-6989586621679100480"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679100481"><a href="#local-6989586621679100481"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UPrefixApp</span><span> </span><a href="#local-6989586621679100480"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679100481"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-comment">-- | Create a function application expression (@ f 4 @)</span><span>
</span><a name="line-31"></a><span class="hs-identifier">mkApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-32"></a><a name="mkApp"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkApp"><span class="hs-identifier">mkApp</span></a></a><span> </span><a name="local-6989586621679100482"><a href="#local-6989586621679100482"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679100483"><a href="#local-6989586621679100483"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UApp</span><span> </span><a href="#local-6989586621679100482"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679100483"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">-- | Create a lambda expression (@ \\a b -&gt; a + b @)</span><span>
</span><a name="line-35"></a><span class="hs-identifier">mkLambda</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-36"></a><a name="mkLambda"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkLambda"><span class="hs-identifier">mkLambda</span></a></a><span> </span><a name="local-6989586621679100484"><a href="#local-6989586621679100484"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679100485"><a href="#local-6989586621679100485"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;\\&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; -&gt; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ULambda</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100484"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100485"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-comment">-- | Create a local binding (@ let x = 2; y = 3 in e x y @)</span><span>
</span><a name="line-39"></a><span class="hs-identifier">mkLet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#LocalBind"><span class="hs-identifier hs-type">LocalBind</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-40"></a><a name="mkLet"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkLet"><span class="hs-identifier">mkLet</span></a></a><span> </span><a name="local-6989586621679100486"><a href="#local-6989586621679100486"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679100487"><a href="#local-6989586621679100487"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;let &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; in &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ULet</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">indented</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100486"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100487"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">-- | Create a if expression (@ if a then b else c @)</span><span>
</span><a name="line-43"></a><span class="hs-identifier">mkIf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-44"></a><a name="mkIf"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkIf"><span class="hs-identifier">mkIf</span></a></a><span> </span><a name="local-6989586621679100488"><a href="#local-6989586621679100488"><span class="hs-identifier">cond</span></a></a><span> </span><a name="local-6989586621679100489"><a href="#local-6989586621679100489"><span class="hs-identifier">then_</span></a></a><span> </span><a name="local-6989586621679100490"><a href="#local-6989586621679100490"><span class="hs-identifier">else_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;if &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; then &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; else &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UIf</span><span> </span><a href="#local-6989586621679100488"><span class="hs-identifier hs-var">cond</span></a><span> </span><a href="#local-6989586621679100489"><span class="hs-identifier hs-var">then_</span></a><span> </span><a href="#local-6989586621679100490"><span class="hs-identifier hs-var">else_</span></a><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">-- | Create a multi way if expressions with @MultiWayIf@ extension (@ if | guard1 -&gt; expr1; guard2 -&gt; expr2 @)</span><span>
</span><a name="line-47"></a><span class="hs-identifier">mkMultiIf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#GuardedCaseRhs"><span class="hs-identifier hs-type">GuardedCaseRhs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-48"></a><a name="mkMultiIf"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkMultiIf"><span class="hs-identifier">mkMultiIf</span></a></a><span> </span><a name="local-6989586621679100491"><a href="#local-6989586621679100491"><span class="hs-identifier">cases</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;if&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UMultiIf</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">indented</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100491"><span class="hs-identifier hs-var">cases</span></a><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">-- | Create a pattern matching expression (@ case expr of pat1 -&gt; expr1; pat2 -&gt; expr2 @)</span><span>
</span><a name="line-51"></a><span class="hs-identifier">mkCase</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Alt"><span class="hs-identifier hs-type">Alt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-52"></a><a name="mkCase"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkCase"><span class="hs-identifier">mkCase</span></a></a><span> </span><a name="local-6989586621679100492"><a href="#local-6989586621679100492"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679100493"><a href="#local-6989586621679100493"><span class="hs-identifier">cases</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;case &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; of &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UCase</span><span> </span><a href="#local-6989586621679100492"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">indented</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100493"><span class="hs-identifier hs-var">cases</span></a><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">-- | Create a do-notation expressions (@ do x &lt;- act1; act2 @)</span><span>
</span><a name="line-55"></a><span class="hs-identifier">mkDoBlock</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-56"></a><a name="mkDoBlock"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkDoBlock"><span class="hs-identifier">mkDoBlock</span></a></a><span> </span><a name="local-6989586621679100494"><a href="#local-6989586621679100494"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UDo</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-string">&quot;do&quot;</span><span> </span><span class="hs-identifier hs-var">UDoKeyword</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">indented</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100494"><span class="hs-identifier hs-var">stmts</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-comment">-- | Create a tuple expression (@ (e1, e2, e3) @)</span><span>
</span><a name="line-59"></a><span class="hs-identifier">mkTuple</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-60"></a><a name="mkTuple"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkTuple"><span class="hs-identifier">mkTuple</span></a></a><span> </span><a name="local-6989586621679100495"><a href="#local-6989586621679100495"><span class="hs-identifier">exprs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UTuple</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100495"><span class="hs-identifier hs-var">exprs</span></a><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- | Create a unboxed tuple expression (@ (\# e1, e2, e3 \#) @)</span><span>
</span><a name="line-63"></a><span class="hs-identifier">mkUnboxedTuple</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-64"></a><a name="mkUnboxedTuple"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkUnboxedTuple"><span class="hs-identifier">mkUnboxedTuple</span></a></a><span> </span><a name="local-6989586621679100496"><a href="#local-6989586621679100496"><span class="hs-identifier">exprs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(# &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; #)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UTuple</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100496"><span class="hs-identifier hs-var">exprs</span></a><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-comment">-- | Create a tuple section, enabled with @TupleSections@ (@ (a,,b) @). One of the elements must be missing.</span><span>
</span><a name="line-67"></a><span class="hs-identifier">mkTupleSection</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-68"></a><a name="mkTupleSection"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkTupleSection"><span class="hs-identifier">mkTupleSection</span></a></a><span> </span><a name="local-6989586621679100497"><a href="#local-6989586621679100497"><span class="hs-identifier">elems</span></a></a><span> </span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679100498"><a href="#local-6989586621679100498"><span class="hs-identifier">tupSecs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">Missing</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Present</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100497"><span class="hs-identifier hs-var">elems</span></a><span>
</span><a name="line-70"></a><span>     </span><span class="hs-keyword">in</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UTupleSection</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100498"><span class="hs-identifier hs-var">tupSecs</span></a><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- | Create a unboxed tuple section, enabled with @TupleSections@ (@ (\#a,,b\#) @). One of the elements must be missing.</span><span>
</span><a name="line-73"></a><span class="hs-identifier">mkTupleUnboxedSection</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-74"></a><a name="mkTupleUnboxedSection"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkTupleUnboxedSection"><span class="hs-identifier">mkTupleUnboxedSection</span></a></a><span> </span><a name="local-6989586621679100523"><a href="#local-6989586621679100523"><span class="hs-identifier">elems</span></a></a><span> </span><span>
</span><a name="line-75"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679100524"><a href="#local-6989586621679100524"><span class="hs-identifier">tupSecs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">Missing</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Present</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100523"><span class="hs-identifier hs-var">elems</span></a><span>
</span><a name="line-76"></a><span>     </span><span class="hs-keyword">in</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UTupleSection</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100524"><span class="hs-identifier hs-var">tupSecs</span></a><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">-- | Create a list expression: @[1,2,3]@</span><span>
</span><a name="line-79"></a><span class="hs-identifier">mkList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-80"></a><a name="mkList"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkList"><span class="hs-identifier">mkList</span></a></a><span> </span><a name="local-6989586621679100525"><a href="#local-6989586621679100525"><span class="hs-identifier">exprs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;[&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;]&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UList</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100525"><span class="hs-identifier hs-var">exprs</span></a><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">-- | Create a parallel array expression: @[: 1,2,3 :]@</span><span>
</span><a name="line-83"></a><span class="hs-identifier">mkParArray</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-84"></a><a name="mkParArray"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkParArray"><span class="hs-identifier">mkParArray</span></a></a><span> </span><a name="local-6989586621679100526"><a href="#local-6989586621679100526"><span class="hs-identifier">exprs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;[: &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; :]&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UParArray</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100526"><span class="hs-identifier hs-var">exprs</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | Create a parenthesized expression: @( a + b )@</span><span>
</span><a name="line-87"></a><span class="hs-identifier">mkParen</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-88"></a><a name="mkParen"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkParen"><span class="hs-identifier">mkParen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UParen</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">-- | Create a left operator section: @(1+)@</span><span>
</span><a name="line-91"></a><span class="hs-identifier">mkLeftSection</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Operator"><span class="hs-identifier hs-type">Operator</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-92"></a><a name="mkLeftSection"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkLeftSection"><span class="hs-identifier">mkLeftSection</span></a></a><span> </span><a name="local-6989586621679100527"><a href="#local-6989586621679100527"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679100528"><a href="#local-6989586621679100528"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ULeftSection</span><span> </span><a href="#local-6989586621679100527"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621679100528"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">-- | Create a right operator section: @(+1)@</span><span>
</span><a name="line-95"></a><span class="hs-identifier">mkRightSection</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Operator"><span class="hs-identifier hs-type">Operator</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-96"></a><a name="mkRightSection"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkRightSection"><span class="hs-identifier">mkRightSection</span></a></a><span> </span><a name="local-6989586621679100529"><a href="#local-6989586621679100529"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679100530"><a href="#local-6989586621679100530"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">URightSection</span><span> </span><a href="#local-6989586621679100529"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679100530"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- | Create a record value construction: @Point { x = 3, y = -2 }@</span><span>
</span><a name="line-99"></a><span class="hs-identifier">mkRecCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#FieldUpdate"><span class="hs-identifier hs-type">FieldUpdate</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-100"></a><a name="mkRecCon"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkRecCon"><span class="hs-identifier">mkRecCon</span></a></a><span> </span><a name="local-6989586621679100531"><a href="#local-6989586621679100531"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679100532"><a href="#local-6989586621679100532"><span class="hs-identifier">flds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; { &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; }&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">URecCon</span><span> </span><a href="#local-6989586621679100531"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100532"><span class="hs-identifier hs-var">flds</span></a><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-comment">-- | Create a record value  update: @p1 { x = 3, y = -2 }@</span><span>
</span><a name="line-103"></a><span class="hs-identifier">mkRecUpdate</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#FieldUpdate"><span class="hs-identifier hs-type">FieldUpdate</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-104"></a><a name="mkRecUpdate"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkRecUpdate"><span class="hs-identifier">mkRecUpdate</span></a></a><span> </span><a name="local-6989586621679100533"><a href="#local-6989586621679100533"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679100534"><a href="#local-6989586621679100534"><span class="hs-identifier">flds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; { &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; }&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">URecUpdate</span><span> </span><a href="#local-6989586621679100533"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100534"><span class="hs-identifier hs-var">flds</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- | Create a enumeration expression (@ [1,3..10] @)</span><span>
</span><a name="line-107"></a><span class="hs-identifier">mkEnum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-108"></a><a name="mkEnum"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkEnum"><span class="hs-identifier">mkEnum</span></a></a><span> </span><a name="local-6989586621679100535"><a href="#local-6989586621679100535"><span class="hs-identifier">from</span></a></a><span> </span><a name="local-6989586621679100536"><a href="#local-6989586621679100536"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679100537"><a href="#local-6989586621679100537"><span class="hs-identifier">to</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;[&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;..&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;]&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UEnum</span><span> </span><a href="#local-6989586621679100535"><span class="hs-identifier hs-var">from</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnMaybe"><span class="hs-identifier hs-var">mkAnnMaybe</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">after</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-identifier hs-var">opt</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100536"><span class="hs-identifier hs-var">step</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnMaybe"><span class="hs-identifier hs-var">mkAnnMaybe</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">after</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-identifier hs-var">opt</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100537"><span class="hs-identifier hs-var">to</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-comment">-- | Create a parallel array enumeration (@ [: 1,3 .. 10 :] @)</span><span>
</span><a name="line-111"></a><span class="hs-identifier">mkParArrayEnum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-112"></a><a name="mkParArrayEnum"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkParArrayEnum"><span class="hs-identifier">mkParArrayEnum</span></a></a><span> </span><a name="local-6989586621679100538"><a href="#local-6989586621679100538"><span class="hs-identifier">from</span></a></a><span> </span><a name="local-6989586621679100539"><a href="#local-6989586621679100539"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679100540"><a href="#local-6989586621679100540"><span class="hs-identifier">to</span></a></a><span>
</span><a name="line-113"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;[: &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;..&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; :]&quot;</span><span class="hs-special">)</span><span> </span><span>
</span><a name="line-114"></a><span>      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UParArrayEnum</span><span> </span><a href="#local-6989586621679100538"><span class="hs-identifier hs-var">from</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnMaybe"><span class="hs-identifier hs-var">mkAnnMaybe</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">after</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-identifier hs-var">opt</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100539"><span class="hs-identifier hs-var">step</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100540"><span class="hs-identifier hs-var">to</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">-- | Create a list comprehension (@ [ (x, y) | x &lt;- xs | y &lt;- ys ] @)</span><span>
</span><a name="line-117"></a><span class="hs-identifier">mkListComp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#ListCompBody"><span class="hs-identifier hs-type">ListCompBody</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-118"></a><a name="mkListComp"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkListComp"><span class="hs-identifier">mkListComp</span></a></a><span> </span><a name="local-6989586621679100541"><a href="#local-6989586621679100541"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679100542"><a href="#local-6989586621679100542"><span class="hs-identifier">stmts</span></a></a><span> </span><span>
</span><a name="line-119"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;[ &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; | &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; ]&quot;</span><span class="hs-special">)</span><span> </span><span>
</span><a name="line-120"></a><span>      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UListComp</span><span> </span><a href="#local-6989586621679100541"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot; | &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100542"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- | Create a parallel array comprehensions @ [: (x, y) | x &lt;- xs , y &lt;- ys :] @ enabled by @ParallelArrays@</span><span>
</span><a name="line-123"></a><span class="hs-identifier">mkParArrayComp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#ListCompBody"><span class="hs-identifier hs-type">ListCompBody</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-124"></a><a name="mkParArrayComp"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkParArrayComp"><span class="hs-identifier">mkParArrayComp</span></a></a><span> </span><a name="local-6989586621679100543"><a href="#local-6989586621679100543"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679100544"><a href="#local-6989586621679100544"><span class="hs-identifier">stmts</span></a></a><span> </span><span>
</span><a name="line-125"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;[: &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; | &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; :]&quot;</span><span class="hs-special">)</span><span> </span><span>
</span><a name="line-126"></a><span>      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UParArrayComp</span><span> </span><a href="#local-6989586621679100543"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot; | &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100544"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-comment">-- | Create a explicit type signature (@ x :: Int @)</span><span>
</span><a name="line-129"></a><span class="hs-identifier">mkExprTypeSig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-130"></a><a name="mkExprTypeSig"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkExprTypeSig"><span class="hs-identifier">mkExprTypeSig</span></a></a><span> </span><a name="local-6989586621679100545"><a href="#local-6989586621679100545"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679100546"><a href="#local-6989586621679100546"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; :: &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UTypeSig</span><span> </span><a href="#local-6989586621679100545"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621679100546"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">-- | Create a explicit type application (@ show \@Integer (read &quot;5&quot;) @)</span><span>
</span><a name="line-133"></a><span class="hs-identifier">mkExplicitTypeApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-134"></a><a name="mkExplicitTypeApp"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkExplicitTypeApp"><span class="hs-identifier">mkExplicitTypeApp</span></a></a><span> </span><a name="local-6989586621679100547"><a href="#local-6989586621679100547"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679100548"><a href="#local-6989586621679100548"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; @&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UExplTypeApp</span><span> </span><a href="#local-6989586621679100547"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679100548"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | @'x@ for template haskell reifying of expressions</span><span>
</span><a name="line-137"></a><span class="hs-identifier">mkVarQuote</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-138"></a><a name="mkVarQuote"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkVarQuote"><span class="hs-identifier">mkVarQuote</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;'&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UVarQuote</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-comment">-- | @''T@ for template haskell reifying of types</span><span>
</span><a name="line-141"></a><span class="hs-identifier">mkTypeQuote</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-142"></a><a name="mkTypeQuote"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkTypeQuote"><span class="hs-identifier">mkTypeQuote</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;''&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UTypeQuote</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">-- | Create a template haskell bracket expression</span><span>
</span><a name="line-145"></a><span class="hs-identifier">mkBracketExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Bracket"><span class="hs-identifier hs-type">Bracket</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-146"></a><a name="mkBracketExpr"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkBracketExpr"><span class="hs-identifier">mkBracketExpr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UBracketExpr</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">-- | Create a template haskell splice expression, for example: @$(gen a)@ or @$x@</span><span>
</span><a name="line-149"></a><span class="hs-identifier">mkSpliceExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Splice"><span class="hs-identifier hs-type">Splice</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-150"></a><a name="mkSpliceExpr"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkSpliceExpr"><span class="hs-identifier">mkSpliceExpr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">USplice</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | Create a template haskell quasi quote expression, for example: @[quoter| a + b ]@</span><span>
</span><a name="line-153"></a><span class="hs-identifier">mkQuasiQuoteExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#QuasiQuote"><span class="hs-identifier hs-type">QuasiQuote</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-154"></a><a name="mkQuasiQuoteExpr"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkQuasiQuoteExpr"><span class="hs-identifier">mkQuasiQuoteExpr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UQuasiQuoteExpr</span><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">-- | Creates a pragma that marks an expression.</span><span>
</span><a name="line-157"></a><span class="hs-identifier">mkExprPragma</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#ExprPragma"><span class="hs-identifier hs-type">ExprPragma</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-158"></a><a name="mkExprPragma"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkExprPragma"><span class="hs-identifier">mkExprPragma</span></a></a><span> </span><a name="local-6989586621679100549"><a href="#local-6989586621679100549"><span class="hs-identifier">pragma</span></a></a><span> </span><a name="local-6989586621679100550"><a href="#local-6989586621679100550"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UExprPragma</span><span> </span><a href="#local-6989586621679100549"><span class="hs-identifier hs-var">pragma</span></a><span> </span><a href="#local-6989586621679100550"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">-- | Create a arrow definition: @proc a -&gt; f -&lt; a+1@</span><span>
</span><a name="line-161"></a><span class="hs-identifier">mkProcExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-162"></a><a name="mkProcExpr"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkProcExpr"><span class="hs-identifier">mkProcExpr</span></a></a><span> </span><a name="local-6989586621679100551"><a href="#local-6989586621679100551"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679100552"><a href="#local-6989586621679100552"><span class="hs-identifier">cmd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;proc &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; -&gt; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UProc</span><span> </span><a href="#local-6989586621679100551"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679100552"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">-- | Create a arrow definition: @proc a -&gt; f -&lt; a+1@</span><span>
</span><a name="line-165"></a><span class="hs-identifier">mkArrowApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#ArrowApp"><span class="hs-identifier hs-type">ArrowApp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-166"></a><a name="mkArrowApp"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkArrowApp"><span class="hs-identifier">mkArrowApp</span></a></a><span> </span><a name="local-6989586621679100553"><a href="#local-6989586621679100553"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679100554"><a href="#local-6989586621679100554"><span class="hs-identifier">arrow</span></a></a><span> </span><a name="local-6989586621679100555"><a href="#local-6989586621679100555"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UArrowApp</span><span> </span><a href="#local-6989586621679100553"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621679100554"><span class="hs-identifier hs-var">arrow</span></a><span> </span><a href="#local-6989586621679100555"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-comment">-- | Create a lambda case ( @\case 0 -&gt; 1; 1 -&gt; 2@ )</span><span>
</span><a name="line-169"></a><span class="hs-identifier">mkLambdaCase</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Alt"><span class="hs-identifier hs-type">Alt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-170"></a><a name="mkLambdaCase"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkLambdaCase"><span class="hs-identifier">mkLambdaCase</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;\\case&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">ULamCase</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">indented</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-comment">-- | Create a static pointer expression (@ static e @). The inner expression must be closed (cannot have variables bound outside)</span><span>
</span><a name="line-173"></a><span class="hs-identifier">mkStaticPointer</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span>
</span><a name="line-174"></a><a name="mkStaticPointer"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkStaticPointer"><span class="hs-identifier">mkStaticPointer</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;static&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UStaticPtr</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">-- * Field updates</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-comment">-- | Create a update of a field (@ x = 1 @)</span><span>
</span><a name="line-181"></a><span class="hs-identifier">mkFieldUpdate</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#FieldUpdate"><span class="hs-identifier hs-type">FieldUpdate</span></a><span>
</span><a name="line-182"></a><a name="mkFieldUpdate"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkFieldUpdate"><span class="hs-identifier">mkFieldUpdate</span></a></a><span> </span><a name="local-6989586621679100556"><a href="#local-6989586621679100556"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679100557"><a href="#local-6989586621679100557"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; = &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UNormalFieldUpdate</span><span> </span><a href="#local-6989586621679100556"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679100557"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- | Create a update the field to the value of the same name (@ x @)</span><span>
</span><a name="line-185"></a><span class="hs-identifier">mkFieldPun</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#FieldUpdate"><span class="hs-identifier hs-type">FieldUpdate</span></a><span>
</span><a name="line-186"></a><a name="mkFieldPun"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkFieldPun"><span class="hs-identifier">mkFieldPun</span></a></a><span> </span><a name="local-6989586621679100558"><a href="#local-6989586621679100558"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UFieldPun</span><span> </span><a href="#local-6989586621679100558"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-comment">-- | Create a update the fields of the bounded names to their values (@ .. @). Must be the last initializer. Cannot be used in a record update expression.</span><span>
</span><a name="line-189"></a><span class="hs-identifier">mkFieldWildcard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#FieldUpdate"><span class="hs-identifier hs-type">FieldUpdate</span></a><span>
</span><a name="line-190"></a><a name="mkFieldWildcard"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkFieldWildcard"><span class="hs-identifier">mkFieldWildcard</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UFieldWildcard</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-string">&quot;..&quot;</span><span> </span><span class="hs-identifier hs-var">FldWildcard</span><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-comment">-- * Pattern matching and guards</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-comment">-- | Create a clause of case expression (@ Just x -&gt; x + 1 @)</span><span>
</span><a name="line-196"></a><span class="hs-identifier">mkAlt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#CaseRhs"><span class="hs-identifier hs-type">CaseRhs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#LocalBinds"><span class="hs-identifier hs-type">LocalBinds</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Alt"><span class="hs-identifier hs-type">Alt</span></a><span>
</span><a name="line-197"></a><a name="mkAlt"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkAlt"><span class="hs-identifier">mkAlt</span></a></a><span> </span><a name="local-6989586621679100559"><a href="#local-6989586621679100559"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679100560"><a href="#local-6989586621679100560"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679100561"><a href="#local-6989586621679100561"><span class="hs-identifier">locals</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UAlt</span><span> </span><a href="#local-6989586621679100559"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679100560"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnMaybe"><span class="hs-identifier hs-var">mkAnnMaybe</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">after</span><span> </span><span class="hs-string">&quot; where &quot;</span><span> </span><span class="hs-identifier hs-var">opt</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100561"><span class="hs-identifier hs-var">locals</span></a><span class="hs-special">)</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">-- | Create a unguarded right-hand side a pattern match (@ -&gt; 3 @)</span><span>
</span><a name="line-200"></a><span class="hs-identifier">mkCaseRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#CaseRhs"><span class="hs-identifier hs-type">CaseRhs</span></a><span>
</span><a name="line-201"></a><a name="mkCaseRhs"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkCaseRhs"><span class="hs-identifier">mkCaseRhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot; -&gt; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UUnguardedCaseRhs</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-comment">-- | Create a guarded right-hand sides of a pattern match (@ | x == 1 -&gt; 3; | otherwise -&gt; 4 @)</span><span>
</span><a name="line-204"></a><span class="hs-identifier">mkGuardedCaseRhss</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#GuardedCaseRhs"><span class="hs-identifier hs-type">GuardedCaseRhs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#CaseRhs"><span class="hs-identifier hs-type">CaseRhs</span></a><span>
</span><a name="line-205"></a><a name="mkGuardedCaseRhss"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkGuardedCaseRhss"><span class="hs-identifier">mkGuardedCaseRhss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UGuardedCaseRhss</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">indented</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">-- | Creates a guarded right-hand side of pattern matches binding (@ | x &gt; 3 -&gt; 2 @)      </span><span>
</span><a name="line-208"></a><span class="hs-identifier">mkGuardedCaseRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#RhsGuard"><span class="hs-identifier hs-type">RhsGuard</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#GuardedCaseRhs"><span class="hs-identifier hs-type">GuardedCaseRhs</span></a><span>
</span><a name="line-209"></a><a name="mkGuardedCaseRhs"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkGuardedCaseRhs"><span class="hs-identifier">mkGuardedCaseRhs</span></a></a><span> </span><a name="local-6989586621679100562"><a href="#local-6989586621679100562"><span class="hs-identifier">guards</span></a></a><span> </span><a name="local-6989586621679100563"><a href="#local-6989586621679100563"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot; | &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; -&gt; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UGuardedCaseRhs</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100562"><span class="hs-identifier hs-var">guards</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100563"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-comment">-- * Pragmas that can be applied to expressions</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-comment">-- | Creates a @CORE@ pragma for adding notes to expressions.</span><span>
</span><a name="line-214"></a><span class="hs-identifier">mkCorePragma</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#ExprPragma"><span class="hs-identifier hs-type">ExprPragma</span></a><span>
</span><a name="line-215"></a><a name="mkCorePragma"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkCorePragma"><span class="hs-identifier">mkCorePragma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;{-# CORE &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; #-}&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UCorePragma</span><span> </span><span>
</span><a name="line-216"></a><span>                 </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;\&quot;&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;\&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UStringNode</span><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-comment">-- | Creates an @SCC@ pragma for defining cost centers for profiling</span><span>
</span><a name="line-219"></a><span class="hs-identifier">mkSccPragma</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#ExprPragma"><span class="hs-identifier hs-type">ExprPragma</span></a><span>
</span><a name="line-220"></a><a name="mkSccPragma"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkSccPragma"><span class="hs-identifier">mkSccPragma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;{-# SCC &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; #-}&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">USccPragma</span><span> </span><span>
</span><a name="line-221"></a><span>                </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;\&quot;&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;\&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UStringNode</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">-- | Creates a pragma that describes if an expression was generated from a code fragment by an external tool (@ {-\# GENERATED &quot;Happy.y&quot; 1:15-1:25 \#-} @)</span><span>
</span><a name="line-224"></a><span class="hs-identifier">mkGeneratedPragma</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#SourceRange"><span class="hs-identifier hs-type">SourceRange</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#ExprPragma"><span class="hs-identifier hs-type">ExprPragma</span></a><span>
</span><a name="line-225"></a><a name="mkGeneratedPragma"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkGeneratedPragma"><span class="hs-identifier">mkGeneratedPragma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;{-# GENERATED &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; #-}&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">UGeneratedPragma</span><span> </span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-comment">-- | Create a in-AST source ranges (for generated pragmas)</span><span>
</span><a name="line-228"></a><span class="hs-identifier">mkSourceRange</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#SourceRange"><span class="hs-identifier hs-type">SourceRange</span></a><span>
</span><a name="line-229"></a><a name="mkSourceRange"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkSourceRange"><span class="hs-identifier">mkSourceRange</span></a></a><span> </span><a name="local-6989586621679100564"><a href="#local-6989586621679100564"><span class="hs-identifier">file</span></a></a><span> </span><a name="local-6989586621679100565"><a href="#local-6989586621679100565"><span class="hs-identifier">fromLine</span></a></a><span> </span><a name="local-6989586621679100566"><a href="#local-6989586621679100566"><span class="hs-identifier">fromCol</span></a></a><span> </span><a name="local-6989586621679100567"><a href="#local-6989586621679100567"><span class="hs-identifier">toLine</span></a></a><span> </span><a name="local-6989586621679100568"><a href="#local-6989586621679100568"><span class="hs-identifier">toCol</span></a></a><span>
</span><a name="line-230"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;-&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span>
</span><a name="line-231"></a><span>      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">USourceRange</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;\&quot;&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;\&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UStringNode</span><span> </span><a href="#local-6989586621679100564"><span class="hs-identifier hs-var">file</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>          </span><span class="hs-special">(</span><a href="#local-6989586621679100569"><span class="hs-identifier hs-var">mkNumber</span></a><span> </span><a href="#local-6989586621679100565"><span class="hs-identifier hs-var">fromLine</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100569"><span class="hs-identifier hs-var">mkNumber</span></a><span> </span><a href="#local-6989586621679100566"><span class="hs-identifier hs-var">fromCol</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100569"><span class="hs-identifier hs-var">mkNumber</span></a><span> </span><a href="#local-6989586621679100567"><span class="hs-identifier hs-var">toLine</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100569"><span class="hs-identifier hs-var">mkNumber</span></a><span> </span><a href="#local-6989586621679100568"><span class="hs-identifier hs-var">toCol</span></a><span class="hs-special">)</span><span>
</span><a name="line-233"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679100569"><a href="#local-6989586621679100569"><span class="hs-identifier">mkNumber</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Number</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-comment">-- * Commands</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-comment">-- | An arrow application command (@ f -&lt; x + 1 @)</span><span>
</span><a name="line-238"></a><span class="hs-identifier">mkArrowAppCmd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#ArrowApp"><span class="hs-identifier hs-type">ArrowApp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span>
</span><a name="line-239"></a><a name="mkArrowAppCmd"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkArrowAppCmd"><span class="hs-identifier">mkArrowAppCmd</span></a></a><span> </span><a name="local-6989586621679100570"><a href="#local-6989586621679100570"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679100571"><a href="#local-6989586621679100571"><span class="hs-identifier">arrow</span></a></a><span> </span><a name="local-6989586621679100572"><a href="#local-6989586621679100572"><span class="hs-identifier">rhs</span></a></a><span> </span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UArrowAppCmd</span><span> </span><a href="#local-6989586621679100570"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621679100571"><span class="hs-identifier hs-var">arrow</span></a><span> </span><a href="#local-6989586621679100572"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-comment">-- | A form command (@ (|untilA (increment -&lt; x+y) (within 0.5 -&lt; x)|) @)</span><span>
</span><a name="line-244"></a><span class="hs-identifier">mkArrowFromCmd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span>
</span><a name="line-245"></a><a name="mkArrowFromCmd"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkArrowFromCmd"><span class="hs-identifier">mkArrowFromCmd</span></a></a><span> </span><a name="local-6989586621679100573"><a href="#local-6989586621679100573"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679100574"><a href="#local-6989586621679100574"><span class="hs-identifier">cmds</span></a></a><span> </span><span>
</span><a name="line-246"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(| &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; |)&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span>      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UArrowFormCmd</span><span> </span><a href="#local-6989586621679100573"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">after</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100574"><span class="hs-identifier hs-var">cmds</span></a><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span class="hs-comment">-- | A function application command</span><span>
</span><a name="line-250"></a><span class="hs-identifier">mkAppCmd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span>
</span><a name="line-251"></a><a name="mkAppCmd"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkAppCmd"><span class="hs-identifier">mkAppCmd</span></a></a><span> </span><a name="local-6989586621679100575"><a href="#local-6989586621679100575"><span class="hs-identifier">cmd</span></a></a><span> </span><a name="local-6989586621679100576"><a href="#local-6989586621679100576"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>                      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UAppCmd</span><span> </span><a href="#local-6989586621679100575"><span class="hs-identifier hs-var">cmd</span></a><span> </span><a href="#local-6989586621679100576"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-comment">-- | An infix command application</span><span>
</span><a name="line-255"></a><span class="hs-identifier">mkInfixCmd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span>
</span><a name="line-256"></a><a name="mkInfixCmd"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkInfixCmd"><span class="hs-identifier">mkInfixCmd</span></a></a><span> </span><a name="local-6989586621679100577"><a href="#local-6989586621679100577"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679100578"><a href="#local-6989586621679100578"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679100579"><a href="#local-6989586621679100579"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span>                          </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UInfixCmd</span><span> </span><a href="#local-6989586621679100577"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621679100578"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679100579"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-comment">-- | A lambda command </span><span>
</span><a name="line-260"></a><span class="hs-identifier">mkLambdaCmd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span>
</span><a name="line-261"></a><a name="mkLambdaCmd"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkLambdaCmd"><span class="hs-identifier">mkLambdaCmd</span></a></a><span> </span><a name="local-6989586621679100580"><a href="#local-6989586621679100580"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621679100581"><a href="#local-6989586621679100581"><span class="hs-identifier">cmd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;\\&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; -&gt; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span>
</span><a name="line-262"></a><span>                         </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ULambdaCmd</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">separatedBy</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100580"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100581"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-comment">-- | A parenthesized command</span><span>
</span><a name="line-265"></a><span class="hs-identifier">mkParenCmd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span>
</span><a name="line-266"></a><a name="mkParenCmd"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkParenCmd"><span class="hs-identifier">mkParenCmd</span></a></a><span> </span><a name="local-6989586621679100582"><a href="#local-6989586621679100582"><span class="hs-identifier">cmd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UParenCmd</span><span> </span><a href="#local-6989586621679100582"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-comment">-- | A pattern match command</span><span>
</span><a name="line-269"></a><span class="hs-identifier">mkCaseCmd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#CmdAlt"><span class="hs-identifier hs-type">CmdAlt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span>
</span><a name="line-270"></a><a name="mkCaseCmd"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkCaseCmd"><span class="hs-identifier">mkCaseCmd</span></a></a><span> </span><a name="local-6989586621679100583"><a href="#local-6989586621679100583"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679100584"><a href="#local-6989586621679100584"><span class="hs-identifier">alts</span></a></a><span> </span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;case &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; of &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span>
</span><a name="line-272"></a><span>      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UCaseCmd</span><span> </span><a href="#local-6989586621679100583"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">indented</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100584"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-comment">-- | An if command (@ if f x y then g -&lt; x+1 else h -&lt; y+2 @)</span><span>
</span><a name="line-275"></a><span class="hs-identifier">mkIfCmd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span>
</span><a name="line-276"></a><a name="mkIfCmd"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkIfCmd"><span class="hs-identifier">mkIfCmd</span></a></a><span> </span><a name="local-6989586621679100585"><a href="#local-6989586621679100585"><span class="hs-identifier">pred</span></a></a><span> </span><a name="local-6989586621679100586"><a href="#local-6989586621679100586"><span class="hs-identifier">then_</span></a></a><span> </span><a name="local-6989586621679100587"><a href="#local-6989586621679100587"><span class="hs-identifier">else_</span></a></a><span> </span><span>
</span><a name="line-277"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;if &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; then &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; else &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span>
</span><a name="line-278"></a><span>      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UIfCmd</span><span> </span><a href="#local-6989586621679100585"><span class="hs-identifier hs-var">pred</span></a><span> </span><a href="#local-6989586621679100586"><span class="hs-identifier hs-var">then_</span></a><span> </span><a href="#local-6989586621679100587"><span class="hs-identifier hs-var">else_</span></a><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-comment">-- | A local binding command (@ let z = x+y @)</span><span>
</span><a name="line-281"></a><span class="hs-identifier">mkLetCmd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#LocalBind"><span class="hs-identifier hs-type">LocalBind</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span>
</span><a name="line-282"></a><a name="mkLetCmd"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkLetCmd"><span class="hs-identifier">mkLetCmd</span></a></a><span> </span><a name="local-6989586621679100588"><a href="#local-6989586621679100588"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621679100589"><a href="#local-6989586621679100589"><span class="hs-identifier">cmd</span></a></a><span>
</span><a name="line-283"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;let &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; in &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span>
</span><a name="line-284"></a><span>      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ULetCmd</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">indented</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100588"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100589"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span class="hs-comment">-- | A do-notation in a command</span><span>
</span><a name="line-287"></a><span class="hs-identifier">mkDoCmd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#CmdStmt"><span class="hs-identifier hs-type">CmdStmt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a><span>
</span><a name="line-288"></a><a name="mkDoCmd"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkDoCmd"><span class="hs-identifier">mkDoCmd</span></a></a><span> </span><a name="local-6989586621679100590"><a href="#local-6989586621679100590"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;do &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">child</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UDoCmd</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnnList"><span class="hs-identifier hs-var">mkAnnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">indented</span><span> </span><span class="hs-identifier hs-var">list</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100590"><span class="hs-identifier hs-var">stmts</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-comment">-- | Left arrow application: @-&lt;@</span><span>
</span><a name="line-291"></a><span class="hs-identifier">mkLeftAppl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#ArrowApp"><span class="hs-identifier hs-type">ArrowApp</span></a><span>
</span><a name="line-292"></a><a name="mkLeftAppl"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkLeftAppl"><span class="hs-identifier">mkLeftAppl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-string">&quot;-&lt;&quot;</span><span> </span><span class="hs-identifier hs-var">ULeftAppl</span><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-comment">-- | Right arrow application: @&gt;-@</span><span>
</span><a name="line-295"></a><span class="hs-identifier">mkRightAppl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#ArrowApp"><span class="hs-identifier hs-type">ArrowApp</span></a><span>
</span><a name="line-296"></a><a name="mkRightAppl"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkRightAppl"><span class="hs-identifier">mkRightAppl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-string">&quot;&gt;-&quot;</span><span> </span><span class="hs-identifier hs-var">URightAppl</span><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-comment">-- | Left arrow high application: @-&lt;&lt;@</span><span>
</span><a name="line-299"></a><span class="hs-identifier">mkLeftHighAppl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#ArrowApp"><span class="hs-identifier hs-type">ArrowApp</span></a><span>
</span><a name="line-300"></a><a name="mkLeftHighAppl"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkLeftHighAppl"><span class="hs-identifier">mkLeftHighAppl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-string">&quot;-&lt;&lt;&quot;</span><span> </span><span class="hs-identifier hs-var">ULeftHighApp</span><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span class="hs-comment">-- | Right arrow high application: @&gt;&gt;-@</span><span>
</span><a name="line-303"></a><span class="hs-identifier">mkRightHighAppl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.Tools.Rewrite.ElementTypes.html#ArrowApp"><span class="hs-identifier hs-type">ArrowApp</span></a><span>
</span><a name="line-304"></a><a name="mkRightHighAppl"><a href="Language.Haskell.Tools.Rewrite.Create.Exprs.html#mkRightHighAppl"><span class="hs-identifier">mkRightHighAppl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.Tools.Rewrite.Create.Utils.html#mkAnn"><span class="hs-identifier hs-var">mkAnn</span></a><span> </span><span class="hs-string">&quot;&gt;&gt;-&quot;</span><span> </span><span class="hs-identifier hs-var">URightHighApp</span><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span>
</span><a name="line-307"></a><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a></pre></body></html>