<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css">
span.lineno { color: white; background: #aaaaaa; border-right: solid white 12px }
span.nottickedoff { background: yellow}
span.istickedoff { background: white }
span.tickonlyfalse { margin: -1px; border: 1px solid #f20913; background: #f20913 }
span.tickonlytrue  { margin: -1px; border: 1px solid #60de51; background: #60de51 }
span.funcount { font-size: small; color: orange; z-index: 2; position: absolute; right: 20 }
span.decl { font-weight: bold }
span.spaces    { background: white }
</style>
</head>
<body>
<pre>
<span class="decl"><span class="nottickedoff">never executed</span> <span class="tickonlytrue">always true</span> <span class="tickonlyfalse">always false</span></span>
</pre>
<pre>
<span class="lineno">    1 </span>{-# LANGUAGE FlexibleContexts, RankNTypes, TypeFamilies #-}
<span class="lineno">    2 </span>
<span class="lineno">    3 </span>module Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST
<span class="lineno">    4 </span>  ( module Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.TraverseAST
<span class="lineno">    5 </span>  , module Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad
<span class="lineno">    6 </span>  ) where
<span class="lineno">    7 </span>
<span class="lineno">    8 </span>import Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.Checkers
<span class="lineno">    9 </span>import Language.Haskell.Tools.Refactor.Builtin.ExtensionOrganizer.ExtMonad
<span class="lineno">   10 </span>
<span class="lineno">   11 </span>import Language.Haskell.Tools.AST
<span class="lineno">   12 </span>import Language.Haskell.Tools.Refactor as Refact
<span class="lineno">   13 </span>
<span class="lineno">   14 </span>import Control.Reference ((!~), (&amp;), (&amp;+&amp;))
<span class="lineno">   15 </span>
<span class="lineno">   16 </span>{-
<span class="lineno">   17 </span>   NOTE: We need Decl level checking for deriving clausese
<span class="lineno">   18 </span>         in order to gain extra information from the newtype and data keywords.
<span class="lineno">   19 </span>
<span class="lineno">   20 </span>         We need Decl level checking for instance heads, in order to distinguish
<span class="lineno">   21 </span>         class instances from data and type family instances.
<span class="lineno">   22 </span>-}
<span class="lineno">   23 </span>chkDecl :: CheckNode Decl
<span class="lineno">   24 </span><span class="decl"><span class="istickedoff">chkDecl = chkFlexibleInstances &gt;=&gt; chkDerivings</span></span>
<span class="lineno">   25 </span>
<span class="lineno">   26 </span>chkPattern :: CheckNode Pattern
<span class="lineno">   27 </span><span class="decl"><span class="istickedoff">chkPattern = chkBangPatterns</span>
<span class="lineno">   28 </span><span class="spaces">         </span><span class="istickedoff">&gt;=&gt; chkViewPatterns</span>
<span class="lineno">   29 </span><span class="spaces">         </span><span class="istickedoff">&gt;=&gt; chkUnboxedTuplesPat</span></span>
<span class="lineno">   30 </span>
<span class="lineno">   31 </span>chkExpr :: CheckNode Expr
<span class="lineno">   32 </span><span class="decl"><span class="istickedoff">chkExpr = chkTupleSections</span>
<span class="lineno">   33 </span><span class="spaces">      </span><span class="istickedoff">&gt;=&gt; chkUnboxedTuplesExpr</span>
<span class="lineno">   34 </span><span class="spaces">      </span><span class="istickedoff">&gt;=&gt; chkLambdaCase</span></span>
<span class="lineno">   35 </span>
<span class="lineno">   36 </span>chkType :: CheckNode Type
<span class="lineno">   37 </span><span class="decl"><span class="istickedoff">chkType = chkUnboxedTuplesType</span></span>
<span class="lineno">   38 </span>
<span class="lineno">   39 </span>chkPatternField :: CheckNode PatternField
<span class="lineno">   40 </span><span class="decl"><span class="istickedoff">chkPatternField = chkRecordWildCardsPatField</span></span>
<span class="lineno">   41 </span>
<span class="lineno">   42 </span>chkFieldUpdate :: CheckNode FieldUpdate
<span class="lineno">   43 </span><span class="decl"><span class="istickedoff">chkFieldUpdate = chkRecordWildCardsFieldUpdate</span></span>
<span class="lineno">   44 </span>
<span class="lineno">   45 </span>chkPatternSynonym :: CheckNode PatternSynonym
<span class="lineno">   46 </span><span class="decl"><span class="istickedoff">chkPatternSynonym = chkPatternSynonymsSyn</span></span>
<span class="lineno">   47 </span>
<span class="lineno">   48 </span>chkPatternSignature :: CheckNode PatternSignature
<span class="lineno">   49 </span><span class="decl"><span class="istickedoff">chkPatternSignature = chkPatternSynonymsTypeSig</span></span>
<span class="lineno">   50 </span>
<span class="lineno">   51 </span>chkLiteral :: CheckNode Literal
<span class="lineno">   52 </span><span class="decl"><span class="istickedoff">chkLiteral = chkMagicHashLiteral</span></span>
<span class="lineno">   53 </span>
<span class="lineno">   54 </span>chkNamePart :: CheckNode NamePart
<span class="lineno">   55 </span><span class="decl"><span class="istickedoff">chkNamePart = chkMagicHashNamePart</span>
<span class="lineno">   56 </span><span class="spaces">          </span><span class="istickedoff">&gt;=&gt; chkTemplateHaskellhNamePart</span></span>
<span class="lineno">   57 </span>
<span class="lineno">   58 </span>chkKind :: CheckNode Kind
<span class="lineno">   59 </span><span class="decl"><span class="istickedoff">chkKind = chkMagicHashKind</span></span>
<span class="lineno">   60 </span>
<span class="lineno">   61 </span>
<span class="lineno">   62 </span>traverseModule :: CheckNode UnnamedModule
<span class="lineno">   63 </span><span class="decl"><span class="istickedoff">traverseModule = (modDecl &amp; annList !~ traverseDecl)</span>
<span class="lineno">   64 </span><span class="spaces">             </span><span class="istickedoff">&gt;=&gt; (modHead &amp; annJust !~ traverseModuleHead)</span></span>
<span class="lineno">   65 </span>             -- more
<span class="lineno">   66 </span>
<span class="lineno">   67 </span>traverseModuleHead :: CheckNode ModuleHead
<span class="lineno">   68 </span><span class="decl"><span class="istickedoff">traverseModuleHead = mhExports &amp; annJust !~ <span class="nottickedoff">traverseExportSpecs</span></span></span>
<span class="lineno">   69 </span>                    -- more
<span class="lineno">   70 </span>
<span class="lineno">   71 </span>traverseExportSpecs :: CheckNode ExportSpecs
<span class="lineno">   72 </span><span class="decl"><span class="nottickedoff">traverseExportSpecs = espExports &amp; annList !~ traverseExportSpec</span></span>
<span class="lineno">   73 </span>
<span class="lineno">   74 </span>traverseExportSpec :: CheckNode ExportSpec
<span class="lineno">   75 </span><span class="decl"><span class="nottickedoff">traverseExportSpec = exportDecl !~ traverseIESpec</span></span>
<span class="lineno">   76 </span>
<span class="lineno">   77 </span>traverseIESpec :: CheckNode IESpec
<span class="lineno">   78 </span><span class="decl"><span class="nottickedoff">traverseIESpec = (ieName !~ traverseName)</span>
<span class="lineno">   79 </span><span class="spaces">             </span><span class="nottickedoff">&gt;=&gt; (ieSubspec &amp; annJust !~ traverseSubSpec)</span></span>
<span class="lineno">   80 </span>
<span class="lineno">   81 </span>traverseSubSpec :: CheckNode SubSpec
<span class="lineno">   82 </span><span class="decl"><span class="nottickedoff">traverseSubSpec = essList &amp; annList !~ traverseName</span></span>
<span class="lineno">   83 </span>
<span class="lineno">   84 </span>traverseDecl :: CheckNode Decl
<span class="lineno">   85 </span><span class="decl"><span class="istickedoff">traverseDecl = chkDecl</span>
<span class="lineno">   86 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declValBind !~ traverseValueBind)</span>
<span class="lineno">   87 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declBody &amp; annJust !~ traverseClassBody)</span>
<span class="lineno">   88 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declSplice !~ <span class="nottickedoff">traverseSplice</span>)</span>
<span class="lineno">   89 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (innerType !~ traverseType)</span>
<span class="lineno">   90 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declTypeSig !~ traverseTypeSignature)</span>
<span class="lineno">   91 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declTypeFamily !~ <span class="nottickedoff">traverseTypeFamily</span>) --</span>
<span class="lineno">   92 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declSpec &amp; <span class="nottickedoff">annJust</span> !~ <span class="nottickedoff">traverseTypeFamilySpec</span>)</span>
<span class="lineno">   93 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declSafety &amp; <span class="nottickedoff">annJust</span> !~ <span class="nottickedoff">traverseSafety</span>)</span>
<span class="lineno">   94 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declRoles &amp; <span class="nottickedoff">annList</span> !~ <span class="nottickedoff">traverseRole</span>)</span>
<span class="lineno">   95 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declPragma !~ traverseTopLevelPragma)</span>
<span class="lineno">   96 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declPatTypeSig !~ traversePatternSignature)</span>
<span class="lineno">   97 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declPatSyn !~ traversePatternSynonym)</span>
<span class="lineno">   98 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declOverlap &amp; annJust !~ <span class="nottickedoff">traverseOverlapPragma</span>)</span>
<span class="lineno">   99 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declKind &amp; annJust !~ <span class="nottickedoff">traverseKindContraint</span>)</span>
<span class="lineno">  100 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (innerInstanceRule !~ traverseInstanceRule)</span>
<span class="lineno">  101 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declInstDecl &amp; annJust !~ traverseInstBody)</span>
<span class="lineno">  102 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declHead !~ traverseDeclHead)</span>
<span class="lineno">  103 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declGadt &amp; annList !~ traverseGadtConDecl)</span>
<span class="lineno">  104 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declFunDeps &amp; annJust !~ traverseFunDeps)</span>
<span class="lineno">  105 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declForeignType !~ <span class="nottickedoff">traverseType</span>)</span>
<span class="lineno">  106 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declFixity !~ <span class="nottickedoff">traverseFixitySignature</span>)</span>
<span class="lineno">  107 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declDeriving &amp; annList !~ traverseDeriving)</span>
<span class="lineno">  108 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declDecl &amp; <span class="nottickedoff">annList</span> !~ <span class="nottickedoff">traverseTypeEqn</span>)</span>
<span class="lineno">  109 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declCtx &amp; annJust !~ <span class="nottickedoff">traverseContext</span>)</span>
<span class="lineno">  110 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declCons &amp; annList !~ traverseConDecl)</span>
<span class="lineno">  111 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declCallConv !~ <span class="nottickedoff">traverseCallConv</span>)</span>
<span class="lineno">  112 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declName !~ <span class="nottickedoff">traverseName</span>)</span>
<span class="lineno">  113 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (declRoleType !~ <span class="nottickedoff">traverseQualifiedName</span>)</span>
<span class="lineno">  114 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  115 </span><span class="spaces">  </span><span class="istickedoff">where innerType = (declTypes &amp; <span class="nottickedoff">annList</span>)</span>
<span class="lineno">  116 </span><span class="spaces">                </span><span class="istickedoff">&amp;+&amp; declType</span>
<span class="lineno">  117 </span><span class="spaces">                </span><span class="istickedoff">&amp;+&amp; declAssignedType</span>
<span class="lineno">  118 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  119 </span><span class="spaces">        </span><span class="istickedoff">innerInstanceRule = declInstance &amp;+&amp; declInstRule</span></span>
<span class="lineno">  120 </span>
<span class="lineno">  121 </span>traverseTypeFamily :: CheckNode TypeFamily
<span class="lineno">  122 </span><span class="decl"><span class="nottickedoff">traverseTypeFamily = (tfHead !~ traverseDeclHead)</span>
<span class="lineno">  123 </span><span class="spaces">                 </span><span class="nottickedoff">&gt;=&gt; (tfSpec &amp; annJust !~ traverseTypeFamilySpec)</span>
<span class="lineno">  124 </span><span class="spaces">                 </span><span class="nottickedoff">&gt;=&gt; (tfKind &amp; annJust !~ traverseKindContraint)</span></span>
<span class="lineno">  125 </span>
<span class="lineno">  126 </span>-- tfTypeVar is from 0.9
<span class="lineno">  127 </span>traverseTypeFamilySpec :: CheckNode TypeFamilySpec
<span class="lineno">  128 </span><span class="decl"><span class="nottickedoff">traverseTypeFamilySpec = (tfSpecKind !~ traverseKindContraint)</span>
<span class="lineno">  129 </span><span class="spaces">                     </span><span class="nottickedoff">-- &gt;=&gt; (tfTypeVar !~ traverseTyVar)</span>
<span class="lineno">  130 </span><span class="spaces">                     </span><span class="nottickedoff">&gt;=&gt; (tfInjectivity !~ traverseInjectivityAnn)</span></span>
<span class="lineno">  131 </span>
<span class="lineno">  132 </span>traverseInjectivityAnn :: CheckNode InjectivityAnn
<span class="lineno">  133 </span><span class="decl"><span class="nottickedoff">traverseInjectivityAnn = (injAnnRes !~ traverseTyVar)</span>
<span class="lineno">  134 </span><span class="spaces">                     </span><span class="nottickedoff">&gt;=&gt; (injAnnDeps &amp; annList !~ traverseName)</span></span>
<span class="lineno">  135 </span>
<span class="lineno">  136 </span>-- DONE
<span class="lineno">  137 </span>traverseSafety :: CheckNode Safety
<span class="lineno">  138 </span><span class="decl"><span class="nottickedoff">traverseSafety = return</span></span>
<span class="lineno">  139 </span>
<span class="lineno">  140 </span>-- DONE
<span class="lineno">  141 </span>traverseRole :: CheckNode Role
<span class="lineno">  142 </span><span class="decl"><span class="nottickedoff">traverseRole = return</span></span>
<span class="lineno">  143 </span>
<span class="lineno">  144 </span>traverseTopLevelPragma :: CheckNode TopLevelPragma
<span class="lineno">  145 </span><span class="decl"><span class="istickedoff">traverseTopLevelPragma = (pragmaRule &amp; <span class="nottickedoff">annList</span> !~ <span class="nottickedoff">traverseRule</span>)</span>
<span class="lineno">  146 </span><span class="spaces">                     </span><span class="istickedoff">&gt;=&gt; (pragmaObjects &amp; <span class="nottickedoff">annList</span> !~ <span class="nottickedoff">traverseName</span>)</span>
<span class="lineno">  147 </span><span class="spaces">                     </span><span class="istickedoff">&gt;=&gt; (annotationSubject !~ traverseAnnotationSubject)</span>
<span class="lineno">  148 </span><span class="spaces">                     </span><span class="istickedoff">&gt;=&gt; (pragmaInline !~ <span class="nottickedoff">traverseInlinePragma</span>)</span>
<span class="lineno">  149 </span><span class="spaces">                     </span><span class="istickedoff">&gt;=&gt; (specializePragma !~ <span class="nottickedoff">traverseSpecializePragma</span>)</span></span>
<span class="lineno">  150 </span>
<span class="lineno">  151 </span>-- no references for this
<span class="lineno">  152 </span>traverseSpecializePragma :: CheckUNode USpecializePragma
<span class="lineno">  153 </span><span class="decl"><span class="nottickedoff">traverseSpecializePragma = return</span></span> {- (specializeDef !~ traverseName)
<span class="lineno">  154 </span>                       &gt;=&gt; (specializeType &amp; annList !~ traverseType) -}
<span class="lineno">  155 </span>
<span class="lineno">  156 </span>traverseAnnotationSubject :: CheckNode AnnotationSubject
<span class="lineno">  157 </span><span class="decl"><span class="istickedoff">traverseAnnotationSubject = annotateName !~ <span class="nottickedoff">traverseName</span></span></span>
<span class="lineno">  158 </span>
<span class="lineno">  159 </span>traverseRule :: CheckNode Rule
<span class="lineno">  160 </span><span class="decl"><span class="nottickedoff">traverseRule = (ruleBounded &amp; annList !~ traverseRuleVar)</span>
<span class="lineno">  161 </span><span class="spaces">           </span><span class="nottickedoff">&gt;=&gt; (innerExpr !~ traverseExpr)</span>
<span class="lineno">  162 </span><span class="spaces">           </span><span class="nottickedoff">-- some more</span>
<span class="lineno">  163 </span><span class="spaces"></span><span class="nottickedoff"></span>
<span class="lineno">  164 </span><span class="spaces">  </span><span class="nottickedoff">where innerExpr = ruleLhs &amp;+&amp; ruleRhs</span></span>
<span class="lineno">  165 </span>
<span class="lineno">  166 </span>traverseRuleVar :: CheckNode RuleVar
<span class="lineno">  167 </span><span class="decl"><span class="nottickedoff">traverseRuleVar = (ruleVarName !~ traverseName)</span>
<span class="lineno">  168 </span><span class="spaces">              </span><span class="nottickedoff">&gt;=&gt; (ruleVarType !~ traverseType)</span></span>
<span class="lineno">  169 </span>
<span class="lineno">  170 </span>traversePatternSignature :: CheckNode PatternSignature
<span class="lineno">  171 </span><span class="decl"><span class="istickedoff">traversePatternSignature = chkPatternSignature</span>
<span class="lineno">  172 </span><span class="spaces">                       </span><span class="istickedoff">&gt;=&gt; (patSigName &amp; annList !~ traverseName)</span>
<span class="lineno">  173 </span><span class="spaces">                       </span><span class="istickedoff">&gt;=&gt; (patSigType !~ traverseType)</span></span>
<span class="lineno">  174 </span>
<span class="lineno">  175 </span>-- DONE
<span class="lineno">  176 </span>traverseOverlapPragma :: CheckNode OverlapPragma
<span class="lineno">  177 </span><span class="decl"><span class="nottickedoff">traverseOverlapPragma = return</span></span>
<span class="lineno">  178 </span>
<span class="lineno">  179 </span>-- weird structure of nodes (Maybe (Ann AnnListG dom stage))
<span class="lineno">  180 </span>traverseInstanceRule :: CheckNode InstanceRule
<span class="lineno">  181 </span><span class="decl"><span class="istickedoff">traverseInstanceRule = (irVars &amp; annJust &amp; <span class="nottickedoff">element</span> &amp; <span class="nottickedoff">annList</span> !~ <span class="nottickedoff">traverseTyVar</span>)</span>
<span class="lineno">  182 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (irCtx &amp; annJust !~ traverseContext)</span>
<span class="lineno">  183 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (irHead !~ traverseInstanceHead)</span></span>
<span class="lineno">  184 </span>
<span class="lineno">  185 </span>traverseInstanceHead :: CheckNode InstanceHead
<span class="lineno">  186 </span><span class="decl"><span class="istickedoff">traverseInstanceHead = (ihConName !~ traverseName)</span>
<span class="lineno">  187 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (ihOperator !~ traverseOperator)</span>
<span class="lineno">  188 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (innerType !~ traverseType)</span>
<span class="lineno">  189 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (innerIHead !~ traverseInstanceHead)</span>
<span class="lineno">  190 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  191 </span><span class="spaces">  </span><span class="istickedoff">where innerType = ihLeftOp &amp;+&amp; ihType</span>
<span class="lineno">  192 </span><span class="spaces">        </span><span class="istickedoff">innerIHead = ihHead &amp;+&amp; ihFun</span></span>
<span class="lineno">  193 </span>
<span class="lineno">  194 </span>traverseDeclHead :: CheckNode DeclHead
<span class="lineno">  195 </span><span class="decl"><span class="istickedoff">traverseDeclHead = (dhName !~ traverseName)</span>
<span class="lineno">  196 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (dhOperator !~ traverseOperator)</span>
<span class="lineno">  197 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (innerDHead !~ traverseDeclHead)</span>
<span class="lineno">  198 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (innerTyVar !~ traverseTyVar)</span>
<span class="lineno">  199 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  200 </span><span class="spaces">  </span><span class="istickedoff">where innerDHead = dhBody &amp;+&amp; dhAppFun</span>
<span class="lineno">  201 </span><span class="spaces">        </span><span class="istickedoff">innerTyVar = dhAppOperand &amp;+&amp; dhLeft &amp;+&amp; dhRight</span></span>
<span class="lineno">  202 </span>
<span class="lineno">  203 </span>traverseGadtConDecl :: CheckNode GadtConDecl
<span class="lineno">  204 </span><span class="decl"><span class="istickedoff">traverseGadtConDecl = (gadtConNames &amp; annList !~ traverseName)</span>
<span class="lineno">  205 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (gadtConTypeArgs &amp; annList !~ <span class="nottickedoff">traverseTyVar</span>)</span>
<span class="lineno">  206 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (gadtConTypeCtx &amp; annJust !~ <span class="nottickedoff">traverseContext</span>)</span>
<span class="lineno">  207 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (gadtConType !~ traverseGadtConType)</span></span>
<span class="lineno">  208 </span>
<span class="lineno">  209 </span>traverseGadtConType :: CheckNode GadtConType
<span class="lineno">  210 </span><span class="decl"><span class="istickedoff">traverseGadtConType = (innerType !~ traverseType)</span>
<span class="lineno">  211 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (gadtConRecordFields &amp; <span class="nottickedoff">annList</span> !~ <span class="nottickedoff">traverseFieldDecl</span>)</span>
<span class="lineno">  212 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  213 </span><span class="spaces">  </span><span class="istickedoff">where innerType = gadtConNormalType &amp;+&amp; gadtConResultType</span></span>
<span class="lineno">  214 </span>
<span class="lineno">  215 </span>traverseFieldDecl :: CheckNode FieldDecl
<span class="lineno">  216 </span><span class="decl"><span class="istickedoff">traverseFieldDecl = (fieldNames &amp; annList !~ traverseName)</span>
<span class="lineno">  217 </span><span class="spaces">                </span><span class="istickedoff">&gt;=&gt; (fieldType !~ traverseType)</span></span>
<span class="lineno">  218 </span>
<span class="lineno">  219 </span>traverseFunDeps :: CheckNode FunDeps
<span class="lineno">  220 </span><span class="decl"><span class="istickedoff">traverseFunDeps = funDeps &amp; annList !~ traverseFunDep</span></span>
<span class="lineno">  221 </span>
<span class="lineno">  222 </span>traverseFunDep :: CheckNode FunDep
<span class="lineno">  223 </span><span class="decl"><span class="istickedoff">traverseFunDep = innerName !~ traverseName</span>
<span class="lineno">  224 </span><span class="spaces">  </span><span class="istickedoff">where innerName = (funDepLhs &amp; annList) &amp;+&amp; (funDepRhs &amp; annList)</span></span>
<span class="lineno">  225 </span>
<span class="lineno">  226 </span>traverseDeriving :: CheckNode Deriving
<span class="lineno">  227 </span><span class="decl"><span class="istickedoff">traverseDeriving = innerIHead !~ traverseInstanceHead</span>
<span class="lineno">  228 </span><span class="spaces">  </span><span class="istickedoff">where innerIHead = oneDerived &amp;+&amp; (allDerived &amp; annList)</span></span>
<span class="lineno">  229 </span>
<span class="lineno">  230 </span>traverseConDecl :: CheckNode ConDecl
<span class="lineno">  231 </span><span class="decl"><span class="istickedoff">traverseConDecl = (conTypeArgs &amp; annList !~ <span class="nottickedoff">traverseTyVar</span>)</span>
<span class="lineno">  232 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (conTypeCtx &amp; annJust !~ <span class="nottickedoff">traverseContext</span>)</span>
<span class="lineno">  233 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (conDeclName !~ traverseName)</span>
<span class="lineno">  234 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (innerType !~ traverseType)</span>
<span class="lineno">  235 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (conDeclFields &amp; annList !~ traverseFieldDecl)</span>
<span class="lineno">  236 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  237 </span><span class="spaces">  </span><span class="istickedoff">where innerType = (conDeclArgs &amp; annList)</span>
<span class="lineno">  238 </span><span class="spaces">                </span><span class="istickedoff">&amp;+&amp; conDeclLhs</span>
<span class="lineno">  239 </span><span class="spaces">                </span><span class="istickedoff">&amp;+&amp; conDeclRhs</span></span>
<span class="lineno">  240 </span>
<span class="lineno">  241 </span>-- DONE
<span class="lineno">  242 </span>traverseCallConv :: CheckNode CallConv
<span class="lineno">  243 </span><span class="decl"><span class="nottickedoff">traverseCallConv = return</span></span>
<span class="lineno">  244 </span>
<span class="lineno">  245 </span>traverseMinimalFormula :: CheckNode MinimalFormula
<span class="lineno">  246 </span><span class="decl"><span class="nottickedoff">traverseMinimalFormula = (minimalName !~ traverseName)</span>
<span class="lineno">  247 </span><span class="spaces">                     </span><span class="nottickedoff">&gt;=&gt; (innerFormula !~ traverseMinimalFormula)</span>
<span class="lineno">  248 </span><span class="spaces"></span><span class="nottickedoff"></span>
<span class="lineno">  249 </span><span class="spaces">  </span><span class="nottickedoff">where innerFormula = minimalInner</span>
<span class="lineno">  250 </span><span class="spaces">                   </span><span class="nottickedoff">&amp;+&amp; (minimalOrs &amp; annList)</span>
<span class="lineno">  251 </span><span class="spaces">                   </span><span class="nottickedoff">&amp;+&amp; (minimalAnds &amp; annList)</span></span>
<span class="lineno">  252 </span>
<span class="lineno">  253 </span>-- there is no wrapper type for InlinePragma
<span class="lineno">  254 </span>-- no references generated
<span class="lineno">  255 </span>traverseInlinePragma :: CheckUNode UInlinePragma
<span class="lineno">  256 </span><span class="decl"><span class="nottickedoff">traverseInlinePragma = return</span></span> {- nnerName !~ traverseName
<span class="lineno">  257 </span>  where innerName = inlineDef &amp;+&amp; noInlineDef &amp;+&amp; inlinableDef -}
<span class="lineno">  258 </span>
<span class="lineno">  259 </span>
<span class="lineno">  260 </span>
<span class="lineno">  261 </span>
<span class="lineno">  262 </span>traversePatternSynonym :: CheckNode PatternSynonym
<span class="lineno">  263 </span><span class="decl"><span class="istickedoff">traversePatternSynonym = chkPatternSynonym</span>
<span class="lineno">  264 </span><span class="spaces">                         </span><span class="istickedoff">&gt;=&gt; (patRhs !~ traverseInnerRhs)</span>
<span class="lineno">  265 </span><span class="spaces">                         </span><span class="istickedoff">&gt;=&gt; (patLhs !~ traverseInnerLhs)</span>
<span class="lineno">  266 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  267 </span><span class="spaces">  </span><span class="istickedoff">where traverseInnerRhs = (patRhsPat !~ traversePattern)</span>
<span class="lineno">  268 </span><span class="spaces">          </span><span class="istickedoff">&gt;=&gt; (patRhsOpposite &amp; annJust &amp; patOpposite &amp; annList !~ traverseMatch)</span>
<span class="lineno">  269 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  270 </span><span class="spaces">        </span><span class="istickedoff">traverseInnerLhs = (innerName !~ traverseName)</span>
<span class="lineno">  271 </span><span class="spaces">                           </span><span class="istickedoff">&gt;=&gt; (patSynOp !~ <span class="nottickedoff">traverseOperator</span>)</span>
<span class="lineno">  272 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  273 </span><span class="spaces">        </span><span class="istickedoff">innerName = patName &amp;+&amp; (patArgs &amp; annList) &amp;+&amp; patSynLhs &amp;+&amp; patSynRhs</span></span>
<span class="lineno">  274 </span>
<span class="lineno">  275 </span>
<span class="lineno">  276 </span>
<span class="lineno">  277 </span>traverseMatch :: CheckNode Match
<span class="lineno">  278 </span><span class="decl"><span class="istickedoff">traverseMatch = (matchLhs !~ traverseMatchLhs)</span>
<span class="lineno">  279 </span><span class="spaces">                </span><span class="istickedoff">&gt;=&gt; (matchRhs !~ traverseRhs)</span>
<span class="lineno">  280 </span><span class="spaces">                </span><span class="istickedoff">&gt;=&gt; (matchBinds &amp; annJust !~ traverseLocalBinds)</span></span>
<span class="lineno">  281 </span>
<span class="lineno">  282 </span>traverseMatchLhs :: CheckNode MatchLhs
<span class="lineno">  283 </span><span class="decl"><span class="istickedoff">traverseMatchLhs = (matchLhsName !~ traverseName)</span>
<span class="lineno">  284 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (matchLhsOperator !~ <span class="nottickedoff">traverseOperator</span>)</span>
<span class="lineno">  285 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (innerPattern !~ traversePattern)</span>
<span class="lineno">  286 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  287 </span><span class="spaces">  </span><span class="istickedoff">where innerPattern = matchLhsArgs &amp; annList</span>
<span class="lineno">  288 </span><span class="spaces">                       </span><span class="istickedoff">&amp;+&amp; matchLhsLhs</span>
<span class="lineno">  289 </span><span class="spaces">                       </span><span class="istickedoff">&amp;+&amp; matchLhsRhs</span></span>
<span class="lineno">  290 </span>
<span class="lineno">  291 </span>traverseRhs :: CheckNode Rhs
<span class="lineno">  292 </span><span class="decl"><span class="istickedoff">traverseRhs = (rhsExpr !~ traverseExpr)</span>
<span class="lineno">  293 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (rhsGuards &amp; annList !~ traverseGuardedRhs)</span></span>
<span class="lineno">  294 </span>
<span class="lineno">  295 </span>traverseGuardedRhs :: CheckNode GuardedRhs
<span class="lineno">  296 </span><span class="decl"><span class="istickedoff">traverseGuardedRhs = (guardStmts &amp; annList !~ traverseRhsGuard)</span>
<span class="lineno">  297 </span><span class="spaces">                     </span><span class="istickedoff">&gt;=&gt; (guardExpr !~ traverseExpr)</span></span>
<span class="lineno">  298 </span>
<span class="lineno">  299 </span>traverseRhsGuard :: CheckNode RhsGuard
<span class="lineno">  300 </span><span class="decl"><span class="istickedoff">traverseRhsGuard = (guardPat !~ traversePattern)</span>
<span class="lineno">  301 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (guardRhs &amp;+&amp; guardCheck !~ traverseExpr)</span>
<span class="lineno">  302 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (guardBinds &amp; <span class="nottickedoff">annList</span> !~ <span class="nottickedoff">traverseLocalBind</span>)</span></span>
<span class="lineno">  303 </span>
<span class="lineno">  304 </span>traverseLocalBinds :: CheckNode LocalBinds
<span class="lineno">  305 </span><span class="decl"><span class="istickedoff">traverseLocalBinds = localBinds &amp; annList !~ traverseLocalBind</span></span>
<span class="lineno">  306 </span>
<span class="lineno">  307 </span>traverseLocalBind :: CheckNode LocalBind
<span class="lineno">  308 </span><span class="decl"><span class="istickedoff">traverseLocalBind = (localVal !~ traverseValueBind)</span>
<span class="lineno">  309 </span><span class="spaces">                    </span><span class="istickedoff">&gt;=&gt; (localSig !~ traverseTypeSignature)</span>
<span class="lineno">  310 </span><span class="spaces">                    </span><span class="istickedoff">&gt;=&gt; (localFixity !~ <span class="nottickedoff">traverseFixitySignature</span>)</span></span>
<span class="lineno">  311 </span>                    -- &gt;=&gt; (localInline !~ ...)
<span class="lineno">  312 </span>
<span class="lineno">  313 </span>
<span class="lineno">  314 </span>traverseInstBody :: CheckNode InstBody
<span class="lineno">  315 </span><span class="decl"><span class="istickedoff">traverseInstBody = instBodyDecls &amp; annList !~ traverseInstBodyDecl</span></span>
<span class="lineno">  316 </span>
<span class="lineno">  317 </span>traverseInstBodyDecl :: CheckNode InstBodyDecl
<span class="lineno">  318 </span><span class="decl"><span class="istickedoff">traverseInstBodyDecl = (instBodyDeclFunbind !~ traverseValueBind)</span>
<span class="lineno">  319 </span><span class="spaces">                       </span><span class="istickedoff">&gt;=&gt; (instBodyTypeSig !~ <span class="nottickedoff">traverseTypeSignature</span>)</span>
<span class="lineno">  320 </span><span class="spaces">                       </span><span class="istickedoff">&gt;=&gt; (instBodyTypeEqn !~ <span class="nottickedoff">traverseTypeEqn</span>)</span>
<span class="lineno">  321 </span><span class="spaces">                       </span><span class="istickedoff">&gt;=&gt; (specializeInstanceType !~ <span class="nottickedoff">traverseType</span>)</span></span>
<span class="lineno">  322 </span>                       -- and many more ...
<span class="lineno">  323 </span>
<span class="lineno">  324 </span>traverseTypeEqn :: CheckNode TypeEqn
<span class="lineno">  325 </span><span class="decl"><span class="nottickedoff">traverseTypeEqn = teLhs &amp;+&amp; teRhs !~ traverseType</span></span>
<span class="lineno">  326 </span>
<span class="lineno">  327 </span>traverseClassBody :: CheckNode ClassBody
<span class="lineno">  328 </span><span class="decl"><span class="istickedoff">traverseClassBody = cbElements &amp; annList !~ traverseClassElem</span></span>
<span class="lineno">  329 </span>
<span class="lineno">  330 </span>traverseClassElem :: CheckNode ClassElement
<span class="lineno">  331 </span><span class="decl"><span class="istickedoff">traverseClassElem = (ceTypeSig !~ traverseTypeSignature)</span>
<span class="lineno">  332 </span><span class="spaces">                    </span><span class="istickedoff">&gt;=&gt; (clsFixity !~ <span class="nottickedoff">traverseFixitySignature</span>)</span>
<span class="lineno">  333 </span><span class="spaces">                    </span><span class="istickedoff">&gt;=&gt; (ceBind !~ traverseValueBind)</span>
<span class="lineno">  334 </span><span class="spaces">                    </span><span class="istickedoff">&gt;=&gt; (ceName !~ traverseName)</span>
<span class="lineno">  335 </span><span class="spaces">                    </span><span class="istickedoff">&gt;=&gt; (ceKind &amp;+&amp; ceType !~ traverseType)</span></span>
<span class="lineno">  336 </span>
<span class="lineno">  337 </span>                    -- some more, but are not important
<span class="lineno">  338 </span>
<span class="lineno">  339 </span>
<span class="lineno">  340 </span>traverseValueBind :: CheckNode ValueBind
<span class="lineno">  341 </span><span class="decl"><span class="istickedoff">traverseValueBind = (valBindPat !~ traversePattern)</span>
<span class="lineno">  342 </span><span class="spaces">                    </span><span class="istickedoff">&gt;=&gt; (valBindRhs !~ traverseRhs)</span>
<span class="lineno">  343 </span><span class="spaces">                    </span><span class="istickedoff">&gt;=&gt; (valBindLocals &amp; annJust !~ traverseLocalBinds)</span>
<span class="lineno">  344 </span><span class="spaces">                    </span><span class="istickedoff">&gt;=&gt; (funBindMatches &amp; annList !~ traverseMatch)</span></span>
<span class="lineno">  345 </span>
<span class="lineno">  346 </span>
<span class="lineno">  347 </span>traversePattern :: CheckNode Pattern
<span class="lineno">  348 </span><span class="decl"><span class="istickedoff">traversePattern = chkPattern</span>
<span class="lineno">  349 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (innerPattern !~ traversePattern)</span>
<span class="lineno">  350 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (innerLiteral !~ traverseLiteral)</span>
<span class="lineno">  351 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (patternOperator !~ traverseOperator)</span>
<span class="lineno">  352 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (patternFields &amp; annList !~ traversePatternField)</span>
<span class="lineno">  353 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (patternName !~ traverseName)</span>
<span class="lineno">  354 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (patternExpr !~ traverseExpr)</span>
<span class="lineno">  355 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (patternType !~ traverseType)</span>
<span class="lineno">  356 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (patternSplice !~ <span class="nottickedoff">traverseSplice</span>)</span>
<span class="lineno">  357 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (patQQ !~ <span class="nottickedoff">traverseQuasiQuote</span>)</span>
<span class="lineno">  358 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  359 </span><span class="spaces">  </span><span class="istickedoff">where</span>
<span class="lineno">  360 </span><span class="spaces">  </span><span class="istickedoff">innerPattern = patternLhs</span>
<span class="lineno">  361 </span><span class="spaces">                 </span><span class="istickedoff">&amp;+&amp; patternRhs</span>
<span class="lineno">  362 </span><span class="spaces">                 </span><span class="istickedoff">&amp;+&amp; patternInner</span>
<span class="lineno">  363 </span><span class="spaces">                 </span><span class="istickedoff">&amp;+&amp; (patternElems &amp; annList)</span>
<span class="lineno">  364 </span><span class="spaces">                 </span><span class="istickedoff">&amp;+&amp; (patternArgs &amp; annList)</span>
<span class="lineno">  365 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  366 </span><span class="spaces">  </span><span class="istickedoff">innerLiteral = patternLiteral &amp;+&amp; patternLit</span></span>
<span class="lineno">  367 </span>
<span class="lineno">  368 </span>traversePatternField :: CheckNode PatternField
<span class="lineno">  369 </span><span class="decl"><span class="istickedoff">traversePatternField = chkPatternField</span>
<span class="lineno">  370 </span><span class="spaces">                       </span><span class="istickedoff">&gt;=&gt; (fieldPatternName !~ traverseName)</span>
<span class="lineno">  371 </span><span class="spaces">                       </span><span class="istickedoff">&gt;=&gt; (fieldPattern !~ traversePattern)</span></span>
<span class="lineno">  372 </span>
<span class="lineno">  373 </span>-- TODO: TemplateHaskell?
<span class="lineno">  374 </span>traverseExpr :: CheckNode Expr
<span class="lineno">  375 </span><span class="decl"><span class="istickedoff">traverseExpr = chkExpr</span>
<span class="lineno">  376 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (innerExpressions !~ traverseExpr)</span>
<span class="lineno">  377 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (innerPatterns !~ traversePattern)</span>
<span class="lineno">  378 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (exprFunBind &amp; annList !~ traverseLocalBind)</span>
<span class="lineno">  379 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (exprIfAlts &amp; annList !~ traverseGuardedCaseRhs traverseExpr)</span>
<span class="lineno">  380 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (exprAlts &amp; annList !~ traverseAlt traverseExpr)</span>
<span class="lineno">  381 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (exprOperator !~ traverseOperator)</span>
<span class="lineno">  382 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (exprLit !~ traverseLiteral)</span>
<span class="lineno">  383 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (innerNames !~ traverseName)</span>
<span class="lineno">  384 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (exprStmts &amp; annList !~ traverseStmt traverseExpr)</span>
<span class="lineno">  385 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (tupleSectionElems &amp; annList !~ traverseTupSecElem)</span>
<span class="lineno">  386 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (exprRecFields &amp; annList !~ traverseFieldUpdate)</span>
<span class="lineno">  387 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (compBody &amp; annList !~ traverseListCompBody)</span>
<span class="lineno">  388 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (innerTypes !~ traverseType)</span>
<span class="lineno">  389 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (exprSplice !~ traverseSplice)</span>
<span class="lineno">  390 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (exprBracket !~ traverseBracket)</span>
<span class="lineno">  391 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (exprQQ !~ <span class="nottickedoff">traverseQuasiQuote</span>)</span>
<span class="lineno">  392 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  393 </span><span class="spaces"> </span><span class="istickedoff">where innerExpressions = (tupleElems &amp; annList)</span>
<span class="lineno">  394 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; (listElems &amp; annList)</span>
<span class="lineno">  395 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; innerExpr</span>
<span class="lineno">  396 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; exprCond</span>
<span class="lineno">  397 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; exprThen</span>
<span class="lineno">  398 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; exprElse</span>
<span class="lineno">  399 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; exprRhs</span>
<span class="lineno">  400 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; exprLhs</span>
<span class="lineno">  401 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; exprInner</span>
<span class="lineno">  402 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; exprFun</span>
<span class="lineno">  403 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; exprCase</span>
<span class="lineno">  404 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; exprArg</span>
<span class="lineno">  405 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; enumToFix</span>
<span class="lineno">  406 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; (enumTo &amp; annJust)</span>
<span class="lineno">  407 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; (enumThen &amp; annJust)</span>
<span class="lineno">  408 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; Refact.enumFrom</span>
<span class="lineno">  409 </span><span class="spaces">                         </span><span class="istickedoff">&amp;+&amp; compExpr</span>
<span class="lineno">  410 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  411 </span><span class="spaces">       </span><span class="istickedoff">innerPatterns = (exprBindings &amp; annList) &amp;+&amp; procPattern</span>
<span class="lineno">  412 </span><span class="spaces">       </span><span class="istickedoff">innerNames    = exprName &amp;+&amp; exprRecName &amp;+&amp; quotedName</span>
<span class="lineno">  413 </span><span class="spaces">       </span><span class="istickedoff">innerTypes    = exprSig &amp;+&amp; exprType</span></span>
<span class="lineno">  414 </span>
<span class="lineno">  415 </span>-- These types are needed to generalize AST traversal for polymorphic nodes.
<span class="lineno">  416 </span>-- These nodes are polymorphic in their inner nodes, which can be any &quot;UNodes&quot;
<span class="lineno">  417 </span>-- (UType. UExpr, UDecl etc ...)
<span class="lineno">  418 </span>type AltG uexpr dom            = Ann (UAlt' uexpr) dom SrcTemplateStage
<span class="lineno">  419 </span>type StmtG uexpr dom           = Ann (UStmt' uexpr) dom SrcTemplateStage
<span class="lineno">  420 </span>type CaseRhsG uexpr dom        = Ann (UCaseRhs' uexpr) dom SrcTemplateStage
<span class="lineno">  421 </span>type GuardedCaseRhsG uexpr dom = Ann (UGuardedCaseRhs' uexpr) dom SrcTemplateStage
<span class="lineno">  422 </span>
<span class="lineno">  423 </span>type PromotedG t dom = Ann (UPromoted t) dom  SrcTemplateStage
<span class="lineno">  424 </span>
<span class="lineno">  425 </span>traverseAlt :: CheckUNode uexpr -&gt; CheckNode (AltG uexpr IdDom)
<span class="lineno">  426 </span><span class="decl"><span class="istickedoff">traverseAlt f = (altPattern !~ traversePattern)</span>
<span class="lineno">  427 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (altRhs !~ traverseCaseRhs f)</span>
<span class="lineno">  428 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (altBinds &amp; annJust !~ traverseLocalBinds)</span></span>
<span class="lineno">  429 </span>
<span class="lineno">  430 </span>traverseCaseRhs :: CheckUNode uexpr -&gt; CheckNode (CaseRhsG uexpr IdDom)
<span class="lineno">  431 </span><span class="decl"><span class="istickedoff">traverseCaseRhs f = (rhsCaseExpr !~ f)</span>
<span class="lineno">  432 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (rhsCaseGuards &amp; <span class="nottickedoff">annList</span> !~ <span class="nottickedoff">traverseGuardedCaseRhs f</span>)</span></span>
<span class="lineno">  433 </span>
<span class="lineno">  434 </span>traverseGuardedCaseRhs :: CheckUNode uexpr -&gt; CheckNode (GuardedCaseRhsG uexpr IdDom)
<span class="lineno">  435 </span><span class="decl"><span class="istickedoff">traverseGuardedCaseRhs f = (caseGuardStmts &amp; annList !~ traverseRhsGuard)</span>
<span class="lineno">  436 </span><span class="spaces">                          </span><span class="istickedoff">&gt;=&gt; (caseGuardExpr !~ f)</span></span>
<span class="lineno">  437 </span>
<span class="lineno">  438 </span>traverseStmt :: CheckUNode uexpr -&gt; CheckNode (StmtG uexpr IdDom)
<span class="lineno">  439 </span><span class="decl"><span class="istickedoff">traverseStmt f = (stmtPattern !~ traversePattern)</span>
<span class="lineno">  440 </span><span class="spaces">                </span><span class="istickedoff">&gt;=&gt; (stmtExpr !~ f)</span>
<span class="lineno">  441 </span><span class="spaces">                </span><span class="istickedoff">&gt;=&gt; (stmtBinds &amp; annList !~ traverseLocalBind)</span>
<span class="lineno">  442 </span><span class="spaces">                </span><span class="istickedoff">&gt;=&gt; (cmdStmtBinds &amp; <span class="nottickedoff">annList</span> !~ <span class="nottickedoff">traverseStmt f</span>)</span></span>
<span class="lineno">  443 </span>
<span class="lineno">  444 </span>traversePromoted :: CheckUNode t -&gt; CheckNode (PromotedG t IdDom)
<span class="lineno">  445 </span><span class="decl"><span class="nottickedoff">traversePromoted f = (promotedConName !~ traverseName)</span>
<span class="lineno">  446 </span><span class="spaces">                 </span><span class="nottickedoff">&gt;=&gt; (promotedElements &amp; annList !~ f)</span></span>
<span class="lineno">  447 </span>
<span class="lineno">  448 </span>traverseTupSecElem :: CheckNode TupSecElem
<span class="lineno">  449 </span><span class="decl"><span class="istickedoff">traverseTupSecElem = tupSecExpr !~ traverseExpr</span></span>
<span class="lineno">  450 </span>
<span class="lineno">  451 </span>traverseFieldUpdate :: CheckNode FieldUpdate
<span class="lineno">  452 </span><span class="decl"><span class="istickedoff">traverseFieldUpdate = chkFieldUpdate</span>
<span class="lineno">  453 </span><span class="spaces">                      </span><span class="istickedoff">&gt;=&gt; (fieldName &amp;+&amp; fieldUpdateName !~ traverseName)</span>
<span class="lineno">  454 </span><span class="spaces">                      </span><span class="istickedoff">&gt;=&gt; (fieldValue !~ traverseExpr)</span></span>
<span class="lineno">  455 </span>
<span class="lineno">  456 </span>traverseListCompBody :: CheckNode ListCompBody
<span class="lineno">  457 </span><span class="decl"><span class="istickedoff">traverseListCompBody = compStmts &amp; annList !~ traverseCompStmt</span></span>
<span class="lineno">  458 </span>
<span class="lineno">  459 </span>traverseCompStmt :: CheckNode CompStmt
<span class="lineno">  460 </span><span class="decl"><span class="istickedoff">traverseCompStmt = (compStmt !~ traverseStmt traverseExpr)</span>
<span class="lineno">  461 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (innerExpressions !~ <span class="nottickedoff">traverseExpr</span>)</span>
<span class="lineno">  462 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  463 </span><span class="spaces"> </span><span class="istickedoff">where innerExpressions = thenExpr</span>
<span class="lineno">  464 </span><span class="spaces">                          </span><span class="istickedoff">&amp;+&amp; (byExpr &amp; <span class="nottickedoff">annJust</span>)</span>
<span class="lineno">  465 </span><span class="spaces">                          </span><span class="istickedoff">&amp;+&amp; (usingExpr &amp; <span class="nottickedoff">annJust</span>)</span></span>
<span class="lineno">  466 </span>
<span class="lineno">  467 </span>traverseCmd :: CheckNode Cmd
<span class="lineno">  468 </span><span class="decl"><span class="nottickedoff">traverseCmd = return</span></span>
<span class="lineno">  469 </span>{-
<span class="lineno">  470 </span>
<span class="lineno">  471 </span>References are not generated for UCmd
<span class="lineno">  472 </span>
<span class="lineno">  473 </span>traverseCmd = (innerExpressions !~ traverseExpr)
<span class="lineno">  474 </span>             &gt;=&gt; (innerCmds !~ traverseCmd)
<span class="lineno">  475 </span>             &gt;=&gt; (cmdStmtBinds &amp; annList !~ traversePattern)
<span class="lineno">  476 </span>             &gt;=&gt; (cmdBinds &amp; annList !~ traverseLocalBind)
<span class="lineno">  477 </span>             &gt;=&gt; (cmdAlts &amp; annList !~ traverseAlt traverseCmd)
<span class="lineno">  478 </span>             &gt;=&gt; (cmdStmts &amp; annList !~ traverseStmt traverseCmd)
<span class="lineno">  479 </span> where innerExpressions = cmdLhs &amp;+&amp; cmdRhs &amp;+&amp; cmdExpr &amp;+&amp; cmdApplied
<span class="lineno">  480 </span>
<span class="lineno">  481 </span>       innerCmds = (cmdInnerCmds &amp; annList)
<span class="lineno">  482 </span>                   &amp;+&amp; cmdInnerCmd
<span class="lineno">  483 </span>                   &amp;+&amp; cmdLeftCmd
<span class="lineno">  484 </span>                   &amp;+&amp; cmdRightCmd
<span class="lineno">  485 </span>                   &amp;+&amp; cmdInner
<span class="lineno">  486 </span>                   &amp;+&amp; cmdThen
<span class="lineno">  487 </span>                   &amp;+&amp; cmdElse
<span class="lineno">  488 </span>-}
<span class="lineno">  489 </span>
<span class="lineno">  490 </span>traverseSplice :: CheckNode Splice
<span class="lineno">  491 </span><span class="decl"><span class="istickedoff">traverseSplice = chkTemplateHaskellSplice</span>
<span class="lineno">  492 </span><span class="spaces">                 </span><span class="istickedoff">&gt;=&gt; (spliceId !~ <span class="nottickedoff">traverseName</span>)</span>
<span class="lineno">  493 </span><span class="spaces">                 </span><span class="istickedoff">&gt;=&gt; (spliceExpr !~ traverseExpr)</span></span>
<span class="lineno">  494 </span>
<span class="lineno">  495 </span>traverseBracket :: CheckNode Bracket
<span class="lineno">  496 </span><span class="decl"><span class="istickedoff">traverseBracket = chkTemplateHaskellBracket</span>
<span class="lineno">  497 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (bracketExpr !~ traverseExpr)</span>
<span class="lineno">  498 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (bracketPattern !~ <span class="nottickedoff">traversePattern</span>)</span>
<span class="lineno">  499 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (bracketType !~ <span class="nottickedoff">traverseType</span>)</span>
<span class="lineno">  500 </span><span class="spaces">                  </span><span class="istickedoff">&gt;=&gt; (bracketDecl &amp; <span class="nottickedoff">annList</span> !~ <span class="nottickedoff">traverseDecl</span>)</span></span>
<span class="lineno">  501 </span>
<span class="lineno">  502 </span>traverseQuasiQuote :: CheckNode QuasiQuote
<span class="lineno">  503 </span><span class="decl"><span class="nottickedoff">traverseQuasiQuote = chkTemplateHaskellQuasiQuote</span>
<span class="lineno">  504 </span><span class="spaces">                     </span><span class="nottickedoff">&gt;=&gt; (qqExprName !~ traverseName)</span></span>
<span class="lineno">  505 </span>
<span class="lineno">  506 </span>traverseType :: CheckNode Type
<span class="lineno">  507 </span><span class="decl"><span class="istickedoff">traverseType = chkType</span>
<span class="lineno">  508 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (typeBounded &amp; annList !~ traverseTyVar)</span>
<span class="lineno">  509 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (innerType !~ traverseType)</span>
<span class="lineno">  510 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (innerName !~ traverseName)</span>
<span class="lineno">  511 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (typeCtx !~ traverseContext)</span>
<span class="lineno">  512 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (typeOperator !~ traverseOperator)</span>
<span class="lineno">  513 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (typeKind !~ traverseKind)</span>
<span class="lineno">  514 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (tpPromoted !~ <span class="nottickedoff">traversePromoted traverseType</span>)</span>
<span class="lineno">  515 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (tsSplice !~ <span class="nottickedoff">traverseSplice</span>)</span>
<span class="lineno">  516 </span><span class="spaces">              </span><span class="istickedoff">&gt;=&gt; (typeQQ !~ <span class="nottickedoff">traverseQuasiQuote</span>)</span>
<span class="lineno">  517 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  518 </span><span class="spaces"> </span><span class="istickedoff">where innerType = typeType</span>
<span class="lineno">  519 </span><span class="spaces">                   </span><span class="istickedoff">&amp;+&amp; typeParam</span>
<span class="lineno">  520 </span><span class="spaces">                   </span><span class="istickedoff">&amp;+&amp; typeResult</span>
<span class="lineno">  521 </span><span class="spaces">                   </span><span class="istickedoff">&amp;+&amp; (typeElements &amp; annList)</span>
<span class="lineno">  522 </span><span class="spaces">                   </span><span class="istickedoff">&amp;+&amp; typeElement</span>
<span class="lineno">  523 </span><span class="spaces">                   </span><span class="istickedoff">&amp;+&amp; typeCon</span>
<span class="lineno">  524 </span><span class="spaces">                   </span><span class="istickedoff">&amp;+&amp; typeArg</span>
<span class="lineno">  525 </span><span class="spaces">                   </span><span class="istickedoff">&amp;+&amp; typeInner</span>
<span class="lineno">  526 </span><span class="spaces">                   </span><span class="istickedoff">&amp;+&amp; typeLeft</span>
<span class="lineno">  527 </span><span class="spaces">                   </span><span class="istickedoff">&amp;+&amp; typeRight</span>
<span class="lineno">  528 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  529 </span><span class="spaces">       </span><span class="istickedoff">innerName = typeName &amp;+&amp; typeWildcardName</span></span>
<span class="lineno">  530 </span>
<span class="lineno">  531 </span>traverseTyVar :: CheckNode TyVar
<span class="lineno">  532 </span><span class="decl"><span class="istickedoff">traverseTyVar = (tyVarName !~ traverseName)</span>
<span class="lineno">  533 </span><span class="spaces">               </span><span class="istickedoff">&gt;=&gt; (tyVarKind &amp; annJust !~ <span class="nottickedoff">traverseKindContraint</span>)</span></span>
<span class="lineno">  534 </span>
<span class="lineno">  535 </span>traverseKindContraint :: CheckNode KindConstraint
<span class="lineno">  536 </span><span class="decl"><span class="nottickedoff">traverseKindContraint = kindConstr !~ traverseKind</span></span>
<span class="lineno">  537 </span>
<span class="lineno">  538 </span>traverseKind :: CheckNode Kind
<span class="lineno">  539 </span><span class="decl"><span class="istickedoff">traverseKind = chkKind</span>
<span class="lineno">  540 </span><span class="spaces">           </span><span class="istickedoff">&gt;=&gt; (innerKind !~ <span class="nottickedoff">traverseKind</span>)</span>
<span class="lineno">  541 </span><span class="spaces">           </span><span class="istickedoff">&gt;=&gt; (kindVar !~ <span class="nottickedoff">traverseName</span>)</span>
<span class="lineno">  542 </span><span class="spaces">           </span><span class="istickedoff">&gt;=&gt; (kindAppOp !~ <span class="nottickedoff">traverseOperator</span>)</span>
<span class="lineno">  543 </span><span class="spaces">           </span><span class="istickedoff">&gt;=&gt; (kindPromoted !~ <span class="nottickedoff">traversePromoted traverseKind</span>)</span>
<span class="lineno">  544 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  545 </span><span class="spaces">  </span><span class="istickedoff">where innerKind = kindLeft</span>
<span class="lineno">  546 </span><span class="spaces">                </span><span class="istickedoff">&amp;+&amp; kindRight</span>
<span class="lineno">  547 </span><span class="spaces">                </span><span class="istickedoff">&amp;+&amp; kindParen</span>
<span class="lineno">  548 </span><span class="spaces">                </span><span class="istickedoff">&amp;+&amp; kindAppFun</span>
<span class="lineno">  549 </span><span class="spaces">                </span><span class="istickedoff">&amp;+&amp; kindAppArg</span>
<span class="lineno">  550 </span><span class="spaces">                </span><span class="istickedoff">&amp;+&amp; kindLhs</span>
<span class="lineno">  551 </span><span class="spaces">                </span><span class="istickedoff">&amp;+&amp; kindRhs</span>
<span class="lineno">  552 </span><span class="spaces">                </span><span class="istickedoff">&amp;+&amp; kindElem</span>
<span class="lineno">  553 </span><span class="spaces">                </span><span class="istickedoff">&amp;+&amp; (kindElems &amp; <span class="nottickedoff">annList</span>)</span></span>
<span class="lineno">  554 </span>
<span class="lineno">  555 </span>traverseContext :: CheckNode Context
<span class="lineno">  556 </span><span class="decl"><span class="istickedoff">traverseContext = contextAssertion !~ traverseAssertion</span></span>
<span class="lineno">  557 </span>
<span class="lineno">  558 </span>traverseAssertion :: CheckNode Assertion
<span class="lineno">  559 </span><span class="decl"><span class="istickedoff">traverseAssertion = (innerType !~ traverseType)</span>
<span class="lineno">  560 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (innerName !~ traverseName)</span>
<span class="lineno">  561 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (assertOp !~ traverseOperator)</span>
<span class="lineno">  562 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; (innerAsserts &amp; annList !~ traverseAssertion)</span>
<span class="lineno">  563 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  564 </span><span class="spaces"> </span><span class="istickedoff">where innerType = (assertTypes &amp; annList)</span>
<span class="lineno">  565 </span><span class="spaces">                   </span><span class="istickedoff">&amp;+&amp; assertLhs</span>
<span class="lineno">  566 </span><span class="spaces">                   </span><span class="istickedoff">&amp;+&amp; assertRhs</span>
<span class="lineno">  567 </span><span class="spaces">                   </span><span class="istickedoff">&amp;+&amp; assertImplType</span>
<span class="lineno">  568 </span><span class="spaces"></span><span class="istickedoff"></span>
<span class="lineno">  569 </span><span class="spaces">       </span><span class="istickedoff">innerName = assertClsName &amp;+&amp; assertImplVar</span></span>
<span class="lineno">  570 </span>
<span class="lineno">  571 </span>traverseName :: CheckNode Name
<span class="lineno">  572 </span><span class="decl"><span class="istickedoff">traverseName = simpleName !~ traverseQualifiedName</span></span>
<span class="lineno">  573 </span>
<span class="lineno">  574 </span>traverseQualifiedName :: CheckNode QualifiedName
<span class="lineno">  575 </span><span class="decl"><span class="istickedoff">traverseQualifiedName = unqualifiedName !~ traverseNamePart</span>
<span class="lineno">  576 </span><span class="spaces">                   </span><span class="istickedoff">&gt;=&gt; qualifiers &amp; annList !~ <span class="nottickedoff">traverseNamePart</span></span></span>
<span class="lineno">  577 </span>
<span class="lineno">  578 </span>traverseNamePart :: CheckNode NamePart
<span class="lineno">  579 </span><span class="decl"><span class="istickedoff">traverseNamePart = chkNamePart</span></span>
<span class="lineno">  580 </span>
<span class="lineno">  581 </span>traverseLiteral :: CheckNode Literal
<span class="lineno">  582 </span><span class="decl"><span class="istickedoff">traverseLiteral = chkLiteral</span></span>
<span class="lineno">  583 </span>
<span class="lineno">  584 </span>traverseOperator :: CheckNode Operator
<span class="lineno">  585 </span><span class="decl"><span class="istickedoff">traverseOperator = operatorName !~ traverseQualifiedName</span></span>
<span class="lineno">  586 </span>
<span class="lineno">  587 </span>traverseTypeSignature :: CheckNode TypeSignature
<span class="lineno">  588 </span><span class="decl"><span class="istickedoff">traverseTypeSignature = (tsName &amp; annList !~ traverseName)</span>
<span class="lineno">  589 </span><span class="spaces">                    </span><span class="istickedoff">&gt;=&gt; (tsType !~ traverseType)</span></span>
<span class="lineno">  590 </span>
<span class="lineno">  591 </span>traverseFixitySignature :: CheckNode FixitySignature
<span class="lineno">  592 </span><span class="decl"><span class="nottickedoff">traverseFixitySignature = fixityOperators &amp; annList !~ traverseOperator</span></span>

</pre>
</body>
</html>
